<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <link rel=stylesheet href="../../code.css" type="text/css"></head><body><pre><span class='linenumber'>   1</span> <span class="COMM">/*
<span class='linenumber'>   2</span>    Copyright (c) 2012 KT Corp.
<span class='linenumber'>   3</span>   
<span class='linenumber'>   4</span>    This program is free software: you can redistribute it and/or modify
<span class='linenumber'>   5</span>    it under the terms of the GNU Lesser General Public License as published by
<span class='linenumber'>   6</span>    the Free Software Foundation, either version 3 of the License, or
<span class='linenumber'>   7</span>    (at your option) any later version.
<span class='linenumber'>   8</span> 
<span class='linenumber'>   9</span>    This program is distributed in the hope that it will be useful,
<span class='linenumber'>  10</span>    but WITHOUT ANY WARRANTY; without even the implied warranty of
<span class='linenumber'>  11</span>    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<span class='linenumber'>  12</span>    GNU Lesser General Public License for more details.
<span class='linenumber'>  13</span> 
<span class='linenumber'>  14</span>    You should have received a copy of the GNU Lesser General Public License
<span class='linenumber'>  15</span>    along with This program.  If not, see &lt;http://www.gnu.org/licenses/>.
<span class='linenumber'>  16</span> */</span><span class="WHIT">
<span class='linenumber'>  17</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">GLOBAL</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  18</span> 
<span class='linenumber'>  19</span> </span><span class="WHIT">      </span><span class="COMM">// Mapping of normalized type names for tau.typeOf()</span><span class="WHIT">
<span class='linenumber'>  20</span> </span><span class="WHIT">  </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_OBJ2TYPE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  21</span> </span><span class="WHIT">      </span><span class="STRN">'[object Boolean]'</span><span class="WHIT">  </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'boolean'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  22</span> </span><span class="WHIT">      </span><span class="STRN">'[object Number]'</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  23</span> </span><span class="WHIT">      </span><span class="STRN">'[object String]'</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  24</span> </span><span class="WHIT">      </span><span class="STRN">'[object Function]'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  25</span> </span><span class="WHIT">      </span><span class="STRN">'[object Object]'</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  26</span> </span><span class="WHIT">      </span><span class="STRN">'[object Array]'</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'array'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  27</span> </span><span class="WHIT">      </span><span class="STRN">'[object Date]'</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'date'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  28</span> </span><span class="WHIT">      </span><span class="STRN">'[object RegExp]'</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'regexp'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  29</span> </span><span class="WHIT">      </span><span class="STRN">'[object Error]'</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'error'</span><span class="WHIT">
<span class='linenumber'>  30</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  31</span> 
<span class='linenumber'>  32</span> </span><span class="WHIT">    </span><span class="COMM">// Sub module map</span><span class="WHIT">
<span class='linenumber'>  33</span> </span><span class="WHIT">    </span><span class="NAME">_MODULE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  34</span> 
<span class='linenumber'>  35</span> </span><span class="WHIT">    </span><span class="COMM">// Unique id seed (incremented as new IDs are created)</span><span class="WHIT">
<span class='linenumber'>  36</span> </span><span class="WHIT">    </span><span class="NAME">_idSeed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  37</span> 
<span class='linenumber'>  38</span> </span><span class="WHIT">    </span><span class="COMM">// URL RegExp </span><span class="WHIT">
<span class='linenumber'>  39</span> </span><span class="WHIT">    </span><span class="NAME">_URLREGEXP</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/^(\w+:)?\/\/\/?([^\/?#]+)/</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  40</span> 
<span class='linenumber'>  41</span> </span><span class="WHIT">    </span><span class="COMM">// Root URL</span><span class="WHIT">
<span class='linenumber'>  42</span> </span><span class="WHIT">    </span><span class="NAME">_ROOTURL</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  43</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_URLREGEXP.exec</span><span class="PUNC">(</span><span class="NAME">GLOBAL.location.href</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  44</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_OBJ2TYPE</span><span class="PUNC">[</span><span class="NAME">Object.prototype.toString.call</span><span class="PUNC">(</span><span class="NAME">parts</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'array'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>  45</span>           </span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">GLOBAL.location.protocol</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'//'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">GLOBAL.location.host</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  46</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  47</span> 
<span class='linenumber'>  48</span> </span><span class="WHIT">    </span><span class="NAME">_ANCHOR</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  49</span> </span><span class="WHIT">    
<span class='linenumber'>  50</span>     </span><span class="NAME">_ROOT_DOM</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  51</span> </span><span class="WHIT">    
<span class='linenumber'>  52</span>     </span><span class="COMM">// requestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  53</span> </span><span class="WHIT">    </span><span class="NAME">_requestAnimationFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  54</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.requestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  55</span> </span><span class="WHIT">      </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.webkitRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  56</span> </span><span class="WHIT">      </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.mozRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  57</span> </span><span class="WHIT">      </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.oRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  58</span> </span><span class="WHIT">      </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.msRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  59</span> </span><span class="WHIT">      </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">17</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  60</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  61</span> </span><span class="WHIT">    
<span class='linenumber'>  62</span>     </span><span class="COMM">// cancelRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  63</span> </span><span class="WHIT">    </span><span class="NAME">_cancelRequestAnimationFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  64</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.cancelRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  65</span> </span><span class="WHIT">        </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.webkitCancelAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  66</span> </span><span class="WHIT">        </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.webkitCancelRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  67</span> </span><span class="WHIT">        </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.mozCancelRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  68</span> </span><span class="WHIT">        </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.oCancelRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  69</span> </span><span class="WHIT">        </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.msCancelRequestAnimationFrame</span><span class="WHIT">
<span class='linenumber'>  70</span> </span><span class="WHIT">        </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">clearTimeout</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  71</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  72</span> 
<span class='linenumber'>  73</span> 
<span class='linenumber'>  74</span> </span><span class="WHIT">  </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">tau</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  75</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>  76</span>      * 개발자들의 개발편의를 위해 자주 사용되는 Utility
<span class='linenumber'>  77</span>      * 메소드들을 최상위 네임스페이스에 정의하고 개발할 때 쉽게 접근할
<span class='linenumber'>  78</span>      * 수 있도록 한다.
<span class='linenumber'>  79</span>      * @namespace 최상위 네임스페이스, 앱 개발시 빈번히 사용되는 Utility
<span class='linenumber'>  80</span>      * 멤소드들을 정의한다. 하위 네임스페이스로는 
<span class='linenumber'>  81</span>      * &lt;code>rt, ui, util, fx, data&lt;/code>가 있다.
<span class='linenumber'>  82</span>      **/</span><span class="WHIT">
<span class='linenumber'>  83</span> </span><span class="WHIT">    </span><span class="NAME">tau</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  84</span> 
<span class='linenumber'>  85</span> </span><span class="WHIT">      </span><span class="COMM">// Mobello Framework version</span><span class="WHIT">
<span class='linenumber'>  86</span> </span><span class="WHIT">      </span><span class="NAME">VER</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'0.9.0'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  87</span> </span><span class="WHIT">      
<span class='linenumber'>  88</span>       </span><span class="COMM">/**
<span class='linenumber'>  89</span>        * Mobello Framework이 차지하는 전체 화면의 너비를
<span class='linenumber'>  90</span>        * 픽셀단위로 반환한다.&lt;p/>
<span class='linenumber'>  91</span>        * Mobello Framework이 차지하는 넓이는 HTML에서 id가
<span class='linenumber'>  92</span>        * 'tau-root'로 지정된 앨리면트가 차지하는 영역의 넓이가 된다.
<span class='linenumber'>  93</span>        * @returns {Number} 전체화면에서 넓이에 해당하는 픽셀크기
<span class='linenumber'>  94</span>        */</span><span class="WHIT">
<span class='linenumber'>  95</span> </span><span class="WHIT">      </span><span class="NAME">getWidth</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>  96</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.getDimension</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>  97</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>  98</span> </span><span class="WHIT">      
<span class='linenumber'>  99</span>       </span><span class="COMM">/**
<span class='linenumber'> 100</span>        * Mobello Framework이 차지하는 전체 화면의 높이를
<span class='linenumber'> 101</span>        * 픽셀단위로 반환한다.&lt;p/>
<span class='linenumber'> 102</span>        * Mobello Framework이 차지하는 높이는 HTML에서 id가
<span class='linenumber'> 103</span>        * 'tau-root'로 지정된 앨리먼트가 차지하는 영역의 높이가
<span class='linenumber'> 104</span>        * 된다.
<span class='linenumber'> 105</span>        * @returns {Number} 전체화면에서 높이에 해당하는 픽셀크기 
<span class='linenumber'> 106</span>        */</span><span class="WHIT">
<span class='linenumber'> 107</span> </span><span class="WHIT">      </span><span class="NAME">getHeight</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 108</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.getDimension</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 109</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 110</span> 
<span class='linenumber'> 111</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 112</span>        *  Mobello Framework이 차지하는 전체 화면의 크기를 객체
<span class='linenumber'> 113</span>        *  형태로 반환한다. &lt;p/>
<span class='linenumber'> 114</span>        *  반환되는 객체에 width, height 프로퍼티가 있으며 이를
<span class='linenumber'> 115</span>        *  통해 넓이와 높이 값을 확인할 수 있다.
<span class='linenumber'> 116</span>        *  @example
<span class='linenumber'> 117</span>        *  var dim = tau.getDemension();
<span class='linenumber'> 118</span>        *  tau.log(dim.width); // width value
<span class='linenumber'> 119</span>        *  tau.log(dim.height); // height value
<span class='linenumber'> 120</span>        *  @returns {Object} Mobello Framework이 차지하는 전체 화면의
<span class='linenumber'> 121</span>        *  크기를(width, height) 저장하고 있는 객체
<span class='linenumber'> 122</span>        **/</span><span class="WHIT">
<span class='linenumber'> 123</span> </span><span class="WHIT">      </span><span class="NAME">getDimension</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 124</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">_ROOT_DOM</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 125</span> </span><span class="WHIT">         </span><span class="NAME">_ROOT_DOM</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'tau-root'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='linenumber'> 126</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 127</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_ROOT_DOM</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 128</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_ROOT_DOM.clientWidth</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">_ROOT_DOM.offsetWidth</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 129</span> </span><span class="WHIT">                  </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_ROOT_DOM.clientHeight</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">_ROOT_DOM.offsetHeight</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 130</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 131</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">window.innerWidth</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">window.innerHeight</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 132</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 133</span> </span><span class="WHIT">      
<span class='linenumber'> 134</span>       </span><span class="COMM">/**
<span class='linenumber'> 135</span>        * Normalize된 typeof 함수로서 대상 객체의 종류에 따라
<span class='linenumber'> 136</span>        * 일관된 형태로 타입을 문자열로 반환한다.(예를 들면,
<span class='linenumber'> 137</span>        * 대상 객체가 null일경우 JavaScript의 내장 typeof 를
<span class='linenumber'> 138</span>        * 사용하면 'object'를 반환하지만 tau.typeOf를 사용하면
<span class='linenumber'> 139</span>        * 'null'을 반환한다)
<span class='linenumber'> 140</span>        * &lt;p/>
<span class='linenumber'> 141</span>        * Normalize된 JavaScript의 타입은 다음과 같다
<span class='linenumber'> 142</span>        * &lt;pre>
<span class='linenumber'> 143</span>        *   ARRAY:       'array'
<span class='linenumber'> 144</span>        *   BOOLEAN:     'boolean'
<span class='linenumber'> 145</span>        *   DATE:        'date'
<span class='linenumber'> 146</span>        *   ERROR:       'error'
<span class='linenumber'> 147</span>        *   FUNCTION:    'function'
<span class='linenumber'> 148</span>        *   NUMBER:      'number'
<span class='linenumber'> 149</span>        *   NULL:        'null'
<span class='linenumber'> 150</span>        *   OBJECT:      'object'
<span class='linenumber'> 151</span>        *   REGEXP:      'regexp'
<span class='linenumber'> 152</span>        *   STRING:      'string'
<span class='linenumber'> 153</span>        *   UNDEFINED:   'undefined'
<span class='linenumber'> 154</span>        * &lt;/pre>
<span class='linenumber'> 155</span>        * @example
<span class='linenumber'> 156</span>        * tau.typeOf('foo'); // 'string'
<span class='linenumber'> 157</span>        * tau.typeOf(123); // 'number'
<span class='linenumber'> 158</span>        * tau.typeOf([]); // 'array'
<span class='linenumber'> 159</span>        * tau.typeOf({}); // 'object'
<span class='linenumber'> 160</span>        * tau.typeOf(null); 'null'
<span class='linenumber'> 161</span>        * tau.typeOf(new Date); // 'date'
<span class='linenumber'> 162</span>        * tau.typeOf(true); // 'boolean'
<span class='linenumber'> 163</span>        *
<span class='linenumber'> 164</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 165</span>        * @returns {String} Normalize된 JavaScript 타입(문자열)
<span class='linenumber'> 166</span>        */</span><span class="WHIT">
<span class='linenumber'> 167</span> </span><span class="WHIT">      </span><span class="NAME">typeOf</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 168</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_OBJ2TYPE</span><span class="PUNC">[</span><span class="NAME">Object.prototype.toString.call</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="WHIT"> 
<span class='linenumber'> 169</span>             </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'null'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 170</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 171</span> 
<span class='linenumber'> 172</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 173</span>        * 명시된 객체(obj)가 'undefined' 인지를 확인하고 그
<span class='linenumber'> 174</span>        * 결과를 Boolean값으로 반환한다.
<span class='linenumber'> 175</span>        * @example
<span class='linenumber'> 176</span>        * tau.isUndefined(undefined); // true
<span class='linenumber'> 177</span>        * tau.isUndefined(); // true
<span class='linenumber'> 178</span>        * tau.isUndefined(null); // false
<span class='linenumber'> 179</span>        * tau.isUndefined(0); // false
<span class='linenumber'> 180</span>        * tau.isUndefined(''); // false
<span class='linenumber'> 181</span>        *
<span class='linenumber'> 182</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 183</span>        * @returns {Boolean} 객체가 undefined이면 true를 그렇지
<span class='linenumber'> 184</span>        * 않으면 false를 반환한다.
<span class='linenumber'> 185</span>        */</span><span class="WHIT">
<span class='linenumber'> 186</span> </span><span class="WHIT">      </span><span class="NAME">isUndefined</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 187</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 188</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 189</span> 
<span class='linenumber'> 190</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 191</span>        * 명시된 객체가 숫자인지를 확인하고 그 결과를
<span class='linenumber'> 192</span>        * Boolean값으로 반환한다.
<span class='linenumber'> 193</span>        * @example
<span class='linenumber'> 194</span>        * tau.isNumber(0); // true
<span class='linenumber'> 195</span>        * tau.isNumber(2.3); // true
<span class='linenumber'> 196</span>        * tau.isNumber('foo'); // false
<span class='linenumber'> 197</span>        *
<span class='linenumber'> 198</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 199</span>        * @returns {Boolean} 객체가 숫자이면 true를 그렇지 않으면
<span class='linenumber'> 200</span>        * false를 반환한다.
<span class='linenumber'> 201</span>        */</span><span class="WHIT">
<span class='linenumber'> 202</span> </span><span class="WHIT">      </span><span class="NAME">isNumber</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 203</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">isFinite</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 204</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 205</span> 
<span class='linenumber'> 206</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 207</span>        * 명시된 객체가 Boolean의 값인지 확인하고 그 결과를
<span class='linenumber'> 208</span>        * true/false로 반환한다.
<span class='linenumber'> 209</span>        * @example
<span class='linenumber'> 210</span>        * tau.isBoolean(true); // true
<span class='linenumber'> 211</span>        * tau.isBoolean(false); // true
<span class='linenumber'> 212</span>        * tau.isBoolean({}); // false
<span class='linenumber'> 213</span>        * tau.isBoolean([]); // false
<span class='linenumber'> 214</span>        *
<span class='linenumber'> 215</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 216</span>        * @returns {Boolean} 만약 명시된 객체가 boolean이면 true를 그렇지
<span class='linenumber'> 217</span>        * 않으면 false를 반환한다.
<span class='linenumber'> 218</span>        */</span><span class="WHIT">
<span class='linenumber'> 219</span> </span><span class="WHIT">      </span><span class="NAME">isBoolean</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 220</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'boolean'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 221</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 222</span> 
<span class='linenumber'> 223</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 224</span>        * 명시된 객체가 String인지 확인하고 그 결과를
<span class='linenumber'> 225</span>        * true/false로 반환한다.
<span class='linenumber'> 226</span>        * @example
<span class='linenumber'> 227</span>        * tau.isString(123); // false
<span class='linenumber'> 228</span>        * tau.isString('foo'); // true
<span class='linenumber'> 229</span>        * tau.isString(''); // true
<span class='linenumber'> 230</span>        *
<span class='linenumber'> 231</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 232</span>        * @returns {Boolean} 만약 명시된 객체가 String이면 true를 그렇지 않으면
<span class='linenumber'> 233</span>        * false를 반환한다.
<span class='linenumber'> 234</span>        */</span><span class="WHIT">
<span class='linenumber'> 235</span> </span><span class="WHIT">      </span><span class="NAME">isString</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 236</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 237</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 238</span> 
<span class='linenumber'> 239</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 240</span>        * 명시된 객체가 function 또는 class인지 확인하고 그 결과를
<span class='linenumber'> 241</span>        * true/false로 반환한다.
<span class='linenumber'> 242</span>        * @example
<span class='linenumber'> 243</span>        * tau.isFunction(123); // false
<span class='linenumber'> 244</span>        * tau.isFunction(new Function()); // true
<span class='linenumber'> 245</span>        * tau.isFunction(tau.isString); // true
<span class='linenumber'> 246</span>        *
<span class='linenumber'> 247</span>        * @param {Object} obj JavaScript 객체 
<span class='linenumber'> 248</span>        * @returns {Boolean} 명시된 객체가 function이면 true를 그렇지 않으면
<span class='linenumber'> 249</span>        * false를 반환한다.
<span class='linenumber'> 250</span>        */</span><span class="WHIT">
<span class='linenumber'> 251</span> </span><span class="WHIT">      </span><span class="NAME">isFunction</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 252</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.typeOf</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 253</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 254</span> 
<span class='linenumber'> 255</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 256</span>        * 명시된 객체가 인스턴스인지 확인하고 그 결과를
<span class='linenumber'> 257</span>        * true/false로 반환한다. 만약 명시된 객체가
<span class='linenumber'> 258</span>        * function인지 같이 확인하고자 한다면 isFunction 파라미터의
<span class='linenumber'> 259</span>        * 값을 true로 설정하면 된다.
<span class='linenumber'> 260</span>        * @example
<span class='linenumber'> 261</span>        * tau.isObject({}); // true
<span class='linenumber'> 262</span>        * tau.isObject([]); // true
<span class='linenumber'> 263</span>        * tau.isObject(new Function()); // false
<span class='linenumber'> 264</span>        * tau.isObject(new Function(), true); // true
<span class='linenumber'> 265</span>        *
<span class='linenumber'> 266</span>        * @param {Object} obj JavaScript 객체 
<span class='linenumber'> 267</span>        * @param {Boolean} isFunction true 일경우 function객체도
<span class='linenumber'> 268</span>        * true를 반환한다.
<span class='linenumber'> 269</span>        * @returns {Boolean} 명시된 객체가 Object 또는 function일경우 true를
<span class='linenumber'> 270</span>        * 그렇지 않을 경우 false를 반환한다.
<span class='linenumber'> 271</span>        */</span><span class="WHIT">
<span class='linenumber'> 272</span> </span><span class="WHIT">      </span><span class="NAME">isObject</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isFunction</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 273</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'> 274</span>             </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isFunction</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 275</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 276</span> 
<span class='linenumber'> 277</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 278</span>        * 명시된 객체가 Date인지 확인하고 그 결과를
<span class='linenumber'> 279</span>        * true/false로 반환한다.
<span class='linenumber'> 280</span>        * @example
<span class='linenumber'> 281</span>        * tau.isDate(new Date()); // true
<span class='linenumber'> 282</span>        * tau.isDate({}); // false
<span class='linenumber'> 283</span>        *
<span class='linenumber'> 284</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 285</span>        * @returns {Boolean} 명시된 객체가 Date일경우 true를
<span class='linenumber'> 286</span>        * 그렇지 않을경우 false를 반환한다.
<span class='linenumber'> 287</span>        */</span><span class="WHIT">
<span class='linenumber'> 288</span> </span><span class="WHIT">      </span><span class="NAME">isDate</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 289</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.typeOf</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'date'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 290</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 291</span> 
<span class='linenumber'> 292</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 293</span>        * 명시된 객체가 적절한 값을 가지는지 확인하고 그 결과를
<span class='linenumber'> 294</span>        * true/false로 반환한다. 그 값이 undefined/null/NaN/""
<span class='linenumber'> 295</span>        * 이 아닐경우 true를 반환한다.
<span class='linenumber'> 296</span>        * @example
<span class='linenumber'> 297</span>        * tau.isValue({}); // true
<span class='linenumber'> 298</span>        * tau.isValue([]); // true
<span class='linenumber'> 299</span>        * tau.isValue(null); // false
<span class='linenumber'> 300</span>        * tau.isValue(undefined); // false
<span class='linenumber'> 301</span>        * tau.isValue(''); // false
<span class='linenumber'> 302</span>        *
<span class='linenumber'> 303</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 304</span>        * @returns {Boolean} 명시된 객체가 undefined, null, NaN, "" 이 아닐경우
<span class='linenumber'> 305</span>        * true를 반환하고 그렇지 않을경우 false를 반환한다.
<span class='linenumber'> 306</span>        */</span><span class="WHIT">
<span class='linenumber'> 307</span> </span><span class="WHIT">      </span><span class="NAME">isValue</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 308</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.typeOf</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 309</span> </span><span class="WHIT">        </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 310</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 311</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'null'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 312</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 313</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 314</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">isFinite</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 315</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 316</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 317</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 318</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 319</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 320</span> 
<span class='linenumber'> 321</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 322</span>        * 명시된 객체가 배열인지 확인하고 그 결과를
<span class='linenumber'> 323</span>        * true/false로 반환한다.
<span class='linenumber'> 324</span>        * @example
<span class='linenumber'> 325</span>        * tau.isArray([]); // true
<span class='linenumber'> 326</span>        * tau.isArray({}); // false
<span class='linenumber'> 327</span>        *
<span class='linenumber'> 328</span>        * @param {Object} obj JavaScript 객체
<span class='linenumber'> 329</span>        * @param {Boolean} relaxed 좀더 확장된 형태의 배열인지 확인하기 위한
<span class='linenumber'> 330</span>        * 옵션(즉, 상속관계를 허용한다)
<span class='linenumber'> 331</span>        * @returns {Boolean} 명시된 객체가 배열일경우 true를 반환하고 그렇지
<span class='linenumber'> 332</span>        * 않을경우  false를 반환한다.
<span class='linenumber'> 333</span>        */</span><span class="WHIT">
<span class='linenumber'> 334</span> </span><span class="WHIT">      </span><span class="NAME">isArray</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">relaxed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 335</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">relaxed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 336</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Array.isArray</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 337</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 338</span> </span><span class="WHIT">          </span><span class="COMM">// Handles arrays inheritance and arrays from external frame/window</span><span class="WHIT">
<span class='linenumber'> 339</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="WHIT">
<span class='linenumber'> 340</span> </span><span class="WHIT">              </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="WHIT">
<span class='linenumber'> 341</span> </span><span class="WHIT">              </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">obj.splice</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="WHIT">
<span class='linenumber'> 342</span> </span><span class="WHIT">              </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">obj.propertyIsEnumerable</span><span class="PUNC">(</span><span class="STRN">'length'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 343</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 344</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 345</span> 
<span class='linenumber'> 346</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 347</span>        * 명시된 객체가 HTML DOM앨리먼트 타입인지 확인하고 그 결과를
<span class='linenumber'> 348</span>        * true/false로 반환한다.
<span class='linenumber'> 349</span>        * @example
<span class='linenumber'> 350</span>        * tau.isElement(document.createElement('div')); // true
<span class='linenumber'> 351</span>        * tau.isElement(document.createTextNode('foo')); // false
<span class='linenumber'> 352</span>        *
<span class='linenumber'> 353</span>        * @param {Object} obj JavaScript 객체 
<span class='linenumber'> 354</span>        * @returns {Boolean} 명시된 객체가 DOM 앨리먼트 타입이면
<span class='linenumber'> 355</span>        * true를 그렇지 않으면 false를 반환한다.
<span class='linenumber'> 356</span>        */</span><span class="WHIT">
<span class='linenumber'> 357</span> </span><span class="WHIT">      </span><span class="NAME">isElement</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 358</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">obj.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 359</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 360</span> </span><span class="WHIT">      
<span class='linenumber'> 361</span>       </span><span class="COMM">/**
<span class='linenumber'> 362</span>        * 명시된 객체가 HTML DOM Fragment인지 확인하고 그
<span class='linenumber'> 363</span>        * 결과를 true/false로 반환한다.
<span class='linenumber'> 364</span>        * @example
<span class='linenumber'> 365</span>        * tau.isFragment(document.createElement('div')); // false
<span class='linenumber'> 366</span>        * tau.isFragment(document.createDocumentFragment()); // true
<span class='linenumber'> 367</span>        *
<span class='linenumber'> 368</span>        * @param {Object} obj JavaScript 객체 
<span class='linenumber'> 369</span>        * @returns {Boolean} 명시된 객체가 DOM Fragment이면
<span class='linenumber'> 370</span>        * true를 그렇지 않으면 false를 반환한다.
<span class='linenumber'> 371</span>        */</span><span class="WHIT">
<span class='linenumber'> 372</span> </span><span class="WHIT">      </span><span class="NAME">isFragment</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 373</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">obj.nodeType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">11</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 374</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 375</span> 
<span class='linenumber'> 376</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 377</span>        * 명시된 문자열이 네임스페이스 형태인지 확인하고 그
<span class='linenumber'> 378</span>        * 결과를 true/false로 반환한다.
<span class='linenumber'> 379</span>        * @example
<span class='linenumber'> 380</span>        * tau.isNamespace('foo'); // true
<span class='linenumber'> 381</span>        * tau.isNamespace('foo.bar'); // true
<span class='linenumber'> 382</span>        * tau.isNamespace('foo,bar'); // false
<span class='linenumber'> 383</span>        * tau.isNamespace('foo-bar'); // false
<span class='linenumber'> 384</span>        *
<span class='linenumber'> 385</span>        * @param {String} ns 네임스페이스 문자열
<span class='linenumber'> 386</span>        * @returns {Boolean} 명시된 문자열이 적법한 네임스페이스 문자열이면 
<span class='linenumber'> 387</span>        * true를 반환하고 그렇지 않으면 false를 반환한다.
<span class='linenumber'> 388</span>        */</span><span class="WHIT">
<span class='linenumber'> 389</span> </span><span class="WHIT">      </span><span class="NAME">isNamespace</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 390</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="REGX">/^[\w]+(\.[\w]+)*$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 391</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 392</span> 
<span class='linenumber'> 393</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 394</span>        * 아무런 작업을 하지 않는 Dummy function.
<span class='linenumber'> 395</span>        * &lt;p/>
<span class='linenumber'> 396</span>        * 오류를 발생시키지 않고 이전에 정의된 function을
<span class='linenumber'> 397</span>        * disable시키기 위히 주로 사용된다.
<span class='linenumber'> 398</span>        */</span><span class="WHIT">
<span class='linenumber'> 399</span> </span><span class="WHIT">      </span><span class="NAME">emptyFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 400</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 401</span> </span><span class="WHIT">      
<span class='linenumber'> 402</span>       </span><span class="COMM">/**
<span class='linenumber'> 403</span>        * 명시된 function을 호출할 때 function에 정의된
<span class='linenumber'> 404</span>        * 파라미터 외에 추가적인 파라미터를 넘기고자 할 경우
<span class='linenumber'> 405</span>        * 사용한다. 추가하고자 하는 파라미터의 개수에는 제한이
<span class='linenumber'> 406</span>        * 없다.
<span class='linenumber'> 407</span>        * &lt;p/>
<span class='linenumber'> 408</span>        * @example
<span class='linenumber'> 409</span>        * function showArguments() {
<span class='linenumber'> 410</span>        *   alert(Array.prototype.join.call.join(arguments, ', '));
<span class='linenumber'> 411</span>        * }
<span class='linenumber'> 412</span>        * showArguments(1, 2, 3);
<span class='linenumber'> 413</span>        * // -> alerts "1, 2, 3"
<span class='linenumber'> 414</span>        * var f = tau.curry(showArguments, this, 1, 2, 3);
<span class='linenumber'> 415</span>        * f('a', 'b');
<span class='linenumber'> 416</span>        * // -> alerts "a, b, 1, 2, 3"
<span class='linenumber'> 417</span>        *
<span class='linenumber'> 418</span>        * @param {Function} fn 최종적으로 호출할 function
<span class='linenumber'> 419</span>        * @param {Object} ctx context 객체
<span class='linenumber'> 420</span>        * @param {Arguments} [args] 추가적으로 넘기고자 하는 파라미터
<span class='linenumber'> 421</span>        */</span><span class="WHIT">
<span class='linenumber'> 422</span> </span><span class="WHIT">      </span><span class="NAME">curry</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 423</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">arguments.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 424</span> </span><span class="WHIT">          </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">SyntaxError</span><span class="PUNC">(</span><span class="STRN">'method reference to curry is missing!'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 425</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 426</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 427</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 428</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 429</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 430</span> </span><span class="WHIT">              </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arr.concat.call</span><span class="PUNC">(</span><span class="NAME">arr.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 431</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_fn.apply</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 432</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 433</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 434</span> </span><span class="WHIT">      
<span class='linenumber'> 435</span>       </span><span class="COMM">/**
<span class='linenumber'> 436</span>        * 명시된 function을 호출할 때 사용할 context를
<span class='linenumber'> 437</span>        * 지정한다. 이벤트 핸들러 또는 callback메소드 내에서
<span class='linenumber'> 438</span>        * this 키워드를 이용해서 Closure로 된 객체에 접근하고자
<span class='linenumber'> 439</span>        * 할 때 유용하게 하용할 수 있다.
<span class='linenumber'> 440</span>        * &lt;p/>
<span class='linenumber'> 441</span>        * @example
<span class='linenumber'> 442</span>        * ...
<span class='linenumber'> 443</span>        * loadModel: function (start, size) {
<span class='linenumber'> 444</span>        *   this.flickr = null;
<span class='linenumber'> 445</span>        *
<span class='linenumber'> 446</span>        *   function loaded(resp) {
<span class='linenumber'> 447</span>        *     if (resp.status === 200) {
<span class='linenumber'> 448</span>        *       // callback 메소드에서 this 키워드를 이용해
<span class='linenumber'> 449</span>        *       // flicker접근 가능!
<span class='linenumber'> 450</span>        *       this.flickr = resp.responseJSON;
<span class='linenumber'> 451</span>        *     }
<span class='linenumber'> 452</span>        *   }
<span class='linenumber'> 453</span>        *
<span class='linenumber'> 454</span>        *   if (!this.flickr) {
<span class='linenumber'> 455</span>        *     tau.req({
<span class='linenumber'> 456</span>        *       type: 'JSONP',
<span class='linenumber'> 457</span>        *       jsonpCallback:'jsoncallback',
<span class='linenumber'> 458</span>        *       url: this.url,
<span class='linenumber'> 459</span>        *       callbackFn: tau.ctxAware(loaded, this) // &lt;--
<span class='linenumber'> 460</span>        *     });
<span class='linenumber'> 461</span>        *   }
<span class='linenumber'> 462</span>        * }
<span class='linenumber'> 463</span>        * ...
<span class='linenumber'> 464</span>        *
<span class='linenumber'> 465</span>        * @param {Function} fn 원본 메소드, 이 메소드 내에서 사용하는 기존의
<span class='linenumber'> 466</span>        * context를 다른 context로 변경하여 사용할 수 있다.
<span class='linenumber'> 467</span>        * @param {Object} [ctx] Context 객체(ex. this)
<span class='linenumber'> 468</span>        * @returns {Function} 명시된 context를 이용하여 감싸진
<span class='linenumber'> 469</span>        * function, 이 function 내에서 this 키워드를 활용하여 주어진 context의
<span class='linenumber'> 470</span>        * property들을 접근할 수 있다.
<span class='linenumber'> 471</span>        */</span><span class="WHIT">
<span class='linenumber'> 472</span> </span><span class="WHIT">      </span><span class="NAME">ctxAware</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 473</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 474</span> </span><span class="WHIT">          </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">'Specified handler is not Function type: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 475</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 476</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 477</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 478</span> </span><span class="WHIT">          </span><span class="NAME">_fn.apply</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 479</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 480</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 481</span> </span><span class="WHIT">      
<span class='linenumber'> 482</span>       </span><span class="COMM">/**
<span class='linenumber'> 483</span>        * 단말의 Orientation을 감지하여 그 값을 반환한다. 이때
<span class='linenumber'> 484</span>        * 반환되는 값은 'landscape' 또는 'portrait'중의 하나가
<span class='linenumber'> 485</span>        * 된다.
<span class='linenumber'> 486</span>        * @returns {String} Orientation 상태. 'landscape' 또는 'portrait'
<span class='linenumber'> 487</span>        */</span><span class="WHIT">
<span class='linenumber'> 488</span> </span><span class="WHIT">      </span><span class="NAME">senseOrientation</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 489</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.orientation</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 490</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isNumber</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// if 0, resolves as false</span><span class="WHIT">
<span class='linenumber'> 491</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">90</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'landscape'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'portrait'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 492</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 493</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 494</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 495</span> </span><span class="WHIT">      
<span class='linenumber'> 496</span>       </span><span class="COMM">/**
<span class='linenumber'> 497</span>        * 브라우저의 URL창을 통해 Mobello Framework을 실행시킬
<span class='linenumber'> 498</span>        * 때 파라미터를 명시하였다면 그 파라미터의 키와 매핑된
<span class='linenumber'> 499</span>        * 값을 반환한다.
<span class='linenumber'> 500</span>        * @example
<span class='linenumber'> 501</span>        * http://localhost/tau/laucher.html?aaa=bbb
<span class='linenumber'> 502</span>        * tau.getLauncherParam('aaa'); // returns 'bbb'
<span class='linenumber'> 503</span>        * 
<span class='linenumber'> 504</span>        * @param {String} key 파라미터 키 
<span class='linenumber'> 505</span>        * @returns {String} 파리미터 키에 해당하는 값 
<span class='linenumber'> 506</span>        */</span><span class="WHIT">
<span class='linenumber'> 507</span> </span><span class="WHIT">      </span><span class="NAME">getLauncherParam</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 508</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">exp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 509</span> </span><span class="WHIT">            </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.URL</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 510</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url.indexOf</span><span class="PUNC">(</span><span class="STRN">'launcher.html?'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 511</span> </span><span class="WHIT">           </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 512</span> </span><span class="WHIT">        </span><span class="NAME">exp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">'[\\?&]'</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="STRN">'=([^&#]*)'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 513</span> </span><span class="WHIT">        </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">exp.exec</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 514</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 515</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 516</span> 
<span class='linenumber'> 517</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 518</span>        * $class()를 이용하여 생성하는 모든 클래스는 내부적으로
<span class='linenumber'> 519</span>        * tau.TObject를 상속받는다. 따라서 다음과 같이
<span class='linenumber'> 520</span>        * instanceof 를 통해 Mobello 객체인지 확인할 수 있다.
<span class='linenumber'> 521</span>        * @example
<span class='linenumber'> 522</span>        * var foo = // Mobello 클래스 인스턴스 
<span class='linenumber'> 523</span>        * if (foo instanceof tau.TObject) {} // true 
<span class='linenumber'> 524</span>        * @class
<span class='linenumber'> 525</span>        * Mobello에서 생성하는 모든 객체는 tau.TObject를 상속받는다.
<span class='linenumber'> 526</span>        * @see $class
<span class='linenumber'> 527</span>        */</span><span class="WHIT">
<span class='linenumber'> 528</span> </span><span class="WHIT">      </span><span class="NAME">TObject</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 529</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">TObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 530</span> </span><span class="WHIT">        </span><span class="NAME">obj.prototype.$classname</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'tau.TObject'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 531</span> </span><span class="WHIT">        
<span class='linenumber'> 532</span>         </span><span class="COMM">/**
<span class='linenumber'> 533</span>          * 현재 객체를 문자열로 변환하여 반환한다. 일반적으로
<span class='linenumber'> 534</span>          * Mobello클래스가 foo.Bar로 정의되었다면 반환되는
<span class='linenumber'> 535</span>          * 문자열은 "[object foo.Bar]"가 된다.
<span class='linenumber'> 536</span>          * @example
<span class='linenumber'> 537</span>          * var v = new foo.Bar();
<span class='linenumber'> 538</span>          * v.toString(); // '[object foo.Bar]'
<span class='linenumber'> 539</span>          * @name toString
<span class='linenumber'> 540</span>          * @function
<span class='linenumber'> 541</span>          * @memberOf tau.TObject.prototype
<span class='linenumber'> 542</span>          * @returns {String} 객체를 표현하는 문자열
<span class='linenumber'> 543</span>          */</span><span class="WHIT">
<span class='linenumber'> 544</span> </span><span class="WHIT">        </span><span class="NAME">obj.prototype.toString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 545</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'[object '</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">this.$classname</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 546</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 547</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'> 548</span>          * 현재 callstack의 정보를 반환한다. 이 메소드의
<span class='linenumber'> 549</span>          * 호출이 빈번히 발생할 경우 성능저하가 발생할 수
<span class='linenumber'> 550</span>          * 있으므로 신중하게 사용해야 한다.
<span class='linenumber'> 551</span>          * @example
<span class='linenumber'> 552</span>          * var aa = ...
<span class='linenumber'> 553</span>          * aa.currentStack().toString();
<span class='linenumber'> 554</span>          * // prints callstack as a String
<span class='linenumber'> 555</span>          *
<span class='linenumber'> 556</span>          * @name currentStack
<span class='linenumber'> 557</span>          * @function
<span class='linenumber'> 558</span>          * @memberOf tau.TObject.prototype
<span class='linenumber'> 559</span>          * @returns {Object} 현재의 callstack 정보를 담고있는
<span class='linenumber'> 560</span>          * 객체
<span class='linenumber'> 561</span>          */</span><span class="WHIT">
<span class='linenumber'> 562</span> </span><span class="WHIT">        </span><span class="NAME">obj.prototype.currentStack</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT">  </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 563</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">that</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">current</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments.callee.caller</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 564</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT">  </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 565</span> </span><span class="WHIT">            </span><span class="NAME">toString</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 566</span> </span><span class="WHIT">              </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">' @'</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">that.$classname</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 567</span> </span><span class="WHIT">              </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">that</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 568</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">that</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">current</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 569</span> </span><span class="WHIT">                  </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">cs.concat</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'();'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 570</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 571</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 572</span> </span><span class="WHIT">              </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">cs</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 573</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 574</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 575</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 576</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 577</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 578</span> </span><span class="WHIT">      
<span class='linenumber'> 579</span>       </span><span class="COMM">/**
<span class='linenumber'> 580</span>        * 소스(src) 객체의 프로퍼티들을 대상(dest) 객체에
<span class='linenumber'> 581</span>        * 추가하여 대상 객체에서도 소스 객체의 프로퍼티들에
<span class='linenumber'> 582</span>        * 접근할 수 있도록 한다.
<span class='linenumber'> 583</span>        * &lt;p/>
<span class='linenumber'> 584</span>        * 오직 소스 객체(상속된 프로퍼티 배제)에 있는 프로퍼티들만이
<span class='linenumber'> 585</span>        * 대상객체로 복사된다.
<span class='linenumber'> 586</span>        *
<span class='linenumber'> 587</span>        * @example
<span class='linenumber'> 588</span>        * var src = {
<span class='linenumber'> 589</span>        *   level: 'low',
<span class='linenumber'> 590</span>        *   opts: {one: 1, two: 2},
<span class='linenumber'> 591</span>        *   add: function (a, b) {
<span class='linenumber'> 592</span>        *     return a + b;
<span class='linenumber'> 593</span>        *   }
<span class='linenumber'> 594</span>        * };
<span class='linenumber'> 595</span>        *
<span class='linenumber'> 596</span>        * var dest = {
<span class='linenumber'> 597</span>        *   level: 'high',
<span class='linenumber'> 598</span>        *   opts: {three: 3, four: 4},
<span class='linenumber'> 599</span>        *   multiply: function (a, b) {
<span class='linenumber'> 600</span>        *     return a * b;
<span class='linenumber'> 601</span>        *   }
<span class='linenumber'> 602</span>        * }
<span class='linenumber'> 603</span>        * var d = tau.mixin(dest, src); // mixin
<span class='linenumber'> 604</span>        * d.multiply(2, 3); // 6
<span class='linenumber'> 605</span>        * d.add(2, 3); // 5 (mixed in)
<span class='linenumber'> 606</span>        * d.level; // 'high'
<span class='linenumber'> 607</span>        *
<span class='linenumber'> 608</span>        * d = tau.mixin(dest, src, true); // override
<span class='linenumber'> 609</span>        * d.level; // 'low' (overridden)
<span class='linenumber'> 610</span>        * d.opts; // {one: 1, two: 2}
<span class='linenumber'> 611</span>        *
<span class='linenumber'> 612</span>        * d = tau.mixin(dest, src, 'remix'); // 'remix'
<span class='linenumber'> 613</span>        * d.opts; // {one: 1, two: 2, three: 3, four: 4}
<span class='linenumber'> 614</span>        *
<span class='linenumber'> 615</span>        * d = tau.mixin(dest, src, true, ['level', 'add']); // 'filter'
<span class='linenumber'> 616</span>        * d.add(2, 3); // 5
<span class='linenumber'> 617</span>        * d.level; // 'low'
<span class='linenumber'> 618</span>        * d.opts; // {three: 3, four: 4}
<span class='linenumber'> 619</span>        *
<span class='linenumber'> 620</span>        * @param {Object} dest 프로퍼티들을 적용되는 목적 객체 또는 클래스
<span class='linenumber'> 621</span>        * @param {Object} src 프로퍼티들을 복사하기 위한 소스 객체 또는 클래스
<span class='linenumber'> 622</span>        * @param {Boolean|String} [override] Override 또는 'remix' (recursive mix)
<span class='linenumber'> 623</span>        * @param {Array} [filter] 소스 객체에 존재하면서 목적 객체에
<span class='linenumber'> 624</span>        * 복사하고자 하는 프로퍼티들에 대한 배열
<span class='linenumber'> 625</span>        * @returns {Object} 소스객체에 있는 프로퍼티들이 적용된 대상 객체
<span class='linenumber'> 626</span>        */</span><span class="WHIT">
<span class='linenumber'> 627</span> </span><span class="WHIT">      </span><span class="NAME">mixin</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">override</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">filter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 628</span> </span><span class="WHIT">        </span><span class="NAME">dest</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 629</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 630</span> </span><span class="WHIT">          </span><span class="COMM">// Copy properties on override or if it doesn't already exist</span><span class="WHIT">
<span class='linenumber'> 631</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 632</span> </span><span class="WHIT">            </span><span class="COMM">// Copy owned/filtered src properties to undefined/overriden dest</span><span class="WHIT">
<span class='linenumber'> 633</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">override</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 634</span> </span><span class="WHIT">                </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">filter</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">filter.indexOf</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 635</span> </span><span class="WHIT">              </span><span class="COMM">// Recursively mix or overwrite to dest property</span><span class="WHIT">
<span class='linenumber'> 636</span> </span><span class="WHIT">              </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">override</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'remix'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isObject</span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 637</span> </span><span class="WHIT">                </span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">override</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">filter</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 638</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 639</span> </span><span class="WHIT">                </span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 640</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 641</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 642</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 643</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 644</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 645</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 646</span> 
<span class='linenumber'> 647</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 648</span>        * 소스(src) 클래스 프로퍼티들을 대상(dest) 클래스에
<span class='linenumber'> 649</span>        * 추가한다.
<span class='linenumber'> 650</span>        * &lt;p/>
<span class='linenumber'> 651</span>        * 객체의 인스턴스를 augment할 경우 해당 객체에 대해서만
<span class='linenumber'> 652</span>        * 프로퍼티들이 적용되며, 클래스 프로퍼티(prototype)을
<span class='linenumber'> 653</span>        * augment할 경우 이후 생성되는 해당 클래스로 생성하는
<span class='linenumber'> 654</span>        * 모든 인스턴스에 프로퍼티들이 적용된다(new 생성자를
<span class='linenumber'> 655</span>        * 통해 성생되는 객체)
<span class='linenumber'> 656</span>        *
<span class='linenumber'> 657</span>        * @param {Object} dest 대상(목적) 객체 또는 클래스. 이 객체 
<span class='linenumber'> 658</span>        * 또는 클래스로 프로퍼티들이 추가된다.
<span class='linenumber'> 659</span>        * @param {Object} src 소스 클래스. 추가하고자 하는 프로프티를
<span class='linenumber'> 660</span>        * 가지고 있는 클래스
<span class='linenumber'> 661</span>        * @param {Boolean} [override] 대상객체에 소스객체와 동일한 프로퍼티를
<span class='linenumber'> 662</span>        * 가지고 있다면 덮어쓸지 결정한다.
<span class='linenumber'> 663</span>        * @param {Array} [filter] 적용하고자 하는 프로퍼티 이름에 대한 배열
<span class='linenumber'> 664</span>        * @returns {Object} 프로퍼티들이 적용된 목적 객체 또는 클래스
<span class='linenumber'> 665</span>        * @throws {Error} 대상 또는 소스 파라미터가 적절하지 않을 경우
<span class='linenumber'> 666</span>        */</span><span class="WHIT">
<span class='linenumber'> 667</span> </span><span class="WHIT">      </span><span class="NAME">augment</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">override</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">filter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 668</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">srcProp</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">makeProxyFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">proxyFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">originalFn</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 669</span> </span><span class="WHIT">            </span><span class="NAME">isDestProto</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.isObject</span><span class="PUNC">(</span><span class="NAME">dest.prototype</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 670</span> </span><span class="WHIT">            </span><span class="NAME">destProto</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dest.prototype</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 671</span> </span><span class="WHIT">            </span><span class="NAME">destTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dest.prototype</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 672</span> </span><span class="WHIT">            </span><span class="NAME">srcProto</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 673</span> 
<span class='linenumber'> 674</span> </span><span class="WHIT">        </span><span class="COMM">// Prototype augmentation: make proxy functions to call constructor</span><span class="WHIT">
<span class='linenumber'> 675</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isDestProto</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 676</span> </span><span class="WHIT">          </span><span class="NAME">proxyFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 677</span> </span><span class="WHIT">          </span><span class="NAME">originalFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 678</span> </span><span class="WHIT">          </span><span class="COMM">/** @inner Maps an original function to a proxy function. */</span><span class="WHIT">
<span class='linenumber'> 679</span> </span><span class="WHIT">          </span><span class="NAME">makeProxyFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 680</span> </span><span class="WHIT">            </span><span class="COMM">/**
<span class='linenumber'> 681</span>              * Proxy members functions are assigned to each original members. 
<span class='linenumber'> 682</span>              * When one is called, it will execute the instance's contructor, 
<span class='linenumber'> 683</span>              * so that it can inherit any of its this assigments, and re-attach
<span class='linenumber'> 684</span>              * all the original members and properties.
<span class='linenumber'> 685</span>              * @inner
<span class='linenumber'> 686</span>              */</span><span class="WHIT">
<span class='linenumber'> 687</span> </span><span class="WHIT">            </span><span class="NAME">proxyFn</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 688</span> </span><span class="WHIT">              </span><span class="COMM">// Re-attach all the original properties prior to constructor call</span><span class="WHIT">
<span class='linenumber'> 689</span> </span><span class="WHIT">              </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">originalFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 690</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">originalFn.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">proxyFn</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 691</span> </span><span class="WHIT">                  </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">originalFn</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 692</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 693</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 694</span> </span><span class="WHIT">              </span><span class="NAME">src.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// src constructor call to inherit this props</span><span class="WHIT">
<span class='linenumber'> 695</span> </span><span class="WHIT">              </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">originalFn</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// original function</span><span class="WHIT">
<span class='linenumber'> 696</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 697</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">proxyFn</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 698</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 699</span> 
<span class='linenumber'> 700</span> </span><span class="WHIT">          </span><span class="COMM">// Iterate through source properties and create/attach proxy props</span><span class="WHIT">
<span class='linenumber'> 701</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">srcProto</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 702</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">srcProto.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 703</span> </span><span class="WHIT">              </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">filter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">filter.indexOf</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 704</span> </span><span class="WHIT">                  </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">override</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">destProto</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 705</span> </span><span class="WHIT">                </span><span class="NAME">srcProp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">srcProto</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 706</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">srcProp</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 707</span> </span><span class="WHIT">                  </span><span class="COMM">// Save original properties to originalFn and attach the proxy</span><span class="WHIT">
<span class='linenumber'> 708</span> </span><span class="WHIT">                  </span><span class="NAME">originalFn</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">srcProp</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 709</span> </span><span class="WHIT">                  </span><span class="NAME">destProto</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">makeProxyFn</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 710</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 711</span> </span><span class="WHIT">                  </span><span class="COMM">// No need to create proxy members, just attach the property</span><span class="WHIT">
<span class='linenumber'> 712</span> </span><span class="WHIT">                  </span><span class="NAME">destProto</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">srcProp</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 713</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 714</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 715</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 716</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 717</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 718</span> 
<span class='linenumber'> 719</span> </span><span class="WHIT">        </span><span class="COMM">// Mixes source prototype properties to destTarget (prototype)</span><span class="WHIT">
<span class='linenumber'> 720</span> </span><span class="WHIT">        </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">destTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">srcProto</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">override</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">filter</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 721</span> 
<span class='linenumber'> 722</span> </span><span class="WHIT">        </span><span class="COMM">// Object instance augmentation: call source constructor to get props</span><span class="WHIT">
<span class='linenumber'> 723</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isDestProto</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 724</span> </span><span class="WHIT">          </span><span class="NAME">src.apply</span><span class="PUNC">(</span><span class="NAME">destTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 725</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 726</span> 
<span class='linenumber'> 727</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">destTarget</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 728</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 729</span> 
<span class='linenumber'> 730</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 731</span>        * JavaScript의 네임스페이스를 정의한다.
<span class='linenumber'> 732</span>        * &lt;p/>
<span class='linenumber'> 733</span>        * 기존에 정의된 네임스페이스 구조에서 정의된
<span class='linenumber'> 734</span>        * 네임스페이스가 존재하지 않는다면 기존의 네임스페이스
<span class='linenumber'> 735</span>        * 구조를 덮어쓰지 않고 새로운 네임스페이스를 추가한다.
<span class='linenumber'> 736</span>        * &lt;p/>
<span class='linenumber'> 737</span>        * 네임스페이스의 문법이 적절하지 않거나 기존에 있는
<span class='linenumber'> 738</span>        * 네임스페이스를 덮어쓰려고할 경우 Error가 발생된다.
<span class='linenumber'> 739</span>        * @example
<span class='linenumber'> 740</span>        * tau.namespace('foo.bar'); // creates namespace 'foo.bar'
<span class='linenumber'> 741</span>        * tau.namespace('foo.bar', {name: 'mobell'});
<span class='linenumber'> 742</span>        * foo.bar.name; // 'mobell'
<span class='linenumber'> 743</span>        *
<span class='linenumber'> 744</span>        * tau.namespace('foo.bar.baz', function () { return 'mobello';});
<span class='linenumber'> 745</span>        * foo.bar.baz(); // 'mobello'
<span class='linenumber'> 746</span>        *
<span class='linenumber'> 747</span>        * @param {String} ns 선언할 네임스페이스 문자열
<span class='linenumber'> 748</span>        * @param {Object|Function} [attach] 네임스페이스에 추가할 
<span class='linenumber'> 749</span>        * 프로퍼티 또는 Function
<span class='linenumber'> 750</span>        * @param {Boolean} [overwrite] true이면 기존의 네임스페이스를 덮어쓴다.
<span class='linenumber'> 751</span>        * @returns {Boolean} 적어도 하나이상의 네임스페이스가 수정되었다면
<span class='linenumber'> 752</span>        * true를 반환한다.
<span class='linenumber'> 753</span>        * @throws {Error} 네임스페이스의 형식이 적절하지 않거나 이전에 동일한
<span class='linenumber'> 754</span>        * 이름의 네임스페이스가 정의되어 있을 경우
<span class='linenumber'> 755</span>        */</span><span class="WHIT">
<span class='linenumber'> 756</span> </span><span class="WHIT">      </span><span class="NAME">namespace</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attach</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">overwrite</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 757</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 758</span> </span><span class="WHIT">            </span><span class="NAME">modified</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 759</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isNamespace</span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 760</span> </span><span class="WHIT">          </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">SyntaxError</span><span class="PUNC">(</span><span class="STRN">'tau.namespace: invalid namespace, '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 761</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 762</span> 
<span class='linenumber'> 763</span> </span><span class="WHIT">        </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">GLOBAL</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 764</span> </span><span class="WHIT">        </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ns.split</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 765</span> </span><span class="WHIT">        </span><span class="NAME">isFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">attach</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 766</span> </span><span class="WHIT">        </span><span class="COMM">// Validate each namespace parts (create one if it doesn't exist)</span><span class="WHIT">
<span class='linenumber'> 767</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">isFn</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">parts.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">parts.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 768</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 769</span> </span><span class="WHIT">            </span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 770</span> </span><span class="WHIT">            </span><span class="NAME">modified</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 771</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">overwrite</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'> 772</span>               </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 773</span> </span><span class="WHIT">            </span><span class="COMM">// Any parent part in the namespace must not be a function</span><span class="WHIT">
<span class='linenumber'> 774</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.namespace: \"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">parts.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'> 775</span> </span><span class="WHIT">                </span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\" function was previously defined in hierarchy'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 776</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 777</span> </span><span class="WHIT">          </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 778</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 779</span> 
<span class='linenumber'> 780</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">isFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 781</span> </span><span class="WHIT">          </span><span class="COMM">// Function assignment for the last portion of namespace</span><span class="WHIT">
<span class='linenumber'> 782</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">overwrite</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 783</span> </span><span class="WHIT">            </span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attach</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 784</span> </span><span class="WHIT">            </span><span class="NAME">modified</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 785</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 786</span> </span><span class="WHIT">            </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.namespace: \"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\" definition '</span><span class="WHIT"> 
<span class='linenumber'> 787</span>                 </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' already exists, cannot be overridden'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 788</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 789</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 790</span> </span><span class="WHIT">          </span><span class="COMM">// Attach properties to the final namespace part; does not overwrite</span><span class="WHIT">
<span class='linenumber'> 791</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">attach</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 792</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">attach.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 793</span> </span><span class="WHIT">              </span><span class="NAME">parent</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attach</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 794</span> </span><span class="WHIT">              </span><span class="NAME">modified</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 795</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 796</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 797</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 798</span> 
<span class='linenumber'> 799</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">modified</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 800</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 801</span> 
<span class='linenumber'> 802</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 803</span>        * 명시된 객체(obj)를 복제하여 새로운 객체를 리턴한다. 
<span class='linenumber'> 804</span>        * 복제에 사용할수 있는 객체로는 object, function, array, date, RegExp이
<span class='linenumber'> 805</span>        * 가능하다.
<span class='linenumber'> 806</span>        * @example
<span class='linenumber'> 807</span>        * var original = new tau.ScriptHelper();
<span class='linenumber'> 808</span>        * alert(original !== tau.clone(original)); // true
<span class='linenumber'> 809</span>        *
<span class='linenumber'> 810</span>        * @param {Object} obj 복제하고자 하는 객체
<span class='linenumber'> 811</span>        * @param {Boolean} [deep] 재귀적인 방법으로 내부 프로퍼티들을 모두 복제한다.
<span class='linenumber'> 812</span>        * @param {Array} [ignore] deep clone하지 않을 프로퍼티들의 배열
<span class='linenumber'> 813</span>        * @returns {Object} 새롭게 복제된 객체
<span class='linenumber'> 814</span>        */</span><span class="WHIT">
<span class='linenumber'> 815</span> </span><span class="WHIT">      </span><span class="NAME">clone</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">deep</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ignore</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 816</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cloned</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'> 817</span>             </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">HTMLElement</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.typeOf</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 818</span> </span><span class="WHIT">        </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 819</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 820</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'error'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 821</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.constructor</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">Object.prototype.constructor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 822</span> </span><span class="WHIT">            </span><span class="NAME">cloned</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// JSON object</span><span class="WHIT">
<span class='linenumber'> 823</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 824</span> </span><span class="WHIT">            </span><span class="COMM">/** @inner Cloning instance's state is preserved as a new Class. */</span><span class="WHIT">
<span class='linenumber'> 825</span> </span><span class="WHIT">            </span><span class="NAME">F</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 826</span> </span><span class="WHIT">            </span><span class="NAME">F.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// obj changes are applied to cloned's prototype</span><span class="WHIT">
<span class='linenumber'> 827</span> </span><span class="WHIT">            </span><span class="NAME">cloned</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 828</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 829</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 830</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 831</span> </span><span class="WHIT">          </span><span class="COMM">/** @inner Cloning function is callbed by a new function. */</span><span class="WHIT">
<span class='linenumber'> 832</span> </span><span class="WHIT">          </span><span class="NAME">cloned</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 833</span> </span><span class="WHIT">            </span><span class="NAME">obj.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 834</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 835</span> </span><span class="WHIT">          </span><span class="NAME">cloned.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 836</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 837</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'array'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 838</span> </span><span class="WHIT">          </span><span class="NAME">cloned</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 839</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 840</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'date'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 841</span> </span><span class="WHIT">          </span><span class="NAME">cloned</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 842</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 843</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'regexp'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 844</span> </span><span class="WHIT">          </span><span class="NAME">cloned</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="NAME">obj.source</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 845</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 846</span> </span><span class="WHIT">        </span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'> 847</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 848</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 849</span> 
<span class='linenumber'> 850</span> </span><span class="WHIT">        </span><span class="COMM">// Copy, or recursively deep copy, properties to cloned's 'this'</span><span class="WHIT">
<span class='linenumber'> 851</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 852</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'> 853</span>               </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">ignore</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">ignore.indexOf</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 854</span> </span><span class="WHIT">            </span><span class="NAME">cloned</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">deep</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.clone</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">deep</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ignore</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 855</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 856</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 857</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">cloned</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 858</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 859</span> 
<span class='linenumber'> 860</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 861</span>        * 자식 클래스가 부모클래스의 프로퍼티들을 상속받도록 한다.
<span class='linenumber'> 862</span>        * &lt;p/>
<span class='linenumber'> 863</span>        * 새로운 프로퍼티와 메소드들을 추가하고자 할 경우 &lt;code>props&lt;/code>
<span class='linenumber'> 864</span>        * 파라미터를 통해 기술해야 한다. 부모클래스에서 동일한 이름의 
<span class='linenumber'> 865</span>        * 프로퍼티를 가지고 있을 경우 자식클래스에 의해 오버라이드 된다.
<span class='linenumber'> 866</span>        * &lt;p/>
<span class='linenumber'> 867</span>        * 추가적으로, 자식클래스에서는 &lt;code>superclass&lt;/code>
<span class='linenumber'> 868</span>        * 프로퍼티를 통해 부모클래스의 메소드와 프로퍼티들에
<span class='linenumber'> 869</span>        * 접근할 수 있다.
<span class='linenumber'> 870</span>        * &lt;p/>
<span class='linenumber'> 871</span>        * 주의: 정상적인 상속을 위해 자식클래스는 생성자 안에서 부모클래스의
<span class='linenumber'> 872</span>        * 생성자를 호출해야 한다. 
<span class='linenumber'> 873</span>        * @example
<span class='linenumber'> 874</span>        * function tau.example.MySubClass() {
<span class='linenumber'> 875</span>        *   tau.example.MySubClass.superclass.constructor.apply(this, arguments);
<span class='linenumber'> 876</span>        * }
<span class='linenumber'> 877</span>        * tau.extend(tau.example.MySubClass, tau.example.MyClass);
<span class='linenumber'> 878</span>        *
<span class='linenumber'> 879</span>        * @param {Object} child 자식 클래스
<span class='linenumber'> 880</span>        * @param {Object} parent 상속받고자 하는 부모 클래스
<span class='linenumber'> 881</span>        * @param {Object} [props] 추가 또는 오버라이드하고자 하는 프로퍼티
<span class='linenumber'> 882</span>        * @returns {Object} 명시된 프로퍼티가 적용된 상속받은 클래스
<span class='linenumber'> 883</span>        * @throws {Error} child, parent 파라미터가 클래스(function)가 아닐경우
<span class='linenumber'> 884</span>        */</span><span class="WHIT">
<span class='linenumber'> 885</span> </span><span class="WHIT">      </span><span class="NAME">extend</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">props</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 886</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 887</span> </span><span class="WHIT">        </span><span class="COMM">// Only allow Classes (functions) as parameters</span><span class="WHIT">
<span class='linenumber'> 888</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 889</span> </span><span class="WHIT">          </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'tau.extend: parameters must be classes.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 890</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 891</span> 
<span class='linenumber'> 892</span> </span><span class="WHIT">        </span><span class="COMM">// Create prototype inheritance references for the child class</span><span class="WHIT">
<span class='linenumber'> 893</span> </span><span class="WHIT">        </span><span class="COMM">/** @inner */</span><span class="WHIT">
<span class='linenumber'> 894</span> </span><span class="WHIT">        </span><span class="NAME">F</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 895</span> </span><span class="WHIT">        </span><span class="NAME">F.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 896</span> </span><span class="WHIT">        </span><span class="NAME">child.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 897</span> </span><span class="WHIT">        </span><span class="NAME">child.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">child</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 898</span> 
<span class='linenumber'> 899</span> </span><span class="WHIT">        </span><span class="COMM">// Child class can call parent's methods via the superclass property.</span><span class="WHIT">
<span class='linenumber'> 900</span> </span><span class="WHIT">        </span><span class="COMM">// If the parent's constructor is the Object itself, we must reassign</span><span class="WHIT">
<span class='linenumber'> 901</span> </span><span class="WHIT">        </span><span class="COMM">// the constructor to itself for proper super call</span><span class="WHIT">
<span class='linenumber'> 902</span> </span><span class="WHIT">        </span><span class="NAME">child.superclass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 903</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="WHIT">
<span class='linenumber'> 904</span> </span><span class="WHIT">            </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">parent.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">Object.prototype.constructor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 905</span> </span><span class="WHIT">          </span><span class="NAME">parent.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 906</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 907</span> 
<span class='linenumber'> 908</span> </span><span class="WHIT">        </span><span class="COMM">// Add/Override extended functions the child class</span><span class="WHIT">
<span class='linenumber'> 909</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">props</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 910</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">props.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 911</span> </span><span class="WHIT">            </span><span class="NAME">child.prototype</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">props</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 912</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 913</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'> 914</span> 
<span class='linenumber'> 915</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">child</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 916</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 917</span> 
<span class='linenumber'> 918</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 919</span>        * 클래스 프로퍼티 이름(prop)과 새로운 인스턴스
<span class='linenumber'> 920</span>        * 스크립트(string) 또는 function을 위용하여
<span class='linenumber'> 921</span>        * lazy-loading getter function을 생성한다.
<span class='linenumber'> 922</span>        * &lt;p/>
<span class='linenumber'> 923</span>        * 주의: &lt;code>prop&lt;/code>파라미터로 지정된 프로퍼티
<span class='linenumber'> 924</span>        * 이름과 prototype의 프로퍼티 이름이 정확히 일치해야
<span class='linenumber'> 925</span>        * 한다.
<span class='linenumber'> 926</span>        * @example
<span class='linenumber'> 927</span>        * MyClass.prototype = {
<span class='linenumber'> 928</span>        *   getFoo: tau.getterFactory('getFoo', 'new tau.URLHelper'),
<span class='linenumber'> 929</span>        *   getBar: tau.getterFactory('getBar', function () { return []; })
<span class='linenumber'> 930</span>        * }
<span class='linenumber'> 931</span>        *
<span class='linenumber'> 932</span>        * @param {String} prop 클래스의 프로퍼티 이름
<span class='linenumber'> 933</span>        * @param {String|Function} instanceFactory 인스턴스 스크립트 또는 function
<span class='linenumber'> 934</span>        * @param {Array} [instanceFactory] instanceFactory 호출시 사용할 라파미터 배열
<span class='linenumber'> 935</span>        * @returns {Function} Lazy-loading getter function
<span class='linenumber'> 936</span>        */</span><span class="WHIT">
<span class='linenumber'> 937</span> </span><span class="WHIT">      </span><span class="NAME">getterFactory</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">prop</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">instanceFactory</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">instanceFactoryArgs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 938</span> </span><span class="WHIT">        </span><span class="NAME">instanceFactory</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">instanceFactory</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT">
<span class='linenumber'> 939</span> </span><span class="WHIT">            </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Function</span><span class="PUNC">(</span><span class="STRN">'return '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">instanceFactory</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">';'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">instanceFactory</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 940</span> </span><span class="WHIT">        </span><span class="NAME">instanceFactoryArgs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">instanceFactoryArgs</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'array'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT">
<span class='linenumber'> 941</span> </span><span class="WHIT">            </span><span class="NAME">instanceFactoryArgs</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 942</span> </span><span class="WHIT">        </span><span class="COMM">/** @inner First-call function that creates an instance of the object */</span><span class="WHIT">
<span class='linenumber'> 943</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 944</span> </span><span class="WHIT">          </span><span class="COMM">// Creates a new closure object for the class instance</span><span class="WHIT">
<span class='linenumber'> 945</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">instance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">instanceFactory.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">instanceFactoryArgs</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 946</span> </span><span class="WHIT">          </span><span class="COMM">/** @inner Replaces the getter function with the closed instance */</span><span class="WHIT">
<span class='linenumber'> 947</span> </span><span class="WHIT">          </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'> 948</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">instance</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 949</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 950</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">instance</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 951</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'> 952</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'> 953</span> 
<span class='linenumber'> 954</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'> 955</span>        * 객체의 프로퍼티들의 값을 이에 상응하는 프로퍼트 setter function을 통해
<span class='linenumber'> 956</span>        * 설정되도록 한다.
<span class='linenumber'> 957</span>        * &lt;p/>
<span class='linenumber'> 958</span>        * 기본 동작은 Camelcase로 구성된 setter function을
<span class='linenumber'> 959</span>        * 호출한다. 즉, 특정 객체가 &lt;code>foo&lt;/code>라는
<span class='linenumber'> 960</span>        * 프로퍼티를 가지고 있다면 이 프로퍼트에 해당하는 값을
<span class='linenumber'> 961</span>        * &lt;code>setFoo&lt;/code> function의 파라미터로 활용해 설정한다.
<span class='linenumber'> 962</span>        * &lt;p/>
<span class='linenumber'> 963</span>        * Optionize는 opts 파라미터를 활용해 customizing할 수
<span class='linenumber'> 964</span>        * 있다. customizing할 수 있는 옵션들로
<span class='linenumber'> 965</span>        * &lt;code>override, filter, defaultFn, handler&lt;/code>가 있다.
<span class='linenumber'> 966</span>        * @example
<span class='linenumber'> 967</span>        * var myobj = {
<span class='linenumber'> 968</span>        *   _name: 'mobello',
<span class='linenumber'> 969</span>        *   version: '1.0',
<span class='linenumber'> 970</span>        *
<span class='linenumber'> 971</span>        *   setName: function (name) {
<span class='linenumber'> 972</span>        *     this._name = name;
<span class='linenumber'> 973</span>        *   },
<span class='linenumber'> 974</span>        *
<span class='linenumber'> 975</span>        *   setVersion: function (ver) {
<span class='linenumber'> 976</span>        *     this.version = ver;
<span class='linenumber'> 977</span>        *   }
<span class='linenumber'> 978</span>        * };
<span class='linenumber'> 979</span>        * // myobj._name -> 'mobello'
<span class='linenumber'> 980</span>        *
<span class='linenumber'> 981</span>        * tau.optionize(myobj, {name: 'hello mobello'});
<span class='linenumber'> 982</span>        * // myobj._name -> 'hello mobello'
<span class='linenumber'> 983</span>        * 
<span class='linenumber'> 984</span>        * tau.optionize(myobj, {version: '2.0'});
<span class='linenumber'> 985</span>        * // myobj.version -> '1.0' (has same property)
<span class='linenumber'> 986</span>        *
<span class='linenumber'> 987</span>        * tau.optionize(myobj, {version: '2.0'}, {override: true});
<span class='linenumber'> 988</span>        * // myobj.version -> '2.0' (override)
<span class='linenumber'> 989</span>        *
<span class='linenumber'> 990</span>        * tau.optionize(myobj, {name: 'hello', version: '3.0'}, 
<span class='linenumber'> 991</span>        *    {override: true, filter: ['version']}); 
<span class='linenumber'> 992</span>        * // myobj._name -> 'hello mobello'
<span class='linenumber'> 993</span>        * // myobj.version -> '3.0'
<span class='linenumber'> 994</span>        *
<span class='linenumber'> 995</span>        * tau.optionize(myobj, {name: 'hello', version: '3.0'}, 
<span class='linenumber'> 996</span>        *    {override: true, filter: ['version', 'name']}); 
<span class='linenumber'> 997</span>        * // myobj._name -> 'hello'
<span class='linenumber'> 998</span>        * // myobj.version -> '3.0'
<span class='linenumber'> 999</span>        *
<span class='linenumber'>1000</span>        * tau.optionize(myobj, {name: 'hello'}, {
<span class='linenumber'>1001</span>        *   handler: {
<span class='linenumber'>1002</span>        *     name: function (p, v) { // property, value
<span class='linenumber'>1003</span>        *       this._name = v + ' mobello again'
<span class='linenumber'>1004</span>        *     }
<span class='linenumber'>1005</span>        *   }
<span class='linenumber'>1006</span>        * });
<span class='linenumber'>1007</span>        * // myobj._name -> 'hello mobello again'
<span class='linenumber'>1008</span>        *
<span class='linenumber'>1009</span>        * @param {Object} dest 프로퍼티를 적용될 목적 객체 또는 클래스
<span class='linenumber'>1010</span>        * @param {Object} src 적용하고자 하는 소스 객체
<span class='linenumber'>1011</span>        * @param {Object} [opts] 옵션: override, filter, handler, defaultFn
<span class='linenumber'>1012</span>        * @param opts.override Boolean으로 표현되며 true일 경우
<span class='linenumber'>1013</span>        * 기존의 값을 덮어 쓴다.
<span class='linenumber'>1014</span>        * @param opts.filter Array로 표현되며 optionize
<span class='linenumber'>1015</span>        * 적용하고자 하는 프로퍼티들을 배열로 기술한다.
<span class='linenumber'>1016</span>        * @param opts.handler Object로 기술하며 해당 프로퍼티를
<span class='linenumber'>1017</span>        * 키로 하고 value는 custom function으로 기술한다.
<span class='linenumber'>1018</span>        * @param opts.defaultFn default function을
<span class='linenumber'>1019</span>        * override한다. Camelcase의 setter가 아닌 다른 방법으로 값을 설정하고자
<span class='linenumber'>1020</span>        * 할 경우 defaultFn을 확장해서 사용한다.
<span class='linenumber'>1021</span>        * @returns {Object} 프로퍼티들이 적용된 목적 객체
<span class='linenumber'>1022</span>        */</span><span class="WHIT">
<span class='linenumber'>1023</span> </span><span class="WHIT">      </span><span class="NAME">optionize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1024</span> </span><span class="WHIT">        </span><span class="NAME">dest</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1025</span> </span><span class="WHIT">        </span><span class="NAME">opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1026</span> </span><span class="WHIT">          </span><span class="NAME">override</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1027</span> </span><span class="WHIT">          </span><span class="COMM">/**
<span class='linenumber'>1028</span>            * Default Propery handler: calls set&lt;PropName>() function on dest
<span class='linenumber'>1029</span>            * @inner
<span class='linenumber'>1030</span>            * @param {Object} p Property Name
<span class='linenumber'>1031</span>            * @param {Object} v Property value
<span class='linenumber'>1032</span>            */</span><span class="WHIT">
<span class='linenumber'>1033</span> </span><span class="WHIT">          </span><span class="NAME">defaultFn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1034</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">[</span><span class="STRN">'set'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">p.charAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">p.slice</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1035</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1036</span> </span><span class="WHIT">              </span><span class="NAME">fn.call</span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1037</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1038</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1039</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1040</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1041</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1042</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts.override</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1043</span> </span><span class="WHIT">                </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">opts.filter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts.filter.indexOf</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1044</span> </span><span class="WHIT">              </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">opts.handler</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">opts.handler</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1045</span> </span><span class="WHIT">                </span><span class="NAME">opts.defaultFn.call</span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">              
<span class='linenumber'>1046</span>               </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1047</span> </span><span class="WHIT">                </span><span class="NAME">opts.handler</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">call</span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1048</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1049</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1050</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1051</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1052</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1053</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1054</span> 
<span class='linenumber'>1055</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1056</span>        * 배열 또는 배열과 같은 객체들의 각 앨리먼트들
<span class='linenumber'>1057</span>        * Iteration하면서 &lt;code>callbackFn&lt;/code>을 호출한다.
<span class='linenumber'>1058</span>        * 이때 &lt;code>callbackFn&lt;/code>의 파라미터로 배열의 값과
<span class='linenumber'>1059</span>        * 인덱스(또는 프로퍼티), 그리고 원본 객체를 넘겨 받는다.
<span class='linenumber'>1060</span>        * @example
<span class='linenumber'>1061</span>        * var myarr = ['mobello', '1.0'];
<span class='linenumber'>1062</span>        * tau.forEach(myarr, function (a, b, c) {
<span class='linenumber'>1063</span>        *   alert(a + ', ' + b + ', ' + c);
<span class='linenumber'>1064</span>        * }, myarr);
<span class='linenumber'>1065</span>        * 
<span class='linenumber'>1066</span>        * // prints 
<span class='linenumber'>1067</span>        * // mobello, 0, mobello,1.0
<span class='linenumber'>1068</span>        * // 1.0, 1, mobello,1.0
<span class='linenumber'>1069</span>        * 
<span class='linenumber'>1070</span>        * var myobj = { name: 'mobello', version: '1.0' };
<span class='linenumber'>1071</span>        * tau.forEach(myobj, function (a, b, c) {
<span class='linenumber'>1072</span>        *   alert(a + ', ' + b + ', ' + c);
<span class='linenumber'>1073</span>        * }, myobj);
<span class='linenumber'>1074</span>        * // prints
<span class='linenumber'>1075</span>        * // mobello, name, [object Object]
<span class='linenumber'>1076</span>        * // 1.0, version, [object Object]
<span class='linenumber'>1077</span>        *
<span class='linenumber'>1078</span>        * @param {Object} obj 배열 또는 배열과 같은
<span class='linenumber'>1079</span>        * 객체(associateve array)
<span class='linenumber'>1080</span>        * @param {Function} callbackFn 각 iteration마다 호출될 callback function.
<span class='linenumber'>1081</span>        * callback function의 파라미터(3개)는 차례대로 값, 배열의 인덱스
<span class='linenumber'>1082</span>        * 또는 객체의 프로퍼티, 원본객체가 된다.
<span class='linenumber'>1083</span>        * @param {Object} context CallbackFn 내에서 사용할 'this' context
<span class='linenumber'>1084</span>        */</span><span class="WHIT">
<span class='linenumber'>1085</span> </span><span class="WHIT">      </span><span class="NAME">forEach</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1086</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='linenumber'>1087</span>         </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1088</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1089</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn.call</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1090</span> </span><span class="WHIT">              </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1091</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1092</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1093</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1094</span> </span><span class="WHIT">          </span><span class="NAME">obj.forEach</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1095</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1096</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1097</span> 
<span class='linenumber'>1098</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1099</span>        * 소스(src) 배열을 목적(dest) 배열로 합친다음 결과를
<span class='linenumber'>1100</span>        * 반환한다.
<span class='linenumber'>1101</span>        * @example
<span class='linenumber'>1102</span>        * var src = ['mobello', '1.0'];
<span class='linenumber'>1103</span>        * var dest = ['hello', 'world'];
<span class='linenumber'>1104</span>        * tau.merge(dest, src); // ["hello", "world", "mobello", "1.0"]
<span class='linenumber'>1105</span>        *
<span class='linenumber'>1106</span>        * @param {Array} dest 합쳐질 목적 배열
<span class='linenumber'>1107</span>        * @param {Array} src 원본배열
<span class='linenumber'>1108</span>        * @returns {Array} 소스 배열과 합쳐진 목적 배열
<span class='linenumber'>1109</span>        */</span><span class="WHIT">
<span class='linenumber'>1110</span> </span><span class="WHIT">      </span><span class="NAME">merge</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">dest</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1111</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1112</span> </span><span class="WHIT">            </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1113</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">src.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1114</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1115</span> </span><span class="WHIT">            </span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">dest.length</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1116</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1117</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1118</span> </span><span class="WHIT">          </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">src</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1119</span> </span><span class="WHIT">            </span><span class="NAME">dest</span><span class="PUNC">[</span><span class="NAME">dest.length</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1120</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1121</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1122</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">dest</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1123</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1124</span> 
<span class='linenumber'>1125</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1126</span>        * 문자열의 앞, 뒤에 있는 공백 문자열을 모두제거하여
<span class='linenumber'>1127</span>        * 반환한다.
<span class='linenumber'>1128</span>        * @example
<span class='linenumber'>1129</span>        * var str = ' hello mobello  ';
<span class='linenumber'>1130</span>        * str = tau.trim(str); // 'hello mobello'
<span class='linenumber'>1131</span>        *
<span class='linenumber'>1132</span>        * @param {String} text 공백을 제거할 문자열
<span class='linenumber'>1133</span>        * @returns {String} 공백이 제거된 문자열
<span class='linenumber'>1134</span>        */</span><span class="WHIT">
<span class='linenumber'>1135</span> </span><span class="WHIT">      </span><span class="NAME">trim</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1136</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/^\s+/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\s+$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1137</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1138</span> 
<span class='linenumber'>1139</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1140</span>        * '-'(dash)로 연결된 문자열을 CamelCase로 변환하여
<span class='linenumber'>1141</span>        * 반환한다.
<span class='linenumber'>1142</span>        * @example
<span class='linenumber'>1143</span>        * var str = 'foo-bar';
<span class='linenumber'>1144</span>        * str = tau.camelize(str); // fooBar
<span class='linenumber'>1145</span>        *
<span class='linenumber'>1146</span>        * @param {String} text Camelize할 문자열
<span class='linenumber'>1147</span>        * @returns {String} Cameliz된 문자열
<span class='linenumber'>1148</span>        */</span><span class="WHIT">
<span class='linenumber'>1149</span> </span><span class="WHIT">      </span><span class="NAME">camelize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isLowerCase</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1150</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">text.replace</span><span class="PUNC">(</span><span class="REGX">/-([a-z])/ig</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">all</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">letter</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1151</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">letter.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1152</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1153</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1154</span> 
<span class='linenumber'>1155</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1156</span>        * Camelize된 문자열을 underscore('_')로 분리된 문자열로
<span class='linenumber'>1157</span>        * 변환하여 반환한다.
<span class='linenumber'>1158</span>        * @example
<span class='linenumber'>1159</span>        * var str = 'fooBar';
<span class='linenumber'>1160</span>        * str = tau.underscore(str); // foo_bar
<span class='linenumber'>1161</span>        *
<span class='linenumber'>1162</span>        * @param {String} text underscore로 치환환 Camelcase
<span class='linenumber'>1163</span>        * 문자열
<span class='linenumber'>1164</span>        * @returns {String} Underscore로 치환된 문자열
<span class='linenumber'>1165</span>        */</span><span class="WHIT">
<span class='linenumber'>1166</span> </span><span class="WHIT">      </span><span class="NAME">underscore</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1167</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">text.replace</span><span class="PUNC">(</span><span class="REGX">/::/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'/'</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1168</span> </span><span class="WHIT">                   </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/([A-Z]+)([A-Z][a-z])/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'$1_$2'</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1169</span> </span><span class="WHIT">                   </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/([a-z\d])([A-Z])/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'$1_$2'</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1170</span> </span><span class="WHIT">                   </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/-/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'_'</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1171</span> </span><span class="WHIT">                   </span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1172</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1173</span> 
<span class='linenumber'>1174</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1175</span>        * 상대경로의 URL을 절대경로의 URL로 치환하여 반환한다.
<span class='linenumber'>1176</span>        * &lt;p/>
<span class='linenumber'>1177</span>        * base가 명시되어 있어있고 URL이 상대경로이면 base를
<span class='linenumber'>1178</span>        * 이용하여 절대경로를 생성한 다음 결과를 반환한다.
<span class='linenumber'>1179</span>        * &lt;p/>
<span class='linenumber'>1180</span>        * 주의: 상대경로는 http, ftp등의 scheme을 명시하지
<span class='linenumber'>1181</span>        * 않으며 &lt;code>./&lt;/code>, &lt;code>../&lt;/code>,
<span class='linenumber'>1182</span>        * &lt;code>/&lt;/code>, &lt;code>//&lt;/code> 등으로 시작하거나
<span class='linenumber'>1183</span>        * prefix가 없이 시작한다.
<span class='linenumber'>1184</span>        * @example
<span class='linenumber'>1185</span>        * tau.resolveURL('foo.html');
<span class='linenumber'>1186</span>        * // "file:///E:/workspace/mobell/src/foo.html" (current path)
<span class='linenumber'>1187</span>        *
<span class='linenumber'>1188</span>        * tau.resolveURL('foo.html', 'http://bar.com/');
<span class='linenumber'>1189</span>        * // "http://bar.com/foo.html"
<span class='linenumber'>1190</span>        *
<span class='linenumber'>1191</span>        * @param {String} url Any URL
<span class='linenumber'>1192</span>        * @param {String} [base] 사용할 Base URL, 명시되지 않으면 '/'을 사용
<span class='linenumber'>1193</span>        * @returns {String} Base URL을 사용한 절대 경고의 URL
<span class='linenumber'>1194</span>        */</span><span class="WHIT">
<span class='linenumber'>1195</span> </span><span class="WHIT">      </span><span class="NAME">resolveURL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">base</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1196</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1197</span> </span><span class="WHIT">            </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_ANCHOR</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">_ANCHOR</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">GLOBAL.document.createElement</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1198</span> </span><span class="WHIT">        </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1199</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">base</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">_URLREGEXP.test</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1200</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/^\w|\.\./</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">          </span><span class="COMM">// Direct & Sub (..)</span><span class="WHIT">
<span class='linenumber'>1201</span> </span><span class="WHIT">            </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">base</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1202</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/^\.\/|\.\\/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Current (./)</span><span class="WHIT">
<span class='linenumber'>1203</span> </span><span class="WHIT">            </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">base</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">url.substring</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1204</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1205</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1206</span> 
<span class='linenumber'>1207</span> </span><span class="WHIT">        </span><span class="COMM">// Resolve an absolute URL (/ or \\ must be resolved to root host name)</span><span class="WHIT">
<span class='linenumber'>1208</span> </span><span class="WHIT">        </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url.charAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1209</span> </span><span class="WHIT">        </span><span class="NAME">a.href</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'/'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'\\'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">_ROOTURL</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1210</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.href</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1211</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1212</span> 
<span class='linenumber'>1213</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1214</span>        * TODO: prototype needs more implementation
<span class='linenumber'>1215</span>        * @private
<span class='linenumber'>1216</span>        */</span><span class="WHIT">
<span class='linenumber'>1217</span> </span><span class="WHIT">      </span><span class="NAME">stacktrace</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">depth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1218</span> 
<span class='linenumber'>1219</span> </span><span class="WHIT">        </span><span class="COMM">/** @inner Returns arguments type and value as an array */</span><span class="WHIT">
<span class='linenumber'>1220</span> </span><span class="WHIT">        </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">typeOfArgs</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1221</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1222</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">args.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1223</span> </span><span class="WHIT">            </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.typeOf</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1224</span> </span><span class="WHIT">            </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1225</span> </span><span class="WHIT">            </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'null'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1226</span> </span><span class="WHIT">            </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1227</span> </span><span class="WHIT">              </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'{'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'}'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1228</span> </span><span class="WHIT">              </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1229</span> </span><span class="WHIT">            </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'array'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1230</span> </span><span class="WHIT">              </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'{'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'}['</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1231</span> </span><span class="WHIT">              </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1232</span> </span><span class="WHIT">            </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1233</span> </span><span class="WHIT">              </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'{'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'}'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">fnName</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1234</span> </span><span class="WHIT">              </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1235</span> </span><span class="WHIT">            </span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>1236</span> </span><span class="WHIT">              </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'{'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'}'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1237</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1238</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1239</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1240</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1241</span> 
<span class='linenumber'>1242</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stack</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1243</span> </span><span class="WHIT">        </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">fn.caller</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">arguments.callee.caller</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Stacktrace to fn = stacktrace caller</span><span class="WHIT">
<span class='linenumber'>1244</span> </span><span class="WHIT">        </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">depth</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">stack.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">depth</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1245</span> </span><span class="WHIT">          </span><span class="NAME">stack.unshift</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1246</span> </span><span class="WHIT">            </span><span class="NAME">fn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">fn.prototype.constructor</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1247</span> </span><span class="WHIT">            </span><span class="NAME">args</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">fn.arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1248</span> </span><span class="WHIT">            </span><span class="NAME">name</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fn.name</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">fn.fnName</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> 
<span class='linenumber'>1249</span>                     </span><span class="PUNC">(</span><span class="REGX">/function\s*([\w\-$]+)?\s*\(/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">fn.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>1250</span>                         </span><span class="NAME">RegExp.$1</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'&lt;anonymous>'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'&lt;anonymous>'</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1251</span> </span><span class="WHIT">                  </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'('</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">typeOfArgs.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fn.arguments</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">', '</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">')'</span><span class="WHIT">
<span class='linenumber'>1252</span> </span><span class="WHIT">            </span><span class="COMM">/* url, line, or column position cannot be parsed in Safari */</span><span class="WHIT">
<span class='linenumber'>1253</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1254</span> </span><span class="WHIT">          </span><span class="NAME">fn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fn.caller</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1255</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1256</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">stack</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1257</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1258</span> 
<span class='linenumber'>1259</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1260</span>        * 명시된 text가 JSON 포맷인지 확인하여 결과를
<span class='linenumber'>1261</span>        * true/false로 반환한다.
<span class='linenumber'>1262</span>        * @example
<span class='linenumber'>1263</span>        * tau.isJSON('[aaa, bbb]'); // false
<span class='linenumber'>1264</span>        * tau.isJSON('["aaa", "bbb"]'); // true
<span class='linenumber'>1265</span>        * tau.isJSON('[1, 2, 3]'); // true
<span class='linenumber'>1266</span>        * tau.isJSON('{aaa, bbb}'); // false
<span class='linenumber'>1267</span>        * tau.isJSON('{"aaa": "bbb"}'); // true
<span class='linenumber'>1268</span>        *
<span class='linenumber'>1269</span>        * @param {String} text JSON 포맷인지 확인할 문자열
<span class='linenumber'>1270</span>        * @returns {Boolean} 주어진 문자열이 JSON 포맷이면
<span class='linenumber'>1271</span>        * true를 반환한다.
<span class='linenumber'>1272</span>        * @see &lt;a href="http://www.JSON.org/json.js">www.JSON.org/json.js&lt;/a>
<span class='linenumber'>1273</span>        */</span><span class="WHIT">
<span class='linenumber'>1274</span> </span><span class="WHIT">      </span><span class="NAME">isJSON</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1275</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="REGX">/^[\],:{}\s]*$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>1276</span> </span><span class="WHIT">            </span><span class="NAME">text.replace</span><span class="PUNC">(</span><span class="REGX">/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'@'</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1277</span> </span><span class="WHIT">                </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>1278</span> </span><span class="WHIT">                </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/(?:^|:|,)(?:\s*\[)+/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1279</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1280</span> 
<span class='linenumber'>1281</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1282</span>        * JavaScript 값을 JSON형태의 텍스트로 변환하여 반환한다.
<span class='linenumber'>1283</span>        * &lt;p/>
<span class='linenumber'>1284</span>        * 브라우저의 Native코드가 지원이되면
<span class='linenumber'>1285</span>        * &lt;code>JSON.stringify&lt;/code>를 사용하고 그렇지
<span class='linenumber'>1286</span>        * 않으면 Douglas Crockford의 구현체를 사용한다.
<span class='linenumber'>1287</span>        * @example
<span class='linenumber'>1288</span>        * tau.stringify({aaa: 'bbb'}); // '{"aaa":"bbb"}'
<span class='linenumber'>1289</span>        * tau.stringify({aaa: 'bbb'}, null, 2);
<span class='linenumber'>1290</span>        * // '{
<span class='linenumber'>1291</span>        * //    "aaa": "bbb"
<span class='linenumber'>1292</span>        *  // }'
<span class='linenumber'>1293</span>        * 
<span class='linenumber'>1294</span>        * @param {Object|String|Number|Boolean} value
<span class='linenumber'>1295</span>        * 변환하고자 하는 값
<span class='linenumber'>1296</span>        * @param {Function|Array} [replacer] function일 경우
<span class='linenumber'>1297</span>        * custom변환을 가능하게 하고, 배열일 경우 변환하고자
<span class='linenumber'>1298</span>        * 하는 프로퍼티를 배열로 명시한다.
<span class='linenumber'>1299</span>        * @param {String|Number} [space] indentation으로 표현하기
<span class='linenumber'>1300</span>        * 위해 사용한다. 공백 또는 indentation할 숫자
<span class='linenumber'>1301</span>        * @returns {Object} 주어진 값을 문자열로 변환한 값
<span class='linenumber'>1302</span>        * @see &lt;a href="http://www.JSON.org/json.js">www.JSON.org/json.js&lt;/a>
<span class='linenumber'>1303</span>        */</span><span class="WHIT">
<span class='linenumber'>1304</span> </span><span class="WHIT">      </span><span class="NAME">stringify</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">replacer</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">space</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1305</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_MODULE.json.stringify</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">replacer</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">space</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1306</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1307</span> 
<span class='linenumber'>1308</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1309</span>        * JSON포맷의 문자열을 JavaScript 객체로 변환하여
<span class='linenumber'>1310</span>        * 반환한다.
<span class='linenumber'>1311</span>        * &lt;p/>
<span class='linenumber'>1312</span>        * 브라우저에서 기능을 지원하면 브라우저 내장 메소드인
<span class='linenumber'>1313</span>        * &lt;code>JSON.parse&lt;/code>를 활용하며 그렇지 않을 경우 
<span class='linenumber'>1314</span>        * Douglas Crockford's의 구현체를 활용한다.
<span class='linenumber'>1315</span>        * @example
<span class='linenumber'>1316</span>        * tau.parse('{}'); // {}
<span class='linenumber'>1317</span>        * tau.parse('true'); // true
<span class='linenumber'>1318</span>        * tau.parse('"foo"'); // "foo"
<span class='linenumber'>1319</span>        * tau.parse('[1, 5, "false"]'); // [1, 5, "false"]
<span class='linenumber'>1320</span>        * tau.parse('null'); // null
<span class='linenumber'>1321</span>        *
<span class='linenumber'>1322</span>        * var val = JSON.parse('{"p": 5}', 
<span class='linenumber'>1323</span>        *        function(k, v) { if (k === "") return v; return v * 2; });
<span class='linenumber'>1324</span>        * // val is {p: 10}
<span class='linenumber'>1325</span>        *
<span class='linenumber'>1326</span>        * @param {String} text 객체로 변환하기 위한 JSON 형태의 문자열
<span class='linenumber'>1327</span>        * @param {Function} [reviver] Callback function, 최종 값을 생성하기
<span class='linenumber'>1328</span>        * 전에 Customizing할 수 있다.
<span class='linenumber'>1329</span>        * @returns {Object} 변환된 JSON 객체
<span class='linenumber'>1330</span>        * @see &lt;a href="http://www.JSON.org/json.js">www.JSON.org/json.js&lt;/a>
<span class='linenumber'>1331</span>        */</span><span class="WHIT">
<span class='linenumber'>1332</span> </span><span class="WHIT">      </span><span class="NAME">parse</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reviver</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1333</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1334</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_MODULE.json.parse</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reviver</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1335</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1336</span> 
<span class='linenumber'>1337</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1338</span>        * 중복되지 않는 랜덤숫자를 생성하여 반환한다. 주로
<span class='linenumber'>1339</span>        * 컴포넌트 아이디 생성에 활용된다.
<span class='linenumber'>1340</span>        * &lt;p/>
<span class='linenumber'>1341</span>        * 파라미터로 &lt;code>null&lt;/code> 또는 &lt;code>''&lt;/code>를
<span class='linenumber'>1342</span>        * 사요하면 prefix를 사용하지 않는 숫자 또는 문자열 형태의 id를
<span class='linenumber'>1343</span>        * 생성하여 반환한다.
<span class='linenumber'>1344</span>        * @example
<span class='linenumber'>1345</span>        * tau.genId(); // "tau1339376987400"
<span class='linenumber'>1346</span>        * tau.getId(null); // 1339376987401
<span class='linenumber'>1347</span>        * tau.genId(''); // "1339376987402"
<span class='linenumber'>1348</span>        * tau.genId('mobello'); // "mobello1339376987403"
<span class='linenumber'>1349</span>        *
<span class='linenumber'>1350</span>        * @param {String} [pre] 생성될 id앞에 붙이는 prefix (default: 'tau') 
<span class='linenumber'>1351</span>        * @return {String|Number} 유일하게 생성된 id값
<span class='linenumber'>1352</span>        */</span><span class="WHIT">
<span class='linenumber'>1353</span> </span><span class="WHIT">      </span><span class="NAME">genId</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pre</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1354</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">pre</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'tau'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">pre</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">++</span><span class="NAME">_idSeed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1355</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1356</span> 
<span class='linenumber'>1357</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1358</span>        * 주어진 메시지를 로깅한다.
<span class='linenumber'>1359</span>        * &lt;pre>
<span class='linenumber'>1360</span>        *  Log levels (tau.log.*):
<span class='linenumber'>1361</span>        *   DEBUG  : 1
<span class='linenumber'>1362</span>        *   INFO   : 2
<span class='linenumber'>1363</span>        *   WARN   : 3 (default)
<span class='linenumber'>1364</span>        *   ERROR  : 4
<span class='linenumber'>1365</span>        *   FATAL  : 5
<span class='linenumber'>1366</span>        *   NONE   : 6
<span class='linenumber'>1367</span>        * &lt;/pre>
<span class='linenumber'>1368</span>        * @example
<span class='linenumber'>1369</span>        * tau.log('mobello'); // "mobello"
<span class='linenumber'>1370</span>        * tau.log('mobello', 1); // "[614] mobello" (614 is milliseconds)
<span class='linenumber'>1371</span>        * tau.log('mobello', 3, 'debug'); // "[debug] mobello"
<span class='linenumber'>1372</span>        *
<span class='linenumber'>1373</span>        * @param {String} msg 로그로 남길 메시지
<span class='linenumber'>1374</span>        * @param {Number} [level] 로깅레벨: 1(debug) - 6(none)
<span class='linenumber'>1375</span>        * @param {String|Class} [src] 로깅메시지 앞에 붙일 문자열
<span class='linenumber'>1376</span>        * @returns {String} 포맷된 로깅 메시지
<span class='linenumber'>1377</span>        */</span><span class="WHIT">
<span class='linenumber'>1378</span> </span><span class="WHIT">      </span><span class="NAME">log</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">level</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1379</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.log.LEVEL</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">tau.log.WARN</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1380</span> </span><span class="WHIT">          </span><span class="COMM">// Prepends class/context from which the logging is done</span><span class="WHIT">
<span class='linenumber'>1381</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">tau.log.DEBUG</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1382</span> </span><span class="WHIT">            </span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'['</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getMilliseconds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'] '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1383</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1384</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1385</span> </span><span class="WHIT">            </span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'['</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'] '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1386</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isObject</span><span class="PUNC">(</span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">src.$classname</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1387</span> </span><span class="WHIT">            </span><span class="NAME">msg</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'['</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">src.$classname</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'] '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1388</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1389</span> </span><span class="WHIT">          </span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1390</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1391</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1392</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1393</span> 
<span class='linenumber'>1394</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1395</span>        * &lt;code>tau.ArrayHelper&lt;/code>클래스를 쉽게 사용할 수
<span class='linenumber'>1396</span>        * 있도록 하기 위한 Utility 메소드이다.
<span class='linenumber'>1397</span>        * @example
<span class='linenumber'>1398</span>        * var a = ['a', 'b', 'c', 'a'];
<span class='linenumber'>1399</span>        * tau.arr(a).unique().pushUnique('e');
<span class='linenumber'>1400</span>        * alert(a); // a = ['a', 'b', 'c', 'e']);
<span class='linenumber'>1401</span>        *
<span class='linenumber'>1402</span>        * @param {Object|Array} context native 배열 객체
<span class='linenumber'>1403</span>        * @returns {tau.ArrayHelper} 새롭게 생성한 &lt;code>tau.ArrayHelper&lt;/code> 객체
<span class='linenumber'>1404</span>        * @see tau.ArrayHelper
<span class='linenumber'>1405</span>        */</span><span class="WHIT">
<span class='linenumber'>1406</span> </span><span class="WHIT">      </span><span class="NAME">arr</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1407</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.ArrayHelper</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='linenumber'>1408</span>       </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1409</span> 
<span class='linenumber'>1410</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1411</span>        * &lt;code>tau.URLHelper&lt;/code>클래스를 쉽게 사용할 수
<span class='linenumber'>1412</span>        * 있도록 하기 위한 Utility 메소드이다.
<span class='linenumber'>1413</span>        * @example
<span class='linenumber'>1414</span>        * var url = tau.url('http://foo.bar?aaa=bbb');
<span class='linenumber'>1415</span>        * url.isRemote(); // true
<span class='linenumber'>1416</span>        * url.host(); // 'foo.bar'
<span class='linenumber'>1417</span>        * url.protocol(); // 'http:'
<span class='linenumber'>1418</span>        * url.query(); // 'aaa=bbb'
<span class='linenumber'>1419</span>        * url.param('aaa'); // 'bbb'
<span class='linenumber'>1420</span>        *
<span class='linenumber'>1421</span>        * var url = tau.url('http://foo.bar', {ccc: 'ddd', eee: 'fff'});
<span class='linenumber'>1422</span>        * url.param('ccc'); // 'ddd'
<span class='linenumber'>1423</span>        *
<span class='linenumber'>1424</span>        * @param {Object} context URL 문자열
<span class='linenumber'>1425</span>        * @param {Object} [opts] JSON객체 타입의 URL 파리미터
<span class='linenumber'>1426</span>        * @returns {tau.URLHelper} 새롭게 생성한
<span class='linenumber'>1427</span>        * &lt;code>tau.URLHelper&lt;/code>객체
<span class='linenumber'>1428</span>        * @see tau.URLHelper
<span class='linenumber'>1429</span>        */</span><span class="WHIT">
<span class='linenumber'>1430</span> </span><span class="WHIT">      </span><span class="NAME">url</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1431</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.URLHelper</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1432</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1433</span> 
<span class='linenumber'>1434</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1435</span>        * 네트워크 API를 쉽게 사용할 수 있도록 하기 위한
<span class='linenumber'>1436</span>        * Utility 메소드이다.
<span class='linenumber'>1437</span>        * &lt;p/>
<span class='linenumber'>1438</span>        * opts.type의 값이 &lt;code>jsonp&lt;/code>일 경우 
<span class='linenumber'>1439</span>        * &lt;code>tau.data.XSSRequest&lt;/code> 클래스의 인스턴스를 생성해서 반환하며
<span class='linenumber'>1440</span>        * 그렇지 않을 경우 &lt;code>tau.data.XMLRequest&lt;/code>
<span class='linenumber'>1441</span>        * 클래스의 인스턴스를 생성하여 반환한다.
<span class='linenumber'>1442</span>        * @example
<span class='linenumber'>1443</span>        * var req = tau.req({type: 'JSONP', url:
<span class='linenumber'>1444</span>        * 'http://foo.bar', callbackFn: function (resp) {
<span class='linenumber'>1445</span>        *    tau.log(resp.responseJSON);}});
<span class='linenumber'>1446</span>        * req.send();
<span class='linenumber'>1447</span>        *
<span class='linenumber'>1448</span>        * @param {Object} opts 네트워크 Request 생성하기 위한
<span class='linenumber'>1449</span>        * 옵션들. JSON 객체 포맷
<span class='linenumber'>1450</span>        * @param {String} [opts.type='GET'] Request의 형식을 나타내며,
<span class='linenumber'>1451</span>        * GET, POST, JSONP 셋중의 하나를 가진다.
<span class='linenumber'>1452</span>        * @param {String} [opts.encoding='UTF-8'] Character Encoding을
<span class='linenumber'>1453</span>        * 명시한다.
<span class='linenumber'>1454</span>        * @param {Number} [opts.timeout=5000] Request timeout을 나타내며
<span class='linenumber'>1455</span>        * Default값은 5초이다.
<span class='linenumber'>1456</span>        * @param {String} opts.url Request URL 문자열
<span class='linenumber'>1457</span>        * @param {Object} [opts.params] Request 파라미터(JSON
<span class='linenumber'>1458</span>        * 객체 포맷, ex; {key1: 'value1', ke2: 'value2'})
<span class='linenumber'>1459</span>        * @param {String} [opts.jsonpCallback='callback']
<span class='linenumber'>1460</span>        * JSONP통신시 callback파라미터의 키를 지정한다.
<span class='linenumber'>1461</span>        * @param {Boolean} [opts.async=true] 동기 비동기를 지정한다.
<span class='linenumber'>1462</span>        * true일 경우 비동기로 통신을 한다. XSSRequest일 경우
<span class='linenumber'>1463</span>        * 항상 비동기(async)로 통신을 수행한다.
<span class='linenumber'>1464</span>        * @param {Function} [opts.callbackFn] 통신을 수행한
<span class='linenumber'>1465</span>        * 결과를 처리하기 위한 Callback 메소드
<span class='linenumber'>1466</span>        * @returns {tau.data.XSSRequest|tau.data.XMLRequest}  opts.type의 값에 
<span class='linenumber'>1467</span>        * 따라 새롭게 생성된 Request객체
<span class='linenumber'>1468</span>        */</span><span class="WHIT">
<span class='linenumber'>1469</span> </span><span class="WHIT">      </span><span class="NAME">req</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1470</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">opts.type</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">opts.type.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'JSONP'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1471</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.data.XSSRequest</span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1472</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1473</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">tau.data.XMLRequest</span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1474</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1475</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1476</span> </span><span class="WHIT">      
<span class='linenumber'>1477</span>       </span><span class="COMM">/**
<span class='linenumber'>1478</span>        * 명시된 메시지를 경고창을 통해 출력한다. 경고메시지를
<span class='linenumber'>1479</span>        * 출력하고자 할 경우 이 메소드를 통해 편리하게 출력할
<span class='linenumber'>1480</span>        * 수 있다.
<span class='linenumber'>1481</span>        * @param {String} msg 출력할 메시지
<span class='linenumber'>1482</span>        * @param {Object} [opts] 경고창의 속정을 정의하기 위한 객체
<span class='linenumber'>1483</span>        * @param {String} [opts.title] 다이얼로그 제목
<span class='linenumber'>1484</span>        * @param {String} [opts.okText='ok'] 확인버튼 텍스트
<span class='linenumber'>1485</span>        * @param {Function} [opts.callbackFn] ok 버튼을 터치후에 호출되는 콜백함수 
<span class='linenumber'>1486</span>        */</span><span class="WHIT">
<span class='linenumber'>1487</span> </span><span class="WHIT">      </span><span class="NAME">alert</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1488</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getSystemDialog</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1489</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dialog.isActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1490</span> </span><span class="WHIT">          </span><span class="NAME">dialog.open</span><span class="PUNC">(</span><span class="NAME">tau.ui.SystemDialog.ALERT_TYPE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1491</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> 
<span class='linenumber'>1492</span>       </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1493</span> 
<span class='linenumber'>1494</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1495</span>        * 명시된 메시지를 확인창을 통해 출력한다. 사용자로 부터
<span class='linenumber'>1496</span>        * 동의를 얻기 위해 메시지를 출력하고자 할 경우 편리하게 사용할
<span class='linenumber'>1497</span>        * 수 있다.
<span class='linenumber'>1498</span>        * @param {String} msg 출력하고자 하는 메시지
<span class='linenumber'>1499</span>        * @param {Object} [opts] 확인창의 속정을 정의하기 위한 객체
<span class='linenumber'>1500</span>        * @param {String} [opts.title] 다이얼로그 제목
<span class='linenumber'>1501</span>        * @param {String} [opts.okText='ok'] 확인버튼 텍스트
<span class='linenumber'>1502</span>        * @param {String} [opts.cacelText='cancel'] 취소버튼 텍스트
<span class='linenumber'>1503</span>        * @param {Function} [opts.callbackFn] ok, cancel 버튼을 터치후에 호출되는 콜백함수 
<span class='linenumber'>1504</span>        */</span><span class="WHIT">
<span class='linenumber'>1505</span> </span><span class="WHIT">      </span><span class="NAME">confirm</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1506</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getSystemDialog</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1507</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dialog.isActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1508</span> </span><span class="WHIT">          </span><span class="NAME">dialog.open</span><span class="PUNC">(</span><span class="NAME">tau.ui.SystemDialog.TYPE_CONFIRM</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1509</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1510</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1511</span> 
<span class='linenumber'>1512</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1513</span>        * 명시된 메시지를 사용자로 부터 입력을 받기 위한 창을
<span class='linenumber'>1514</span>        * 통해 출력한다. 
<span class='linenumber'>1515</span>        * @param {String} msg 사용자 입력창에 출력할 메시지
<span class='linenumber'>1516</span>        * @param {Object} [opts] 입력창의 속정을 정의하기 위한 객체
<span class='linenumber'>1517</span>        * @param {String} [opts.title] 다이얼로그 제목
<span class='linenumber'>1518</span>        * @param {String} [opts.okText='ok'] 확인버튼 텍스트
<span class='linenumber'>1519</span>        * @param {String} [opts.cacelText='cancel'] 취소버튼 텍스트
<span class='linenumber'>1520</span>        * @param {String} [opts.placeholderLabel] 입력 placeholder 텍스트.
<span class='linenumber'>1521</span>        * @param {Function} [opts.callbackFn] ok, cancel 버튼을 터치후에 호출되는 콜백함수 
<span class='linenumber'>1522</span>        */</span><span class="WHIT">
<span class='linenumber'>1523</span> </span><span class="WHIT">      </span><span class="NAME">prompt</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1524</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getSystemDialog</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1525</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dialog.isActive</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1526</span> </span><span class="WHIT">          </span><span class="NAME">dialog.open</span><span class="PUNC">(</span><span class="NAME">tau.ui.SystemDialog.PROMPT_TYPE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1527</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1528</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1529</span> </span><span class="WHIT">      
<span class='linenumber'>1530</span>       </span><span class="COMM">/**
<span class='linenumber'>1531</span>        *
<span class='linenumber'>1532</span>        * The requestAnimationFrame method is used to signal to the user agent that a script-based animation needs 
<span class='linenumber'>1533</span>        * to be resampled. When requestAnimationFrame(callback) is called, the user agent MUST schedule a script-based 
<span class='linenumber'>1534</span>        * animation resampling by appending to the end of the animation frame request callback list an entry whose handle 
<span class='linenumber'>1535</span>        * is a user-agent-defined integer greater than zero that uniquely identifies the entry in the list, 
<span class='linenumber'>1536</span>        * whose callback is callback and whose cancelled flag is false.
<span class='linenumber'>1537</span>        * @param {Function} callback A parameter specifying a function to call when it's time to update 
<span class='linenumber'>1538</span>        *                             your animation for the next repaint
<span class='linenumber'>1539</span>        * @private
<span class='linenumber'>1540</span>        */</span><span class="WHIT">
<span class='linenumber'>1541</span> </span><span class="WHIT">      </span><span class="NAME">requestAnimationFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1542</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_requestAnimationFrame.call</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1543</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1544</span> 
<span class='linenumber'>1545</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>1546</span>        * The cancelRequestAnimationFrame method is used to cancel a previously made request to schedule an animation 
<span class='linenumber'>1547</span>        * frame update. When cancelRequestAnimationFrame(handle) is called, the user agent MUST set the cancelled flag 
<span class='linenumber'>1548</span>        * to true for the entry in the animation frame request callback list whose handle is handle. 
<span class='linenumber'>1549</span>        * If there is no entry in the list with the given handle, then this function does nothing.
<span class='linenumber'>1550</span>        * @param {String} requestid
<span class='linenumber'>1551</span>        * @private
<span class='linenumber'>1552</span>        */</span><span class="WHIT">
<span class='linenumber'>1553</span> </span><span class="WHIT">      </span><span class="NAME">cancelRequestAnimationFrame</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">requestid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1554</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_cancelRequestAnimationFrame.call</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">requestid</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1555</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1556</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1557</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1558</span> 
<span class='linenumber'>1559</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>1560</span>    * JavaScript에서 객체지향 클래스를 정의할 수 있도록 한다.
<span class='linenumber'>1561</span>    * 이 방법을 사용하면 한번의 정의를 통해 객체지향 방법에서
<span class='linenumber'>1562</span>    * 제공하는 추상화, 상속, 다형성, 캡슐화(정보은닉) 기법을
<span class='linenumber'>1563</span>    * 구현할 수 있다.
<span class='linenumber'>1564</span>    * &lt;p/>
<span class='linenumber'>1565</span>    * 편리한 방법으로 클래스를 정의하기 위해 사용되며
<span class='linenumber'>1566</span>    * method-chain의 방법을 통해 부모클래스를 
<span class='linenumber'>1567</span>    * 상속(&lt;code>extend&lt;/code>)하고, 관련 클래스들을
<span class='linenumber'>1568</span>    * &lt;code>mixin&lt;/code>할 수 있으며, 최종적으로
<span class='linenumber'>1569</span>    * &lt;code>define&lt;/code>을 통해 클래스에서 제공할 메소드들을 정의할 수 있다.
<span class='linenumber'>1570</span>    * @example
<span class='linenumber'>1571</span>    * // class definition
<span class='linenumber'>1572</span>    * $class('com.mycompany.MySuper').define({
<span class='linenumber'>1573</span>    *   $static: {                     // Static variables
<span class='linenumber'>1574</span>    *     MAX_SIZE: 1000
<span class='linenumber'>1575</span>    *   },
<span class='linenumber'>1576</span>    *
<span class='linenumber'>1577</span>    *   MySuper: function (a, b) { // Class constructor
<span class='linenumber'>1578</span>    *     this._a = a;
<span class='linenumber'>1579</span>    *     this._b = b;
<span class='linenumber'>1580</span>    *   },
<span class='linenumber'>1581</span>    *
<span class='linenumber'>1582</span>    *   foo: function () { // Class member
<span class='linenumber'>1583</span>    *     return this._a + this._b;
<span class='linenumber'>1584</span>    *   },
<span class='linenumber'>1585</span>    *
<span class='linenumber'>1586</span>    *   getMax: function () {
<span class='linenumber'>1587</span>    *     return com.mycompany.MySuper.MAX_SIZE;
<span class='linenumber'>1588</span>    *   }
<span class='linenumber'>1589</span>    * });
<span class='linenumber'>1590</span>    *
<span class='linenumber'>1591</span>    * $class('com.mycompany.MyClass').extend(com.mycompany.MySuper).define({
<span class='linenumber'>1592</span>    *   foo: function () { // override
<span class='linenumber'>1593</span>    *     return this._a * this._b;
<span class='linenumber'>1594</span>    *   },
<span class='linenumber'>1595</span>    *
<span class='linenumber'>1596</span>    *   bar: function () {
<span class='linenumber'>1597</span>    *     return this._a - this._b;
<span class='linenumber'>1598</span>    *   }
<span class='linenumber'>1599</span>    * });
<span class='linenumber'>1600</span>    * 
<span class='linenumber'>1601</span>    * @example
<span class='linenumber'>1602</span>    * // usage
<span class='linenumber'>1603</span>    * var my = new com.mycompany.MySuper(3, 2);
<span class='linenumber'>1604</span>    * my.foo(); // 5
<span class='linenumber'>1605</span>    * my.getMax(); // 1000
<span class='linenumber'>1606</span>    * my.getMax() === com.mycompany.MySuper.MAX_SIZE; // true
<span class='linenumber'>1607</span>    *
<span class='linenumber'>1608</span>    * my = new com.mycompany.MyClass(3, 2);
<span class='linenumber'>1609</span>    * my.foo(); // 6
<span class='linenumber'>1610</span>    * my.bar(); // 1
<span class='linenumber'>1611</span>    *
<span class='linenumber'>1612</span>    * @param {String} name 생성하고자 하는 클래스명(문자열)(네임스페이스 포함)
<span class='linenumber'>1613</span>    * @returns {tau.Class} 클래스정의를 위한 시스템 클래스 객체(extend 또는
<span class='linenumber'>1614</span>    * define을 통해 Chaining할 수 있음)
<span class='linenumber'>1615</span>    */</span><span class="WHIT">
<span class='linenumber'>1616</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1617</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'>1618</span>      * Mobello 프레임워크에서 클래스 정의시 생성되는 시스템 클래스.
<span class='linenumber'>1619</span>      * $class('foo.Bar').define({ ... });와 같이
<span class='linenumber'>1620</span>      * 클래스를 정의할 경우 시스템 내부적으로 클래스의 객체를 생성하게
<span class='linenumber'>1621</span>      * 되며 개별 클래스 시스템을 구성하기 위한
<span class='linenumber'>1622</span>      * 기능들을 정의한다. 클래스 정의가 종료됨가 동시에 이
<span class='linenumber'>1623</span>      * 클래스의 객체도 사라진다.
<span class='linenumber'>1624</span>      * &lt;p/>
<span class='linenumber'>1625</span>      * Mobello 클래스 시스템을 통해 객체지향 언어에서 얻을 수
<span class='linenumber'>1626</span>      * 있는 추상화, 상속, 다형성, 캡슐화(정보은닉)를활 용할 수
<span class='linenumber'>1627</span>      * 있으며 이를 위해 다음과 같은 메소드들을 지원한다.
<span class='linenumber'>1628</span>      * &lt;ul>
<span class='linenumber'>1629</span>      *   &lt;li>extend: 상속관계를 정의한다.&lt;/li> 
<span class='linenumber'>1630</span>      *   &lt;li>mixin: 자주사용하는 기능들을 별도의 클래스로
<span class='linenumber'>1631</span>      *   모듈과 하고 이들 기능들을 클래스 정의시 재사용한다. &lt;/li>
<span class='linenumber'>1632</span>      *   &lt;li>define: 정의된 클래스의 멤버함수들을 정의한다.&lt;/li>
<span class='linenumber'>1633</span>      * &lt;/ul>
<span class='linenumber'>1634</span>      * 주의: 사용자가 직접 클래스의 인스턴스를 생성할 수
<span class='linenumber'>1635</span>      * 없으며 시스템 내부적으로 인스턴스가 생성된다.
<span class='linenumber'>1636</span>      *
<span class='linenumber'>1637</span>      * @example
<span class='linenumber'>1638</span>      * $class('foo.Bar').extend(foo.Baz).define({
<span class='linenumber'>1639</span>      *   Bar: function () { // Constructor
<span class='linenumber'>1640</span>      *     // ...
<span class='linenumber'>1641</span>      *   },
<span class='linenumber'>1642</span>      *
<span class='linenumber'>1643</span>      *   say: function () { // Member function
<span class='linenumber'>1644</span>      *     // ...
<span class='linenumber'>1645</span>      *   }
<span class='linenumber'>1646</span>      * });
<span class='linenumber'>1647</span>      * @class
<span class='linenumber'>1648</span>      * Mobello의 클래스 시스템으로 외부에서는 접근이 제한된다.
<span class='linenumber'>1649</span>      * @name tau.Class
<span class='linenumber'>1650</span>      * @class
<span class='linenumber'>1651</span>      * @see $class
<span class='linenumber'>1652</span>      */</span><span class="WHIT">
<span class='linenumber'>1653</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'name'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1654</span> 
<span class='linenumber'>1655</span> </span><span class="WHIT">    </span><span class="COMM">/** assigns the file path on which this class is defined */</span><span class="WHIT"> 
<span class='linenumber'>1656</span>     </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">$require</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1657</span> </span><span class="WHIT">      </span><span class="NAME">lang.path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$require.path</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1658</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1659</span> </span><span class="WHIT">    
<span class='linenumber'>1660</span>     </span><span class="COMM">/**
<span class='linenumber'>1661</span>      * 기존에 정의의된 클래스를 상속(확장)한다. 기존의
<span class='linenumber'>1662</span>      * 클래스를 상속할 경우 부모클래스에 있는 모든 기능들을
<span class='linenumber'>1663</span>      * 활용할 수 있으며 추가적으로 확장된 기능들을 정의할 수
<span class='linenumber'>1664</span>      * 있다. 또한 부모클래스에 정의된 기능을 오버라이드하여
<span class='linenumber'>1665</span>      * 기능을 확장할 수도 있다.
<span class='linenumber'>1666</span>      * @example
<span class='linenumber'>1667</span>      * $class('com.mycompany.MySuper').define({
<span class='linenumber'>1668</span>      *   $static: {                     // Static variables
<span class='linenumber'>1669</span>      *     MAX_SIZE: 1000
<span class='linenumber'>1670</span>      *   },
<span class='linenumber'>1671</span>      *
<span class='linenumber'>1672</span>      *   MySuper: function (a, b) { // Class constructor
<span class='linenumber'>1673</span>      *     this._a = a;
<span class='linenumber'>1674</span>      *     this._b = b;
<span class='linenumber'>1675</span>      *   },
<span class='linenumber'>1676</span>      *
<span class='linenumber'>1677</span>      *   foo: function () { // Class member
<span class='linenumber'>1678</span>      *     return this._a + this._b;
<span class='linenumber'>1679</span>      *   },
<span class='linenumber'>1680</span>      *
<span class='linenumber'>1681</span>      *   getMax: function () {
<span class='linenumber'>1682</span>      *     return com.mycompany.MySuper.MAX_SIZE;
<span class='linenumber'>1683</span>      *   }
<span class='linenumber'>1684</span>      * });
<span class='linenumber'>1685</span>      *
<span class='linenumber'>1686</span>      * $class('com.mycompany.MyClass').extend(com.mycompany.MySuper).define({
<span class='linenumber'>1687</span>      *   foo: function () { // override
<span class='linenumber'>1688</span>      *     return this._a * this._b;
<span class='linenumber'>1689</span>      *   },
<span class='linenumber'>1690</span>      *
<span class='linenumber'>1691</span>      *   bar: function () { // add new function
<span class='linenumber'>1692</span>      *     return this._a - this._b;
<span class='linenumber'>1693</span>      *   }
<span class='linenumber'>1694</span>      * });
<span class='linenumber'>1695</span>      *
<span class='linenumber'>1696</span>      * @name extend
<span class='linenumber'>1697</span>      * @function
<span class='linenumber'>1698</span>      * @memberOf tau.Class.prototype
<span class='linenumber'>1699</span>      * @param {Function} superclass 상속할 부모클래스를 지정한다.
<span class='linenumber'>1700</span>      * @returns {tau.Class} 클래스를 생성하기 위한 시스템 클래스 객체
<span class='linenumber'>1701</span>      * @throws {Error} superclass가 클래스가 아닐 경우
<span class='linenumber'>1702</span>      */</span><span class="WHIT">
<span class='linenumber'>1703</span> </span><span class="WHIT">    </span><span class="NAME">lang.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">superclass</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1704</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">superclass</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1705</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'$class.extend: cannot extend undefined class, \"'</span><span class="WHIT"> 
<span class='linenumber'>1706</span>             </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">superclass</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\"'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1707</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1708</span> </span><span class="WHIT">      </span><span class="NAME">this.$super</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">superclass</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1709</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.extend</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1710</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1711</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1712</span> 
<span class='linenumber'>1713</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1714</span>      * 명시된 클래스의 멤버들을 현재 클래스의 기능으로
<span class='linenumber'>1715</span>      * 가져온다. 만약 기존에 동일한 멤버들이 존재한다면
<span class='linenumber'>1716</span>      * 덮어쓰지 않는다.
<span class='linenumber'>1717</span>      * @example
<span class='linenumber'>1718</span>      * $class('com.mycompany.MySuper').mixin(com.mycompany.Util).define({
<span class='linenumber'>1719</span>      *   ...
<span class='linenumber'>1720</span>      * });
<span class='linenumber'>1721</span>      *
<span class='linenumber'>1722</span>      * @example
<span class='linenumber'>1723</span>      * $class('com.mycompany.MySuper').mixin( // more than one class
<span class='linenumber'>1724</span>      *     com.mycompany.Util, com.mycompany.Common).define({ //
<span class='linenumber'>1725</span>      *   ...
<span class='linenumber'>1726</span>      * });
<span class='linenumber'>1727</span>      *
<span class='linenumber'>1728</span>      * @name mixin
<span class='linenumber'>1729</span>      * @function
<span class='linenumber'>1730</span>      * @memberOf tau.Class.prototype
<span class='linenumber'>1731</span>      * @param {Object} args mixin할 클래스, 다수개의 클래스를 명시할 수 있다.
<span class='linenumber'>1732</span>      * @returns {tau.Class} 클래스를 생성하기 위한 시스템 클래스 객체
<span class='linenumber'>1733</span>      */</span><span class="WHIT">
<span class='linenumber'>1734</span> </span><span class="WHIT">    </span><span class="NAME">lang.mixin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1735</span> </span><span class="WHIT">      </span><span class="NAME">this.mixins</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1736</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.mixin</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1737</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1738</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1739</span> 
<span class='linenumber'>1740</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1741</span>      * 현재 클래스가 특정 클래스를 상속받았다면 상속한 부모클래스를 가리킨다.
<span class='linenumber'>1742</span>      * @example
<span class='linenumber'>1743</span>      * $class('com.mycompany.MySuper').define({
<span class='linenumber'>1744</span>      *   foo: function () { // override
<span class='linenumber'>1745</span>      *     return 'MySuper';
<span class='linenumber'>1746</span>      *   }
<span class='linenumber'>1747</span>      * });
<span class='linenumber'>1748</span>      *
<span class='linenumber'>1749</span>      * $class('com.mycompany.MyClass').extend(com.mycompany.MySuper).define({
<span class='linenumber'>1750</span>      *   foo: function () { // override
<span class='linenumber'>1751</span>      *     var msg = com.mycompany.MyClass.$super.foo.apply(this, arguments);
<span class='linenumber'>1752</span>      *     return msg + ' and MyClass';
<span class='linenumber'>1753</span>      *   }
<span class='linenumber'>1754</span>      * });
<span class='linenumber'>1755</span>      * 
<span class='linenumber'>1756</span>      * @example
<span class='linenumber'>1757</span>      * var my = new com.mycompany.MyClass();
<span class='linenumber'>1758</span>      * my.foo(); // prints 'MySuper and MyClass'
<span class='linenumber'>1759</span>      *
<span class='linenumber'>1760</span>      * @name $super
<span class='linenumber'>1761</span>      * @field
<span class='linenumber'>1762</span>      * @type tau.TObject
<span class='linenumber'>1763</span>      * @memberOf tau.Class
<span class='linenumber'>1764</span>      */</span><span class="WHIT">
<span class='linenumber'>1765</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1766</span>      * 현재 인스턴스의 클래스명을 가리킨다.
<span class='linenumber'>1767</span>      * @example
<span class='linenumber'>1768</span>      * $class('foo.Bar').define({
<span class='linenumber'>1769</span>      *   ...
<span class='linenumber'>1770</span>      * });
<span class='linenumber'>1771</span>      * 
<span class='linenumber'>1772</span>      * @example
<span class='linenumber'>1773</span>      * var bar = new foo.Bar();
<span class='linenumber'>1774</span>      * bar.$classname // 'foo.Bar'
<span class='linenumber'>1775</span>      *
<span class='linenumber'>1776</span>      * @name $classname
<span class='linenumber'>1777</span>      * @field
<span class='linenumber'>1778</span>      * @type String
<span class='linenumber'>1779</span>      * @memberOf tau.TObject.prototype
<span class='linenumber'>1780</span>      */</span><span class="WHIT">
<span class='linenumber'>1781</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1782</span>      * 명시된 클래스가 현재 객체에 mixin되었는지 여부를
<span class='linenumber'>1783</span>      * 확인하고 결과를 true/false로 반환한다.
<span class='linenumber'>1784</span>      * @example
<span class='linenumber'>1785</span>      * $class('foo.Bar').mixin(foo.Baz).define({
<span class='linenumber'>1786</span>      *   ...
<span class='linenumber'>1787</span>      * });
<span class='linenumber'>1788</span>      *
<span class='linenumber'>1789</span>      * @example
<span class='linenumber'>1790</span>      * var bar = new foo.Bar();
<span class='linenumber'>1791</span>      * bar.isMixinOf(foo.Baz); // true
<span class='linenumber'>1792</span>      *
<span class='linenumber'>1793</span>      * @name isMixinOf
<span class='linenumber'>1794</span>      * @function
<span class='linenumber'>1795</span>      * @memberOf tau.TObject.prototype
<span class='linenumber'>1796</span>      * @param {Object} target 현재 객체에 mixin이 적용되었는지
<span class='linenumber'>1797</span>      * 확인하고자 하는 클래스
<span class='linenumber'>1798</span>      * @returns {Boolean} 현재 객체에 명시된 클래스가
<span class='linenumber'>1799</span>      * mixin되었다면 true를 그렇지 않으면 false를
<span class='linenumber'>1800</span>      * 반환한다.
<span class='linenumber'>1801</span>      */</span><span class="WHIT">
<span class='linenumber'>1802</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1803</span>      * 현재 클래스가 정의된 물리적 파일 이름을 가리킨다.
<span class='linenumber'>1804</span>      * @example
<span class='linenumber'>1805</span>      * // this class is defined in 'file://.../src/main.js'
<span class='linenumber'>1806</span>      * $class('foo.Bar').define({
<span class='linenumber'>1807</span>      *   ...
<span class='linenumber'>1808</span>      * });
<span class='linenumber'>1809</span>      *
<span class='linenumber'>1810</span>      * @example 
<span class='linenumber'>1811</span>      * foo.Bar.$filepath // 'file://.../src/main.js'
<span class='linenumber'>1812</span>      *
<span class='linenumber'>1813</span>      * @name $filepath
<span class='linenumber'>1814</span>      * @field
<span class='linenumber'>1815</span>      * @type String
<span class='linenumber'>1816</span>      * @memberOf tau.Class
<span class='linenumber'>1817</span>      */</span><span class="WHIT">
<span class='linenumber'>1818</span> 
<span class='linenumber'>1819</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>1820</span>      * 클래스의 멤버들을 정의한다.
<span class='linenumber'>1821</span>      * &lt;p/>
<span class='linenumber'>1822</span>      * 클래스의 생성자를 정의할 수 있으며 생성자는 클래스의
<span class='linenumber'>1823</span>      * 이름과 동일한 이름의 메소드로 정의한다.
<span class='linenumber'>1824</span>      * @example
<span class='linenumber'>1825</span>      * $class('com.mycompany.MySuper').define({
<span class='linenumber'>1826</span>      *   MySuper: function () { // constructor
<span class='linenumber'>1827</span>      *
<span class='linenumber'>1828</span>      *   },
<span class='linenumber'>1829</span>      *
<span class='linenumber'>1830</span>      *   foo: function (a, b) { // member function
<span class='linenumber'>1831</span>      *
<span class='linenumber'>1832</span>      *   }
<span class='linenumber'>1833</span>      * });
<span class='linenumber'>1834</span>      * &lt;p/>
<span class='linenumber'>1835</span>      *
<span class='linenumber'>1836</span>      * @name define
<span class='linenumber'>1837</span>      * @function
<span class='linenumber'>1838</span>      * @memberOf tau.Class.prototype
<span class='linenumber'>1839</span>      * @param {Object} m 클래스 정의를 위한 멤버들
<span class='linenumber'>1840</span>      * @throws {Error} 기존에 동일한 클래스가 이미 정의되어 있을 경우
<span class='linenumber'>1841</span>      */</span><span class="WHIT">
<span class='linenumber'>1842</span> </span><span class="WHIT">    </span><span class="NAME">lang.define</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1843</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cls</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">mm</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1844</span> </span><span class="WHIT">          </span><span class="NAME">sup</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.$super</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">tau.TObject</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1845</span> </span><span class="WHIT">          </span><span class="NAME">localName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.name.substring</span><span class="PUNC">(</span><span class="NAME">this.name.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1846</span> </span><span class="WHIT">          </span><span class="NAME">construct</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isObject</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">m.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">localName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'>1847</span>               </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">[</span><span class="NAME">localName</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1848</span> </span><span class="WHIT">      </span><span class="NAME">cls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1849</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.$dist</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.$dist</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1850</span> </span><span class="WHIT">          </span><span class="NAME">this.$dist</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1851</span> </span><span class="WHIT">          </span><span class="NAME">sup.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">       </span><span class="COMM">// Super constructor call</span><span class="WHIT">
<span class='linenumber'>1852</span> </span><span class="WHIT">          </span><span class="NAME">this.$dist</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1853</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">construct</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1854</span> </span><span class="WHIT">            </span><span class="NAME">construct.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Instance constructor call</span><span class="WHIT">
<span class='linenumber'>1855</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1856</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.$dist</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// it's time to optionize</span><span class="WHIT">
<span class='linenumber'>1857</span> </span><span class="WHIT">            </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">arg0</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1858</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">arg0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">arg0.constructor</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="WHIT"> 
<span class='linenumber'>1859</span>                 </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">arg0.$optionize</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1860</span> </span><span class="WHIT">              </span><span class="COMM">// not applicable if '$optionize:false' is specified in the object</span><span class="WHIT">
<span class='linenumber'>1861</span> </span><span class="WHIT">              </span><span class="NAME">tau.optionize</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arg0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.$optionize</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1862</span> </span><span class="WHIT">              </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.$optionize</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1863</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1864</span> </span><span class="WHIT">            </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.$dist</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1865</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1866</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1867</span> 
<span class='linenumber'>1868</span> </span><span class="WHIT">     </span><span class="COMM">/** @inner Create inheritance from a super class */</span><span class="WHIT">
<span class='linenumber'>1869</span> </span><span class="WHIT">      </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1870</span> </span><span class="WHIT">      </span><span class="NAME">parent.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sup.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1871</span> </span><span class="WHIT">      </span><span class="NAME">cls.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1872</span> </span><span class="WHIT">      </span><span class="NAME">cls.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cls</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1873</span> 
<span class='linenumber'>1874</span> </span><span class="WHIT">      </span><span class="NAME">cls.$super</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sup.prototype</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Super class reference (static)</span><span class="WHIT">
<span class='linenumber'>1875</span> </span><span class="WHIT">      </span><span class="NAME">cls.$filepath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.path</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// File path property (static)</span><span class="WHIT">
<span class='linenumber'>1876</span> 
<span class='linenumber'>1877</span> </span><span class="WHIT">      </span><span class="COMM">// If the super class constructor is JavaScript's native Object, it must</span><span class="WHIT">
<span class='linenumber'>1878</span> </span><span class="WHIT">      </span><span class="COMM">// be reassigned to its own function definition; otherwise, the sub</span><span class="WHIT">
<span class='linenumber'>1879</span> </span><span class="WHIT">      </span><span class="COMM">// class super constructor call will not pass its arguments properly.</span><span class="WHIT">
<span class='linenumber'>1880</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sup</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="WHIT">
<span class='linenumber'>1881</span> </span><span class="WHIT">          </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">sup.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">Object.prototype.constructor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1882</span> </span><span class="WHIT">        </span><span class="NAME">sup.prototype.constructor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sup</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1883</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1884</span> 
<span class='linenumber'>1885</span> </span><span class="WHIT">      </span><span class="COMM">// Define static properties/methods</span><span class="WHIT">
<span class='linenumber'>1886</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">m.$static</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1887</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">m.$static.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1888</span> </span><span class="WHIT">          </span><span class="NAME">cls</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">m.$static</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1889</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1890</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1891</span> 
<span class='linenumber'>1892</span> </span><span class="WHIT">      </span><span class="COMM">// Define prototype properties/methods</span><span class="WHIT">
<span class='linenumber'>1893</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1894</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">m.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'$static'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1895</span> </span><span class="WHIT">          </span><span class="NAME">cls.prototype</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1896</span> </span><span class="WHIT">          </span><span class="COMM">// Attach class function names for stacktrace (&lt;classname>.&lt;fn name>)</span><span class="WHIT">
<span class='linenumber'>1897</span> </span><span class="COMM">//          if (tau.isFunction(cls.prototype[p]) </span><span class="WHIT">
<span class='linenumber'>1898</span> </span><span class="COMM">//              && !tau.isValue(cls.prototype[p].name)) {</span><span class="WHIT">
<span class='linenumber'>1899</span> </span><span class="COMM">//            cls.prototype[p].fnName = this.name + '.' + p;</span><span class="WHIT">
<span class='linenumber'>1900</span> </span><span class="COMM">//          }</span><span class="WHIT">
<span class='linenumber'>1901</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1902</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1903</span> </span><span class="WHIT">      </span><span class="NAME">cls.prototype.$classname</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Class name property (instance)</span><span class="WHIT">
<span class='linenumber'>1904</span> 
<span class='linenumber'>1905</span> </span><span class="WHIT">      </span><span class="COMM">// Define full namespace for the class, throw exception on duplicate</span><span class="WHIT">
<span class='linenumber'>1906</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.namespace</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cls</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1907</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'$class.define: \"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="STRN">'\" already defined'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1908</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1909</span> 
<span class='linenumber'>1910</span> </span><span class="WHIT">      </span><span class="COMM">// Apply mixin properties </span><span class="WHIT">
<span class='linenumber'>1911</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.mixins</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.mixins.length</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1912</span> </span><span class="WHIT">        </span><span class="COMM">//tau.mixin(cls.prototype, this.mixins[p]);</span><span class="WHIT">
<span class='linenumber'>1913</span> </span><span class="WHIT">        </span><span class="COMM">//tweaked for efficiency by genie</span><span class="WHIT">
<span class='linenumber'>1914</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1915</span> </span><span class="WHIT">          </span><span class="NAME">cls.mixins</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1916</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1917</span> </span><span class="WHIT">        </span><span class="NAME">mm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.mixins</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">prototype</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1918</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mm</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1919</span> </span><span class="WHIT">          </span><span class="NAME">cls.mixins.push</span><span class="PUNC">(</span><span class="NAME">mm.$classname</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1920</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1921</span> </span><span class="WHIT">          </span><span class="NAME">mm</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.mixins</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1922</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1923</span> </span><span class="WHIT">        </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">cls.prototype</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">mm</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1924</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1925</span> </span><span class="WHIT">      
<span class='linenumber'>1926</span>       </span><span class="NAME">cls.prototype.isMixinOf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mixin</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1927</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">cls.mixins</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">cls.mixins.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1928</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cls.mixins</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT">  </span><span class="NAME">mixin.prototype.$classname</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1929</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1930</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1931</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1932</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cls.$super.isMixinOf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">cls.$super.isMixinOf</span><span class="PUNC">(</span><span class="NAME">mixin</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1933</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1934</span> 
<span class='linenumber'>1935</span> </span><span class="WHIT">      </span><span class="COMM">// Remove static properties used for class definition</span><span class="WHIT">
<span class='linenumber'>1936</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1937</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.mixins</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1938</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.$super</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1939</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.define</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1940</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1941</span> 
<span class='linenumber'>1942</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">lang</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1943</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1944</span> 
<span class='linenumber'>1945</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>1946</span>    * tau.Class에 대한 접근자로 사용하며 tau.Class의
<span class='linenumber'>1947</span>    * static메소드들을 이용할 수 있다. 일반적으로
<span class='linenumber'>1948</span>    * tau.Class 객체는 내부적으로 생성되고 사용자에게 노출되지
<span class='linenumber'>1949</span>    * 않지만 static 메소드들은 접근이 가능하다.
<span class='linenumber'>1950</span>    * &lt;p/>
<span class='linenumber'>1951</span>    * 예를들어 문자열을 가지고 클래스객체를 생성하기 위한 메소드인
<span class='linenumber'>1952</span>    * forName()을 다음과 같이 사용할 수 있다.
<span class='linenumber'>1953</span>    * @example
<span class='linenumber'>1954</span>    * var clazz = $class.forName('tau.example.MyClass');
<span class='linenumber'>1955</span>    * var instance = new class();
<span class='linenumber'>1956</span>    *
<span class='linenumber'>1957</span>    * @see tau.Class
<span class='linenumber'>1958</span>    * @name $class
<span class='linenumber'>1959</span>    * @field
<span class='linenumber'>1960</span>    * @memberOf $global
<span class='linenumber'>1961</span>    */</span><span class="WHIT">
<span class='linenumber'>1962</span> 
<span class='linenumber'>1963</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>1964</span>    * 명시된 클래스 이름(네임스페이스 포함)에 해당하는
<span class='linenumber'>1965</span>    * &lt;code>Function/Class&lt;/code>를 찾아 반환한다.&lt;p/>
<span class='linenumber'>1966</span>    * 주의: forName() 메소드는 tau.Class 의 static 메소드이지만
<span class='linenumber'>1967</span>    * 시스템 내부 클래스이므로 외부에서는 접근이 불가능하다.
<span class='linenumber'>1968</span>    * 따라서 $class.forName()형태로 사용해야 한다.
<span class='linenumber'>1969</span>    * @example
<span class='linenumber'>1970</span>    * var clazz = $class.forName('tau.example.MyClass');
<span class='linenumber'>1971</span>    * var instance = new clazz();
<span class='linenumber'>1972</span>    *
<span class='linenumber'>1973</span>    * @param {String} ns 네임스페이스에 준수하여 생성된 Function 또는 클래스
<span class='linenumber'>1974</span>    * @returns {Function|Class} 명시된 클래스 네임스페이스에 해당하는
<span class='linenumber'>1975</span>    * &lt;code>Function/Class&lt;/code>
<span class='linenumber'>1976</span>    * @throws {Error} 명시된 네임스페이스의 Class 또는 Function이
<span class='linenumber'>1977</span>    * 정의되어 있지 않을 경우
<span class='linenumber'>1978</span>    * @name forName
<span class='linenumber'>1979</span>    * @function
<span class='linenumber'>1980</span>    * @memberOf tau.Class
<span class='linenumber'>1981</span>    * @see $global.$class
<span class='linenumber'>1982</span>    */</span><span class="WHIT">
<span class='linenumber'>1983</span> </span><span class="WHIT">  </span><span class="NAME">$class.forName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ns</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1984</span> </span><span class="WHIT">    </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">,</span><span class="WHIT">  
<span class='linenumber'>1985</span>         </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ns.split</span><span class="PUNC">(</span><span class="STRN">'.'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>1986</span> </span><span class="WHIT">        </span><span class="NAME">ref</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">GLOBAL</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1987</span> </span><span class="WHIT">    </span><span class="COMM">// Validate each namespace parts (create one if it doesn't exist)</span><span class="WHIT">
<span class='linenumber'>1988</span> </span><span class="WHIT">    </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parts.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1989</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">ref</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>1990</span> </span><span class="WHIT">        </span><span class="COMM">// Any ref part in the namespace must not be a function</span><span class="WHIT">
<span class='linenumber'>1991</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'$class.forName: \"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ns</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\" is undefined'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1992</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1993</span> </span><span class="WHIT">      </span><span class="NAME">ref</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ref</span><span class="PUNC">[</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1994</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>1995</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ref</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1996</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>1997</span> 
<span class='linenumber'>1998</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.ScriptHelper.prototype */</span><span class="WHIT">
<span class='linenumber'>1999</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.ScriptHelper'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2000</span> 
<span class='linenumber'>2001</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2002</span>      * 명시된 옵션들을 이용하여 외부의 자바스크립트 또는 CSS파일을 동적으로 로딩한다.
<span class='linenumber'>2003</span>      * @example
<span class='linenumber'>2004</span>      * &lt;script type="text/javascript" src="...">&lt;/script>
<span class='linenumber'>2005</span>      * &lt;link type="text/css" rel='stylesheet' media="screen" href="...">&lt;/link>
<span class='linenumber'>2006</span>      *
<span class='linenumber'>2007</span>      * @class
<span class='linenumber'>2008</span>      * 동적인 방법으로 자바스크립트(opts.type = 'script') 또는
<span class='linenumber'>2009</span>      * CSS 링크(opts.type = 'css')를 로딩한다. 동적으로
<span class='linenumber'>2010</span>      * 자바스크립트를 로딩하기 위해 document의 head 앨리먼트 내에
<span class='linenumber'>2011</span>      * script 또는 lilnk 앨리먼트를 생성하는 형태로 해당 스크립트를 로딩한다.
<span class='linenumber'>2012</span>      * 
<span class='linenumber'>2013</span>      * @constructs
<span class='linenumber'>2014</span>      * @param {Object} opts ScriptHelper 객체 생성시 사용할 수
<span class='linenumber'>2015</span>      * 있는 옵션들
<span class='linenumber'>2016</span>      * @param {String} [otps.type = 'script'] 'css' 또는 'script'
<span class='linenumber'>2017</span>      * @param {String} [otps.url] 스크립트에 대한 URL 주소,
<span class='linenumber'>2018</span>      * 만약 생략하면 load() 메소드를 통해 기술할 수 있다.
<span class='linenumber'>2019</span>      * @param {Function} [otps.callbackFn] 성공적으로
<span class='linenumber'>2020</span>      * 로딩되었을 때 호출되는 Callback 메소드
<span class='linenumber'>2021</span>      * @param {Function} [otps.timeoutFn] 타임아웃이 되었을 때
<span class='linenumber'>2022</span>      * 호출되는 Callback 메소드
<span class='linenumber'>2023</span>      * @param {Number} [otps.timeout] 스크립트가 로딩
<span class='linenumber'>2024</span>      * 완료될때 까지의 시간. millisecond로 표현한다.
<span class='linenumber'>2025</span>      * @param {Object} [otps.context] callback 함수 내에서
<span class='linenumber'>2026</span>      * 사용될 'this' 객체
<span class='linenumber'>2027</span>      * @param {Boolean} [otps.noCache = false] 기존에 동일한 스크립트 파일이
<span class='linenumber'>2028</span>      * 로딩되어 있더라도 새롭게 로딩한다.
<span class='linenumber'>2029</span>      * @param {Boolean} [otps.autoUnload = false] 로딩이
<span class='linenumber'>2030</span>      * 완료되면 로딩된 스크립트를 자동으로 unloading한다.
<span class='linenumber'>2031</span>      * @param {String} [otps.charset] Characterset 인코딩을
<span class='linenumber'>2032</span>      * 지정한다. 생략하면 setCharset()메소드를 통해 지정할 수
<span class='linenumber'>2033</span>      * 있다.
<span class='linenumber'>2034</span>      * @see tau.req
<span class='linenumber'>2035</span>      */</span><span class="WHIT">
<span class='linenumber'>2036</span> </span><span class="WHIT">    </span><span class="NAME">ScriptHelper</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2037</span> </span><span class="WHIT">      </span><span class="NAME">this._opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2038</span> </span><span class="WHIT">      </span><span class="NAME">this._opts.head</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.isElement</span><span class="PUNC">(</span><span class="NAME">this._opts.head</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>2039</span>           </span><span class="NAME">this._opts.head</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">GLOBAL.document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">'head'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2040</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._opts.type</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'css'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2041</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">GLOBAL.document.createElement</span><span class="PUNC">(</span><span class="STRN">'script'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2042</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.setAttribute</span><span class="PUNC">(</span><span class="STRN">'type'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/javascript'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2043</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2044</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">GLOBAL.document.createElement</span><span class="PUNC">(</span><span class="STRN">'link'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2045</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.setAttribute</span><span class="PUNC">(</span><span class="STRN">'type'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/css'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2046</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.setAttribute</span><span class="PUNC">(</span><span class="STRN">'rel'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'stylesheet'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2047</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.setAttribute</span><span class="PUNC">(</span><span class="STRN">'media'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'screen'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2048</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2049</span> </span><span class="WHIT">      </span><span class="NAME">this.setCharset</span><span class="PUNC">(</span><span class="NAME">this._opts.charset</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2050</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2051</span> 
<span class='linenumber'>2052</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2053</span>      * 로딩될 스크립트의 character set을 지정한다. 일반적으로
<span class='linenumber'>2054</span>      * 'utf-8'을 지정하면 무난하다.
<span class='linenumber'>2055</span>      * @param {String} charset 지정하고자 하는 Chracter set
<span class='linenumber'>2056</span>      */</span><span class="WHIT">
<span class='linenumber'>2057</span> </span><span class="WHIT">    </span><span class="NAME">setCharset</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">charset</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2058</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">charset</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2059</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.setAttribute</span><span class="PUNC">(</span><span class="STRN">'charset'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">charset</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2060</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2061</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2062</span> </span><span class="WHIT">    
<span class='linenumber'>2063</span>     </span><span class="COMM">/**
<span class='linenumber'>2064</span>      * head 앨리먼트 하부에 script앨리먼트를 동적으로
<span class='linenumber'>2065</span>      * 삽입함으로써 해당 스크립트를 동적으로 로딩한다.
<span class='linenumber'>2066</span>      * 해당 스크립트가 성공적으로 로딩되었을 때 &lt;code>callbackFn&lt;/code>
<span class='linenumber'>2067</span>      * 메소드가 호출된다.
<span class='linenumber'>2068</span>      * &lt;p/>
<span class='linenumber'>2069</span>      * Async방법으로 로딩되므로 로딩할 스크립트에 정의된
<span class='linenumber'>2070</span>      * 메소드들은 반드시 로딩할 스크립트가 완전히 로딩된
<span class='linenumber'>2071</span>      * 후에 호출되어야 한다.
<span class='linenumber'>2072</span>      * @param {String} url 로딩할 JavaScript 소스 URL
<span class='linenumber'>2073</span>      * @param {Function} [callbackFn] 로딩이 완료된 후에 호출될 callback 메소드
<span class='linenumber'>2074</span>      * @param {Function} [timeoutFn] Timeout이 발생되었을 경우 호출될 callback 메소드
<span class='linenumber'>2075</span>      * @returns {Element} 새롭게 추가된 DOM 앨리먼트
<span class='linenumber'>2076</span>      */</span><span class="WHIT">
<span class='linenumber'>2077</span> </span><span class="WHIT">    </span><span class="NAME">load</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">timeoutFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2078</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">timeoutId</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2079</span> </span><span class="WHIT">          </span><span class="NAME">opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._opts</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2080</span> </span><span class="WHIT">          </span><span class="NAME">that</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2081</span> </span><span class="WHIT">      </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">opts.url</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2082</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts.type</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'css'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2083</span> </span><span class="WHIT">        </span><span class="NAME">callbackFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">opts.callbackFn</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2084</span> </span><span class="WHIT">        </span><span class="NAME">timeoutFn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">timeoutFn</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">opts.timeoutFn</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2085</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts.timeout</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">timeoutFn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2086</span> </span><span class="WHIT">          </span><span class="COMM">/** @inner Script load timeout */</span><span class="WHIT">
<span class='linenumber'>2087</span> </span><span class="WHIT">          </span><span class="NAME">timeoutId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2088</span> </span><span class="WHIT">            </span><span class="NAME">that.ctx.onload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// prevent success callback</span><span class="WHIT">
<span class='linenumber'>2089</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">that._opts.autoUnload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">that.unload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// unload script element</span><span class="WHIT">
<span class='linenumber'>2090</span> </span><span class="WHIT">            </span><span class="NAME">timeoutFn.call</span><span class="PUNC">(</span><span class="NAME">that._opts.context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2091</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts.timeout</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2092</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.ctx.onerror</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2093</span> </span><span class="WHIT">          </span><span class="NAME">this.ctx.onerror</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2094</span> </span><span class="WHIT">            </span><span class="NAME">that.unload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// unload script element</span><span class="WHIT">
<span class='linenumber'>2095</span> </span><span class="WHIT">            </span><span class="NAME">timeoutFn.call</span><span class="PUNC">(</span><span class="NAME">that._opts.context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2096</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2097</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2098</span> </span><span class="WHIT">        </span><span class="COMM">/** @inner Script load success */</span><span class="WHIT">
<span class='linenumber'>2099</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.onload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2100</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">timeoutId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">timeoutId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="COMM">// prevent timeout callback</span><span class="WHIT">
<span class='linenumber'>2101</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">that._opts.autoUnload</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">that.unload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// unload script element</span><span class="WHIT">
<span class='linenumber'>2102</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">that.ctx.onerror</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">that.ctx.onerror</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2103</span> </span><span class="WHIT">          </span><span class="NAME">callbackFn.call</span><span class="PUNC">(</span><span class="NAME">that._opts.context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2104</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2105</span> </span><span class="WHIT">        </span><span class="COMM">// noCache flag will prevent the browser from caching the script</span><span class="WHIT">
<span class='linenumber'>2106</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.setAttribute</span><span class="PUNC">(</span><span class="STRN">'src'</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>2107</span>             </span><span class="PUNC">!</span><span class="NAME">opts.noCache</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'?'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">tau.genId</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2108</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2109</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx.setAttribute</span><span class="PUNC">(</span><span class="STRN">'href'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2110</span> </span><span class="WHIT">        </span><span class="NAME">opts.head.appendChild</span><span class="PUNC">(</span><span class="NAME">this.ctx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2111</span> </span><span class="WHIT">        </span><span class="COMM">/*
<span class='linenumber'>2112</span>          * 개발자 모드인 경우 이미지 태그를 통해 css파일을 로딩하지 않도록 처리함. 
<span class='linenumber'>2113</span>          * 브라우저에서 css파일을 이미지로 인식해서 css 디버그 하기 어려움
<span class='linenumber'>2114</span>          */</span><span class="WHIT">
<span class='linenumber'>2115</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.getRuntime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2116</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.rt.isAndroidVer2</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">rt</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">rt.getConfig</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">dev</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2117</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">callbackFn.call</span><span class="PUNC">(</span><span class="NAME">that._opts.context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2118</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2119</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2120</span> 
<span class='linenumber'>2121</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">img</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'img'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2122</span> </span><span class="WHIT">        </span><span class="NAME">img.style.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'none'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2123</span> </span><span class="WHIT">        </span><span class="NAME">img.src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2124</span> </span><span class="WHIT">        
<span class='linenumber'>2125</span>         </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">loaded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2126</span> </span><span class="WHIT">          </span><span class="NAME">img.onerror</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2127</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">that.timeoutId</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2128</span> </span><span class="WHIT">          </span><span class="NAME">document.body.removeChild</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2129</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">callbackFn.call</span><span class="PUNC">(</span><span class="NAME">that._opts.context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2130</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2131</span> </span><span class="WHIT">        </span><span class="NAME">img.onerror</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2132</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">that.timeoutId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2133</span> </span><span class="WHIT">            </span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">that.timeoutId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2134</span> </span><span class="WHIT">            </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">that.timeoutId</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2135</span> </span><span class="WHIT">            </span><span class="NAME">loaded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2136</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2137</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2138</span> </span><span class="WHIT">        </span><span class="NAME">that.timeoutId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">loaded</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts.timeout</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">700</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2139</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.body.appendChild</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2140</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2141</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">opts.head.appendChild</span><span class="PUNC">(</span><span class="NAME">this.ctx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2142</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2143</span> 
<span class='linenumber'>2144</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2145</span>      * 기존에 로딩된 스크립트를 Unloading한다. head 앨리먼트
<span class='linenumber'>2146</span>      * 내에 생성되어 있는 scrpt 앨리먼트를 삭제한다.
<span class='linenumber'>2147</span>      */</span><span class="WHIT">
<span class='linenumber'>2148</span> </span><span class="WHIT">    </span><span class="NAME">unload</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2149</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">head</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._opts.head</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2150</span> </span><span class="WHIT">          </span><span class="NAME">children</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">head.childNodes</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2151</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">children.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT">  </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2152</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">children</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2153</span> </span><span class="WHIT">          </span><span class="NAME">head.removeChild</span><span class="PUNC">(</span><span class="NAME">this.ctx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2154</span> </span><span class="WHIT">          </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2155</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2156</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2157</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2158</span> 
<span class='linenumber'>2159</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2160</span>      * 기존에 로딩된 스크립트를 Unloading한다음 새롭게
<span class='linenumber'>2161</span>      * 로딩한다.
<span class='linenumber'>2162</span>      */</span><span class="WHIT">
<span class='linenumber'>2163</span> </span><span class="WHIT">    </span><span class="NAME">reload</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2164</span> </span><span class="WHIT">      </span><span class="NAME">this.unload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2165</span> </span><span class="WHIT">      </span><span class="NAME">this._opts.head.appendChild</span><span class="PUNC">(</span><span class="NAME">this.ctx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2166</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2167</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2168</span> </span><span class="WHIT">  
<span class='linenumber'>2169</span>   </span><span class="COMM">/** @lends tau.ArrayHelper.prototype */</span><span class="WHIT">
<span class='linenumber'>2170</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.ArrayHelper'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2171</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2172</span>      * Array 객체를 편리하게 사용할 수 있도록 하기 위한
<span class='linenumber'>2173</span>      * Utility 클래스이다.
<span class='linenumber'>2174</span>      * @class
<span class='linenumber'>2175</span>      * Array 객체를 편리하게 사용할 수 있도록 하기 위한
<span class='linenumber'>2176</span>      * Utility 클래스이다.
<span class='linenumber'>2177</span>      * @example
<span class='linenumber'>2178</span>      * var a = ['a', 'b', 'c', 'a'];
<span class='linenumber'>2179</span>      * if (new tau.ArrayHelper(a).unique().pushUnique('e')) {
<span class='linenumber'>2180</span>      *   alert(a); // a = ['a', 'b', 'c', 'e']);
<span class='linenumber'>2181</span>      * }
<span class='linenumber'>2182</span>      * if (tau.ArrayHelper.prototype.pushUnique.call(a, 'f')) {
<span class='linenumber'>2183</span>      *   alert(a); // a = ['a', 'b', 'c', 'e', 'f']);
<span class='linenumber'>2184</span>      * }
<span class='linenumber'>2185</span>      * @constructs
<span class='linenumber'>2186</span>      * @param {Object|Array} context
<span class='linenumber'>2187</span>      * @see tau.arr
<span class='linenumber'>2188</span>      */</span><span class="WHIT">
<span class='linenumber'>2189</span> </span><span class="WHIT">    </span><span class="NAME">ArrayHelper</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2190</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2191</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2192</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2193</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2194</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2195</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2196</span> 
<span class='linenumber'>2197</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2198</span>      * 배열에서 중복된 항목이 있으면 제거한다.
<span class='linenumber'>2199</span>      * @example
<span class='linenumber'>2200</span>      * var arr = new tau.ArrayHelper([1, 2, 3, 3]);
<span class='linenumber'>2201</span>      * arr.unique(); // [1, 2, 3]
<span class='linenumber'>2202</span>      * @returns {tau.ArrayHelper} 'this' 객체
<span class='linenumber'>2203</span>      */</span><span class="WHIT">
<span class='linenumber'>2204</span> </span><span class="WHIT">    </span><span class="NAME">unique</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2205</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2206</span> </span><span class="WHIT">          </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2207</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">ctx.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2208</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ctx.indexOf</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2209</span> </span><span class="WHIT">          </span><span class="NAME">ctx.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2210</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2211</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2212</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2213</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2214</span> 
<span class='linenumber'>2215</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2216</span>      * 명시된 값을 배열을 맨 마지막에 추가한다. 중복된 값이
<span class='linenumber'>2217</span>      * 있으면 추가하지 않는다.
<span class='linenumber'>2218</span>      * @example
<span class='linenumber'>2219</span>      * var a = [1, 2, 3];
<span class='linenumber'>2220</span>      * var arr = new tau.ArrayHelper(a);
<span class='linenumber'>2221</span>      * arr.pushUnique(4); // true 
<span class='linenumber'>2222</span>      * // a is [1, 2, 3, 4]
<span class='linenumber'>2223</span>      *
<span class='linenumber'>2224</span>      * @param {Object} value 배열에 추가하고자 하는 값
<span class='linenumber'>2225</span>      * @returns {Boolean} 명시된 값이 배열에 추가되었으면
<span class='linenumber'>2226</span>      * true를 그렇지 않으면 false를 반환한다.
<span class='linenumber'>2227</span>      */</span><span class="WHIT">
<span class='linenumber'>2228</span> </span><span class="WHIT">    </span><span class="NAME">pushUnique</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2229</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2230</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ctx.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2231</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ctx.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">ctx.push</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2232</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2233</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2234</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2235</span> 
<span class='linenumber'>2236</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2237</span>      * 명시된 값을 배열의 맨 앞부분에 삽입한다. 만약 중복된
<span class='linenumber'>2238</span>      * 값이 있으면 추가하지 않는다.
<span class='linenumber'>2239</span>      * @example
<span class='linenumber'>2240</span>      * var arr = new tau.ArrayHelper([1, 2, 3, 4]);
<span class='linenumber'>2241</span>      * arr.unshiftUnique(5); // [5, 1, 2, 3, 4]
<span class='linenumber'>2242</span>      * @param {Object} value 배열에 추가하고자 하는 값
<span class='linenumber'>2243</span>      * @returns {Boolean} 명시된 값이 배열에 추가되었으면
<span class='linenumber'>2244</span>      * true를 그렇지 않으면 false를 반환한다.
<span class='linenumber'>2245</span>      */</span><span class="WHIT">
<span class='linenumber'>2246</span> </span><span class="WHIT">    </span><span class="NAME">unshiftUnique</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2247</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2248</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ctx.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2249</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ctx.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">ctx.unshift</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2250</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2251</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2252</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2253</span> 
<span class='linenumber'>2254</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2255</span>      * 배열에서 명시된 값을 제거한다.
<span class='linenumber'>2256</span>      * @example
<span class='linenumber'>2257</span>      * var arr = new tau.ArrayHelper([5, 1, 2, 3, 4]);
<span class='linenumber'>2258</span>      * arr.remove(5); // [1, 2, 3, 4]
<span class='linenumber'>2259</span>      *
<span class='linenumber'>2260</span>      * @param {Object} value 배열에서 제거될 값
<span class='linenumber'>2261</span>      * @param {Boolean} all true이면 동일한 모든 값을 제거한다.
<span class='linenumber'>2262</span>      * @returns {Number} 제거된 값의 개수 (0 [null/false] = none)
<span class='linenumber'>2263</span>      */</span><span class="WHIT">
<span class='linenumber'>2264</span> </span><span class="WHIT">    </span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">all</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2265</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">count</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2266</span> </span><span class="WHIT">          </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2267</span> </span><span class="WHIT">          </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ctx.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2268</span> </span><span class="WHIT">      </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2269</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ctx.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2270</span> </span><span class="WHIT">          </span><span class="NAME">count</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2271</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2272</span> </span><span class="WHIT">        </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">all</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ctx.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2273</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2274</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">count</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2275</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2276</span> 
<span class='linenumber'>2277</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2278</span>      * 배열에서 맨 마지막에 위치한 값을 반환한다. 이때 배열의
<span class='linenumber'>2279</span>      * 변화는 발생되지 않는다.
<span class='linenumber'>2280</span>      * @example
<span class='linenumber'>2281</span>      * var arr = new tau.ArrayHelper([1, 2, 3]);
<span class='linenumber'>2282</span>      * arr.peek(); // 3
<span class='linenumber'>2283</span>      *
<span class='linenumber'>2284</span>      * @returns {Object} 배열에서의 맨 마지막 값
<span class='linenumber'>2285</span>      */</span><span class="WHIT">
<span class='linenumber'>2286</span> </span><span class="WHIT">    </span><span class="NAME">peek</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2287</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2288</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="PUNC">[</span><span class="NAME">ctx.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2289</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2290</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2291</span> 
<span class='linenumber'>2292</span> 
<span class='linenumber'>2293</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.URLHelper.prototype */</span><span class="WHIT">
<span class='linenumber'>2294</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.URLHelper'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2295</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2296</span>      * URL을 편리하게 조작할 수 있도록 하는 Helper
<span class='linenumber'>2297</span>      * 클래스이다. 이 클래스를 좀더 편리하게 사용할 수
<span class='linenumber'>2298</span>      * 있도록 {@link tau.url}() Utility 메소드를
<span class='linenumber'>2299</span>      * 지원한다.
<span class='linenumber'>2300</span>      * @class
<span class='linenumber'>2301</span>      * URL을 파싱하고 관리하는 Helper클래스
<span class='linenumber'>2302</span>      * @example
<span class='linenumber'>2303</span>      * var url = new tau.URLHelper('http://foo.com');
<span class='linenumber'>2304</span>      * url.protocol(); // 'http:'
<span class='linenumber'>2305</span>      * url.host(); // 'foo.com'
<span class='linenumber'>2306</span>      *
<span class='linenumber'>2307</span>      * @constructs
<span class='linenumber'>2308</span>      * @param {String} context URL 문자열 
<span class='linenumber'>2309</span>      * @param {Object|String} [params] URL에 추가할 파라미터 
<span class='linenumber'>2310</span>      * @see tau.url
<span class='linenumber'>2311</span>      */</span><span class="WHIT">
<span class='linenumber'>2312</span> </span><span class="WHIT">    </span><span class="NAME">URLHelper</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2313</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2314</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2315</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2316</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2317</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2318</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2319</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2320</span> </span><span class="WHIT">          </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.ctx.indexOf</span><span class="PUNC">(</span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'&'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'>2321</span>               </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">params</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2322</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2323</span> </span><span class="WHIT">          </span><span class="NAME">tau.forEach</span><span class="PUNC">(</span><span class="NAME">params</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2324</span> </span><span class="WHIT">            </span><span class="NAME">this.appendParam</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2325</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2326</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2327</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2328</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2329</span> 
<span class='linenumber'>2330</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2331</span>      * URL이 현재 Document를 기준으로 원격 도메인인지 확인하고
<span class='linenumber'>2332</span>      * 그 결과를 true/false로 반환한다.
<span class='linenumber'>2333</span>      * 
<span class='linenumber'>2334</span>      * @returns {Boolean} 만약 URL이 원격도메인이면 true를 반환한다.
<span class='linenumber'>2335</span>      */</span><span class="WHIT">
<span class='linenumber'>2336</span> </span><span class="WHIT">    </span><span class="NAME">isRemote</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2337</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2338</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.resolveURL</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">_ROOTURL</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='linenumber'>2339</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2340</span> 
<span class='linenumber'>2341</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2342</span>      * URL에 명시된 호스트 이름을 반환한다.
<span class='linenumber'>2343</span>      * @example
<span class='linenumber'>2344</span>      * var url = new tau.URLHelper('http://foo.com');
<span class='linenumber'>2345</span>      * url.host(); // 'foo.com'
<span class='linenumber'>2346</span>      *
<span class='linenumber'>2347</span>      * @returns {String} 호스트 명
<span class='linenumber'>2348</span>      */</span><span class="WHIT">
<span class='linenumber'>2349</span> </span><span class="WHIT">    </span><span class="NAME">host</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2350</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_URLREGEXP.exec</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2351</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">parts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">parts.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='linenumber'>2352</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2353</span> 
<span class='linenumber'>2354</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2355</span>      * URL에 사용된 프로토콜을 반환한다.
<span class='linenumber'>2356</span>      * @example
<span class='linenumber'>2357</span>      * var url = new tau.URLHelper('http://foo.com');
<span class='linenumber'>2358</span>      * url.protocol(); // 'http:'
<span class='linenumber'>2359</span>      *
<span class='linenumber'>2360</span>      * @returns {String} 프로토콜 이름
<span class='linenumber'>2361</span>      */</span><span class="WHIT">
<span class='linenumber'>2362</span> </span><span class="WHIT">    </span><span class="NAME">protocol</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2363</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_URLREGEXP.exec</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2364</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isArray</span><span class="PUNC">(</span><span class="NAME">parts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">parts.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='linenumber'>2365</span>     </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2366</span> 
<span class='linenumber'>2367</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2368</span>      * URL에 사용된 Query String을 반환한다.
<span class='linenumber'>2369</span>      * @example
<span class='linenumber'>2370</span>      * var url = new tau.URLHelper('http://foo.com', {aaa: 'bbb', ccc: 'ddd'});
<span class='linenumber'>2371</span>      * url.query(); // "aaa=bbb&ccc=ddd"
<span class='linenumber'>2372</span>      *
<span class='linenumber'>2373</span>      * @returns {String} Query string
<span class='linenumber'>2374</span>      */</span><span class="WHIT">
<span class='linenumber'>2375</span> </span><span class="WHIT">    </span><span class="NAME">query</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2376</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2377</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ctx.substring</span><span class="PUNC">(</span><span class="NAME">ctx.indexOf</span><span class="PUNC">(</span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2378</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2379</span> 
<span class='linenumber'>2380</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2381</span>      * URL에서 명시된 파라미터 키에 해당하는 값들을 모두 반환한다.
<span class='linenumber'>2382</span>      * @example
<span class='linenumber'>2383</span>      * var url = new tau.URLHelper('http://foo.com', 'aaa=bbb&ccc=ddd&ccc=eee');
<span class='linenumber'>2384</span>      * url.query(); // "aaa=bbb&ccc=ddd&ccc=eee"
<span class='linenumber'>2385</span>      * url.param('ccc'); // "ddd"
<span class='linenumber'>2386</span>      * url.param('ccc', true); // ["ddd", "eee"]
<span class='linenumber'>2387</span>      *
<span class='linenumber'>2388</span>      * @param {String} name 찾고자 하는 파라미터 이름
<span class='linenumber'>2389</span>      * @param {Boolean} all true이면 일치하는 모든 파라미터의 값을
<span class='linenumber'>2390</span>      * 배열로 반환한다.
<span class='linenumber'>2391</span>      * @returns {String|Array} 하나 또는 배열형태의 파라미터 값
<span class='linenumber'>2392</span>      */</span><span class="WHIT">
<span class='linenumber'>2393</span> </span><span class="WHIT">    </span><span class="NAME">param</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">all</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2394</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">search</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>2395</span>           </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2396</span> </span><span class="WHIT">          </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2397</span> </span><span class="WHIT">          </span><span class="NAME">nameRegExp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">'[\\?&]'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'=([^&#]*)'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'g'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2398</span> </span><span class="WHIT">      </span><span class="COMM">// Search all parameter name instances and add to the values array</span><span class="WHIT">
<span class='linenumber'>2399</span> </span><span class="WHIT">      </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">search</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">nameRegExp.exec</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2400</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">search</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">search</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2401</span> </span><span class="WHIT">          </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">search</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2402</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">len</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parts.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">len</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2403</span> </span><span class="WHIT">            </span><span class="NAME">values.push</span><span class="PUNC">(</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2404</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2405</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2406</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2407</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">all</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2408</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2409</span> 
<span class='linenumber'>2410</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2411</span>      * URL에 명시된 파라미터의 키와 값을 맵 형태로 반환한다.
<span class='linenumber'>2412</span>      * @example
<span class='linenumber'>2413</span>      * var url = new tau.URLHelper('http://foo.com', 'aaa=bbb&ccc=ddd&ccc=eee');
<span class='linenumber'>2414</span>      * url.paramMap(); // {"aaa":"bbb","ccc":"ddd"}
<span class='linenumber'>2415</span>      * url.paramMap(true) // {"aaa":["bbb"],"ccc":["ddd","eee"]}
<span class='linenumber'>2416</span>      *
<span class='linenumber'>2417</span>      * @param {Boolean} all true이면 해당키와 매핑되는 모든 값을 반환한다.
<span class='linenumber'>2418</span>      * @returns {Object} 파라미터 맵
<span class='linenumber'>2419</span>      */</span><span class="WHIT">
<span class='linenumber'>2420</span> </span><span class="WHIT">    </span><span class="NAME">paramMap</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">all</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2421</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">search</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>2422</span>           </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2423</span> </span><span class="WHIT">          </span><span class="NAME">pattern</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[\\?&]([^&#=]*)/g</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2424</span> </span><span class="WHIT">          </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2425</span> </span><span class="WHIT">      </span><span class="COMM">// Find parameters and map them to their respective values</span><span class="WHIT">
<span class='linenumber'>2426</span> </span><span class="WHIT">      </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">search</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pattern.exec</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2427</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">search</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">search</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">search</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2428</span> </span><span class="WHIT">          </span><span class="NAME">result</span><span class="PUNC">[</span><span class="NAME">search</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.param</span><span class="PUNC">(</span><span class="NAME">search</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">all</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2429</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2430</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2431</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2432</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2433</span> 
<span class='linenumber'>2434</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2435</span>      * 상대경로의 URL을 절대경로의 URL로 변환한다.
<span class='linenumber'>2436</span>      * &lt;p/>
<span class='linenumber'>2437</span>      * 만약 base가 설정되어 있고 URL이 상대경로이면 리턴되는 결과는 base가
<span class='linenumber'>2438</span>      * prepend된 형태가 된다.
<span class='linenumber'>2439</span>      * &lt;p/>
<span class='linenumber'>2440</span>      * 상대경로는 http, ftp 등과 같은 prefix로 기술되지 않고 ./, ../, /, //와
<span class='linenumber'>2441</span>      * 같이 기술된다.
<span class='linenumber'>2442</span>      * @example
<span class='linenumber'>2443</span>      * var url = new tau.URLHelper('foo.html', 'aaa=bbb&ccc=ddd&ccc=eee');
<span class='linenumber'>2444</span>      * url.resolve('http://aaa.bbb/');
<span class='linenumber'>2445</span>      * // prints "http://aaa.bbb/foo.html?aaa=bbb&ccc=ddd&ccc=eee"
<span class='linenumber'>2446</span>      *
<span class='linenumber'>2447</span>      * @param {String} base prepend할 base URL, 만약 null이면 '/'을 사용한다.
<span class='linenumber'>2448</span>      * @returns {Object} 'this' 객체
<span class='linenumber'>2449</span>      */</span><span class="WHIT">
<span class='linenumber'>2450</span> </span><span class="WHIT">    </span><span class="NAME">resolve</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">base</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2451</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2452</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.resolveURL</span><span class="PUNC">(</span><span class="NAME">this.ctx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">base</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2453</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2454</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2455</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.resolveURL</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">base</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2456</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2457</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2458</span> 
<span class='linenumber'>2459</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2460</span>      * URL의 파라미터를 추가하거나 기존의 것을 덮어쓴다.
<span class='linenumber'>2461</span>      * @example
<span class='linenumber'>2462</span>      * var url = new tau.URLHelper('foo.html', 'aaa=bbb');
<span class='linenumber'>2463</span>      * url.appendParam('ccc', 'ddd');
<span class='linenumber'>2464</span>      * url.query(); // "aaa=bbb&ccc=ddd"
<span class='linenumber'>2465</span>      *
<span class='linenumber'>2466</span>      * @param {String} name 파라미터 이름
<span class='linenumber'>2467</span>      * @param {String} value 파라미터 값
<span class='linenumber'>2468</span>      * @param {Boolean} overwrite true이면 기존의 값을 덮어쓴다.
<span class='linenumber'>2469</span>      * @returns {Object} 'this' 객체 
<span class='linenumber'>2470</span>      */</span><span class="WHIT">
<span class='linenumber'>2471</span> </span><span class="WHIT">    </span><span class="NAME">appendParam</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">overwrite</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2472</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>2473</span>           </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2474</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2475</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">overwrite</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2476</span> </span><span class="WHIT">          </span><span class="COMM">// Search for all parameters and overwrite it with the one provided</span><span class="WHIT">
<span class='linenumber'>2477</span> </span><span class="WHIT">          </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ctx.replace</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">'[&]'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'=([^&#]*)'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'g'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2478</span> </span><span class="WHIT">          </span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">'[\\?]'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'=([^&#]*)'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'g'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">ctx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2479</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">parts</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2480</span> </span><span class="WHIT">            </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ctx.replace</span><span class="PUNC">(</span><span class="NAME">parts</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'?'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'='</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2481</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2482</span> </span><span class="WHIT">            </span><span class="NAME">overwrite</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2483</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2484</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2485</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">overwrite</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2486</span> </span><span class="WHIT">          </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">ctx.indexOf</span><span class="PUNC">(</span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'&'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'?'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'='</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2487</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2488</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2489</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.ctx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2490</span> </span><span class="WHIT">        </span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2491</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2492</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2493</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">ctx</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2494</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2495</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2496</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2497</span> 
<span class='linenumber'>2498</span> 
<span class='linenumber'>2499</span> </span><span class="WHIT">  </span><span class="COMM">/** @lends tau.JobQueue.prototype */</span><span class="WHIT">
<span class='linenumber'>2500</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.JobQueue'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2501</span> </span><span class="WHIT">    </span><span class="NAME">$static</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2502</span> </span><span class="WHIT">      </span><span class="COMM">/** @inner Default until that checks the iteration */</span><span class="WHIT">
<span class='linenumber'>2503</span> </span><span class="WHIT">      </span><span class="NAME">DEFAULT_UNTIL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2504</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.iteration</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// this === job instance</span><span class="WHIT">
<span class='linenumber'>2505</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2506</span> </span><span class="WHIT">      </span><span class="COMM">/** @inner Until to stop on next job call */</span><span class="WHIT">
<span class='linenumber'>2507</span> </span><span class="WHIT">      </span><span class="NAME">CANCELED_UNTIL</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2508</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2509</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2510</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2511</span> 
<span class='linenumber'>2512</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2513</span>      * @class
<span class='linenumber'>2514</span>      * Job Queue.
<span class='linenumber'>2515</span>      * @constructs
<span class='linenumber'>2516</span>      * @ignore
<span class='linenumber'>2517</span>      */</span><span class="WHIT">
<span class='linenumber'>2518</span> </span><span class="WHIT">    </span><span class="NAME">JobQueue</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">opts</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2519</span> </span><span class="WHIT">      </span><span class="COMM">/** @private _running Currently running job */</span><span class="WHIT">
<span class='linenumber'>2520</span> </span><span class="WHIT">      </span><span class="COMM">/** @private _paused Queue paused value */</span><span class="WHIT">
<span class='linenumber'>2521</span> </span><span class="WHIT">      </span><span class="COMM">/** @private _queue Job queue array */</span><span class="WHIT">
<span class='linenumber'>2522</span> </span><span class="WHIT">      </span><span class="NAME">this._queue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2523</span> </span><span class="WHIT">      </span><span class="COMM">/** @private _opts JobQueue options */</span><span class="WHIT">
<span class='linenumber'>2524</span> </span><span class="WHIT">      </span><span class="NAME">this._opts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2525</span> </span><span class="WHIT">        </span><span class="NAME">idSeed</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">      </span><span class="COMM">/** @param {Number} ID seed */</span><span class="WHIT">
<span class='linenumber'>2526</span> </span><span class="WHIT">        </span><span class="NAME">autoRun</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="WHIT">   </span><span class="COMM">/** @param {Boolean} Automatically run after add */</span><span class="WHIT">
<span class='linenumber'>2527</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">opts</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2528</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2529</span> 
<span class='linenumber'>2530</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2531</span>      * Checks if there is an job currently running.
<span class='linenumber'>2532</span>      * @returns {Boolean} True if an job is running
<span class='linenumber'>2533</span>      * @private
<span class='linenumber'>2534</span>      */</span><span class="WHIT">
<span class='linenumber'>2535</span> </span><span class="WHIT">    </span><span class="NAME">isRunning</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2536</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this._running</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2537</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2538</span> 
<span class='linenumber'>2539</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2540</span>      * Checks if the queue is paused.
<span class='linenumber'>2541</span>      * @returns {Boolean} True if the queue is paused
<span class='linenumber'>2542</span>      * @private
<span class='linenumber'>2543</span>      */</span><span class="WHIT">
<span class='linenumber'>2544</span> </span><span class="WHIT">    </span><span class="NAME">isPaused</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2545</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this._paused</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2546</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2547</span> 
<span class='linenumber'>2548</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2549</span>      * Returns the size of the queue (includes currently running job).
<span class='linenumber'>2550</span>      * @returns {Number} Size of the the queue
<span class='linenumber'>2551</span>      * @private
<span class='linenumber'>2552</span>      */</span><span class="WHIT">
<span class='linenumber'>2553</span> </span><span class="WHIT">    </span><span class="NAME">size</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2554</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isRunning</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2555</span> </span><span class="WHIT">        </span><span class="NAME">this.next</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Flush out previously completed job</span><span class="WHIT">
<span class='linenumber'>2556</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2557</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._queue.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2558</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2559</span> 
<span class='linenumber'>2560</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2561</span>      * Returns a job reference.
<span class='linenumber'>2562</span>      * @param {Number|Function|Object} j Job id/function/reference to find
<span class='linenumber'>2563</span>      * @returns {Object} Job object (null = job not found)
<span class='linenumber'>2564</span>      * @private
<span class='linenumber'>2565</span>      */</span><span class="WHIT">
<span class='linenumber'>2566</span> </span><span class="WHIT">    </span><span class="NAME">get</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2567</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._queue</span><span class="PUNC">[</span><span class="NAME">this.indexOf</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2568</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2569</span> 
<span class='linenumber'>2570</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2571</span>      * Returns the immidiate next job object.
<span class='linenumber'>2572</span>      * @returns {Object} Next job object (null = no jobs in queue)
<span class='linenumber'>2573</span>      * @private
<span class='linenumber'>2574</span>      */</span><span class="WHIT">
<span class='linenumber'>2575</span> </span><span class="WHIT">    </span><span class="NAME">next</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2576</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">next</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='linenumber'>2577</span>       </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._queue.length</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">next</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._queue</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2578</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">next.until</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2579</span> </span><span class="WHIT">          </span><span class="NAME">this._queue.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Job finished; remove & continue onto next</span><span class="WHIT">
<span class='linenumber'>2580</span> </span><span class="WHIT">          </span><span class="NAME">next</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2581</span> </span><span class="WHIT">          </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2582</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isNumber</span><span class="PUNC">(</span><span class="NAME">next.delay</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2583</span> </span><span class="WHIT">          </span><span class="COMM">// Next must be delayed, reorder queue with most waited job in front</span><span class="WHIT">
<span class='linenumber'>2584</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._queue.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2585</span> </span><span class="WHIT">            </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._queue</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2586</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j.timeStamp</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j.delay</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'>2587</span>                 </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">next.timeStamp</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">next.delay</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2588</span> </span><span class="WHIT">              </span><span class="NAME">next</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._queue.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2589</span> </span><span class="WHIT">              </span><span class="NAME">this._queue.unshift</span><span class="PUNC">(</span><span class="NAME">next</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2590</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2591</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2592</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2593</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">next</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2594</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2595</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2596</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2597</span> 
<span class='linenumber'>2598</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2599</span>      * Starts the execution for jobs in the quueue.
<span class='linenumber'>2600</span>      * @param {Function|Object} j Job function/reference to add & run first
<span class='linenumber'>2601</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2602</span>      * @private
<span class='linenumber'>2603</span>      */</span><span class="WHIT">
<span class='linenumber'>2604</span> </span><span class="WHIT">    </span><span class="NAME">run</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2605</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">wait</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>2606</span>           </span><span class="NAME">jobQueue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2607</span> 
<span class='linenumber'>2608</span> </span><span class="WHIT">      </span><span class="COMM">// Add the jobs to the front of the queue</span><span class="WHIT">
<span class='linenumber'>2609</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2610</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2611</span> </span><span class="WHIT">          </span><span class="COMM">// Automaticaly unpause if a job is added via run</span><span class="WHIT">
<span class='linenumber'>2612</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._queue.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.insert</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">_queue.length</span><span class="WHIT">
<span class='linenumber'>2613</span> </span><span class="WHIT">              </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.isPaused</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2614</span> </span><span class="WHIT">            </span><span class="NAME">this._paused</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2615</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">          
<span class='linenumber'>2616</span>         </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2617</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2618</span> 
<span class='linenumber'>2619</span> </span><span class="WHIT">      </span><span class="COMM">// Run all available jobs in proper order</span><span class="WHIT">
<span class='linenumber'>2620</span> </span><span class="WHIT">      </span><span class="COMM">// No need to re-delay when the next job is the currently waiting job</span><span class="WHIT">
<span class='linenumber'>2621</span> </span><span class="WHIT">      </span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isPaused</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.isRunning</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'>2622</span>           </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.next</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._waiting</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2623</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._waiting</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2624</span> </span><span class="WHIT">          </span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">this._waiting.delayId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Clear any waiting job</span><span class="WHIT">
<span class='linenumber'>2625</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._waiting.delayId</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2626</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._waiting</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2627</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2628</span> </span><span class="WHIT">        </span><span class="NAME">wait</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">tau.isNumber</span><span class="PUNC">(</span><span class="NAME">job.delay</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>2629</span>             </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">job.delay</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">job.timeStamp</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2630</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">wait</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2631</span> </span><span class="WHIT">          </span><span class="NAME">this._waiting</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Set as the current job in waiting</span><span class="WHIT">
<span class='linenumber'>2632</span> </span><span class="WHIT">          </span><span class="COMM">/** @inner Next job needs to be delayed, re-run job after wait */</span><span class="WHIT">
<span class='linenumber'>2633</span> </span><span class="WHIT">          </span><span class="NAME">this._waiting.delayId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2634</span> </span><span class="WHIT">            </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">jobQueue._waiting.delayId</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2635</span> </span><span class="WHIT">            </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">jobQueue._waiting</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2636</span> </span><span class="WHIT">            </span><span class="NAME">jobQueue.run.call</span><span class="PUNC">(</span><span class="NAME">jobQueue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2637</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">wait</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2638</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._execute</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// No waiting needed, execute the job</span><span class="WHIT">
<span class='linenumber'>2639</span> </span><span class="WHIT">          </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2640</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2641</span> </span><span class="WHIT">        </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2642</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2643</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2644</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2645</span> 
<span class='linenumber'>2646</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2647</span>      * Pauses the running queue.
<span class='linenumber'>2648</span>      * @param {Boolean} unpause True will unpause the queue
<span class='linenumber'>2649</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2650</span>      * @private
<span class='linenumber'>2651</span>      */</span><span class="WHIT">
<span class='linenumber'>2652</span> </span><span class="WHIT">    </span><span class="NAME">pause</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">unpause</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2653</span> </span><span class="WHIT">      </span><span class="NAME">this._paused</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">unpause</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2654</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2655</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2656</span> 
<span class='linenumber'>2657</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2658</span>      * Resumes the execution of the queue if it was paused previously 
<span class='linenumber'>2659</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2660</span>      * @private
<span class='linenumber'>2661</span>      */</span><span class="WHIT">
<span class='linenumber'>2662</span> </span><span class="WHIT">    </span><span class="NAME">resume</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2663</span> </span><span class="WHIT">      </span><span class="NAME">this._paused</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2664</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.run.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2665</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2666</span> 
<span class='linenumber'>2667</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2668</span>      * Stops and clears any job remaining in the queue.
<span class='linenumber'>2669</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2670</span>      * @private
<span class='linenumber'>2671</span>      */</span><span class="WHIT">
<span class='linenumber'>2672</span> </span><span class="WHIT">    </span><span class="NAME">reset</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2673</span> </span><span class="WHIT">      </span><span class="NAME">this.cancel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2674</span> </span><span class="WHIT">      </span><span class="NAME">this._queue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2675</span> </span><span class="WHIT">      </span><span class="NAME">this._paused</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2676</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2677</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2678</span> 
<span class='linenumber'>2679</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2680</span>      * Returns the index of an job.
<span class='linenumber'>2681</span>      * @param {Number|Function|Object} j Job id/function/reference to find
<span class='linenumber'>2682</span>      * @returns {Number} Index of the job (-1 = not found)
<span class='linenumber'>2683</span>      * @private
<span class='linenumber'>2684</span>      */</span><span class="WHIT">
<span class='linenumber'>2685</span> </span><span class="WHIT">    </span><span class="NAME">indexOf</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2686</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>2687</span>           </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.typeOf</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2688</span> </span><span class="WHIT">      </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2689</span> </span><span class="WHIT">      </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>2690</span> </span><span class="WHIT">        </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'fn'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2691</span> </span><span class="WHIT">        </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2692</span> </span><span class="WHIT">      </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>2693</span> </span><span class="WHIT">        </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'id'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2694</span> </span><span class="WHIT">        </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2695</span> </span><span class="WHIT">      </span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT"> 
<span class='linenumber'>2696</span>         </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._queue.indexOf</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Find by job object reference</span><span class="WHIT">
<span class='linenumber'>2697</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2698</span> </span><span class="WHIT">      </span><span class="COMM">// Find by Job id/function</span><span class="WHIT">
<span class='linenumber'>2699</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._queue.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2700</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._queue</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2701</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2702</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2703</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2704</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2705</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2706</span> 
<span class='linenumber'>2707</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2708</span>      * Adds a (or multiple arguments) job to the end of the queue.
<span class='linenumber'>2709</span>      * @param {Function|Object} j Job function/reference to add
<span class='linenumber'>2710</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2711</span>      * @private
<span class='linenumber'>2712</span>      */</span><span class="WHIT">
<span class='linenumber'>2713</span> </span><span class="WHIT">    </span><span class="NAME">add</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2714</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2715</span> </span><span class="WHIT">        </span><span class="NAME">this.insert</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2716</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2717</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isRunning</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._opts.autoRun</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2718</span> </span><span class="WHIT">        </span><span class="NAME">this.run</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2719</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2720</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2721</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2722</span> 
<span class='linenumber'>2723</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2724</span>      * Inserts a job to a specified position in the queue.
<span class='linenumber'>2725</span>      * &lt;p/>
<span class='linenumber'>2726</span>      * Does not automatically run the jobs in the queue.
<span class='linenumber'>2727</span>      * @param {Object} job Job reference with properties to inset
<span class='linenumber'>2728</span>      * @param {Number} pos Insert position
<span class='linenumber'>2729</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2730</span>      * @private
<span class='linenumber'>2731</span>      */</span><span class="WHIT">
<span class='linenumber'>2732</span> </span><span class="WHIT">    </span><span class="NAME">insert</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2733</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2734</span> </span><span class="WHIT">        </span><span class="NAME">this._insert</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">fn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2735</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">j.fn</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2736</span> </span><span class="WHIT">        </span><span class="NAME">this._insert</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">j.delay</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2737</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2738</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2739</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2740</span> 
<span class='linenumber'>2741</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2742</span>      * Removes a job (or multiple jobs) from the queue.
<span class='linenumber'>2743</span>      * @param {Number|Function|Object} j Job id/function/reference to remove
<span class='linenumber'>2744</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2745</span>      * @private
<span class='linenumber'>2746</span>      */</span><span class="WHIT">
<span class='linenumber'>2747</span> </span><span class="WHIT">    </span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2748</span> </span><span class="WHIT">      </span><span class="COMM">// Remove must: exist and not be running</span><span class="WHIT">
<span class='linenumber'>2749</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.indexOf</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2750</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._running</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">this._queue</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2751</span> </span><span class="WHIT">        </span><span class="NAME">this._queue.splice</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2752</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2753</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Recurse for multiple parameters </span><span class="WHIT">
<span class='linenumber'>2754</span> </span><span class="WHIT">        </span><span class="NAME">this.remove.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2755</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2756</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2757</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2758</span> 
<span class='linenumber'>2759</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2760</span>      * Cancels & removes a job (or multiple jobs) from the queue.
<span class='linenumber'>2761</span>      * &lt;p/>
<span class='linenumber'>2762</span>      * Not providing a parameter will stop the currently running job.
<span class='linenumber'>2763</span>      * @param {Number|Function|Object} j Job id/function/reference to cancel
<span class='linenumber'>2764</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2765</span>      * @private
<span class='linenumber'>2766</span>      */</span><span class="WHIT">
<span class='linenumber'>2767</span> </span><span class="WHIT">    </span><span class="NAME">cancel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2768</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2769</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2770</span> </span><span class="WHIT">        </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.indexOf</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2771</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.isRunning</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2772</span> </span><span class="WHIT">        </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// No parameter, cancel the currently running job (first </span><span class="WHIT">
<span class='linenumber'>2773</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2774</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2775</span> </span><span class="WHIT">        </span><span class="NAME">this._queue</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">cancel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2776</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2777</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Recurse for multiple parameters </span><span class="WHIT">
<span class='linenumber'>2778</span> </span><span class="WHIT">        </span><span class="NAME">this.remove.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2779</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2780</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2781</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2782</span> 
<span class='linenumber'>2783</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2784</span>      * Promotes, or demotes, a job to a specific position in the queue.
<span class='linenumber'>2785</span>      * @param {Function|Number|Object} j Job function/id/reference to promote
<span class='linenumber'>2786</span>      * @param {Number} pos New index position (default 0, top of the queue)
<span class='linenumber'>2787</span>      * @returns {Object} &lt;code>this&lt;/code> instance
<span class='linenumber'>2788</span>      * @private
<span class='linenumber'>2789</span>      */</span><span class="WHIT">
<span class='linenumber'>2790</span> </span><span class="WHIT">    </span><span class="NAME">promote</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2791</span> </span><span class="WHIT">      </span><span class="COMM">// New index pos (default is 0)</span><span class="WHIT">
<span class='linenumber'>2792</span> </span><span class="WHIT">      </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">this._queue.length</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>2793</span>           </span><span class="NAME">this._queue.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2794</span> 
<span class='linenumber'>2795</span> </span><span class="WHIT">      </span><span class="COMM">// Promote must: exist, new position be different, and not be running</span><span class="WHIT">
<span class='linenumber'>2796</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.indexOf</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2797</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._running</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">this._queue</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2798</span> </span><span class="WHIT">        </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._queue.splice</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Remove from queue and re-index</span><span class="WHIT">
<span class='linenumber'>2799</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.isRunning</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2800</span> </span><span class="WHIT">          </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Insert just after currently running job</span><span class="WHIT">
<span class='linenumber'>2801</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2802</span> </span><span class="WHIT">        </span><span class="NAME">this._queue.splice</span><span class="PUNC">(</span><span class="NAME">pos</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2803</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2804</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2805</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2806</span> 
<span class='linenumber'>2807</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2808</span>      * Creates and inserts a job into the queue.
<span class='linenumber'>2809</span>      * @private
<span class='linenumber'>2810</span>      * @param {Object} job Job reference with properties to add
<span class='linenumber'>2811</span>      * @param {Number} pos Insert position
<span class='linenumber'>2812</span>      * @prarm {Number} delay Add job after a secified milliseconds
<span class='linenumber'>2813</span>      */</span><span class="WHIT">
<span class='linenumber'>2814</span> </span><span class="WHIT">    </span><span class="NAME">_insert</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">delay</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2815</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jobQueue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2816</span> </span><span class="WHIT">      </span><span class="NAME">job</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2817</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Number} id Unqiue ID that defines the job */</span><span class="WHIT">
<span class='linenumber'>2818</span> </span><span class="WHIT">        </span><span class="NAME">id</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">this._opts.idSeed</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2819</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Number} timestamp Job creation timestamp */</span><span class="WHIT">
<span class='linenumber'>2820</span> </span><span class="WHIT">        </span><span class="NAME">timeStamp</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='linenumber'>2821</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2822</span> </span><span class="WHIT">      </span><span class="NAME">job</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.mixin</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2823</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Function} fn Job's execution function */</span><span class="WHIT">
<span class='linenumber'>2824</span> </span><span class="WHIT">        </span><span class="NAME">fn</span><span class="WHIT">        </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.emptyFn</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2825</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Object} context "this" context for the fn */</span><span class="WHIT">
<span class='linenumber'>2826</span> </span><span class="WHIT">        </span><span class="NAME">context</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2827</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Number} iteration Number of time to run the job */</span><span class="WHIT">
<span class='linenumber'>2828</span> </span><span class="WHIT">        </span><span class="NAME">iteration</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2829</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Function} until Job's completion check function */</span><span class="WHIT">
<span class='linenumber'>2830</span> </span><span class="WHIT">        </span><span class="NAME">until</span><span class="WHIT">     </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.JobQueue.DEFAULT_UNTIL</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2831</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Number} idle Milliseconds between each execution. 
<span class='linenumber'>2832</span>          *  Note: Undefined/negative value will ignore cancel interruption */</span><span class="WHIT">
<span class='linenumber'>2833</span> </span><span class="WHIT">        </span><span class="NAME">idle</span><span class="WHIT">      </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2834</span> </span><span class="WHIT">        </span><span class="COMM">/** @param Cancels a job (cont flag will continue execution) */</span><span class="WHIT">
<span class='linenumber'>2835</span> </span><span class="WHIT">        </span><span class="NAME">cancel</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cont</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2836</span> </span><span class="WHIT">                      </span><span class="NAME">jobQueue._cancel.call</span><span class="PUNC">(</span><span class="NAME">jobQueue</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cont</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2837</span> </span><span class="WHIT">                    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2838</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Function} exception Exception callback function */</span><span class="WHIT">
<span class='linenumber'>2839</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Array} arguments Parameters for the fn */</span><span class="WHIT">
<span class='linenumber'>2840</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Number} delay Milliseconds to wait to be run after insert 
<span class='linenumber'>2841</span>          *  Note: Setting negative value will raise its ranking for next() */</span><span class="WHIT">
<span class='linenumber'>2842</span> </span><span class="WHIT">        </span><span class="COMM">/** @param {Boolean} stopNext Stops the next job execution */</span><span class="WHIT">
<span class='linenumber'>2843</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2844</span> 
<span class='linenumber'>2845</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isNumber</span><span class="PUNC">(</span><span class="NAME">pos</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2846</span> </span><span class="WHIT">        </span><span class="NAME">this._queue.push</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2847</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2848</span> </span><span class="WHIT">        </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">this._queue.length</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>2849</span>             </span><span class="NAME">this._queue.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2850</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.isRunning</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2851</span> </span><span class="WHIT">          </span><span class="NAME">pos</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Insert just after currently running job</span><span class="WHIT">
<span class='linenumber'>2852</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2853</span> </span><span class="WHIT">        </span><span class="NAME">this._queue.splice</span><span class="PUNC">(</span><span class="NAME">pos</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2854</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2855</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">pos</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2856</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2857</span> 
<span class='linenumber'>2858</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2859</span>      * Executes a job.
<span class='linenumber'>2860</span>      * @private
<span class='linenumber'>2861</span>      * @param {Object} job Job reference to cancel
<span class='linenumber'>2862</span>      * @returns {Boolean} True indicates to continue calling the next job
<span class='linenumber'>2863</span>      */</span><span class="WHIT">
<span class='linenumber'>2864</span> </span><span class="WHIT">    </span><span class="NAME">_execute</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2865</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">jobQueue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2866</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._queue.indexOf</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2867</span> 
<span class='linenumber'>2868</span> </span><span class="WHIT">        </span><span class="COMM">/** @inner Call the job's function then releases run properties */</span><span class="WHIT">
<span class='linenumber'>2869</span> </span><span class="WHIT">        </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">doExecute</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2870</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.log.isLevel</span><span class="PUNC">(</span><span class="NAME">tau.log.DEBUG</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2871</span> </span><span class="WHIT">            </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="NAME">String.prototype.concat</span><span class="PUNC">(</span><span class="STRN">'Executing '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">job.fn.name</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2872</span> </span><span class="WHIT">              </span><span class="NAME">tau.isNumber</span><span class="PUNC">(</span><span class="NAME">job.delay</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'(delay '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">job.delay</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'ms)'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2873</span> </span><span class="WHIT">              </span><span class="NAME">job.idleId</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'(idle '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">job.idle</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'ms, '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">job.idleId</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">')'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT">
<span class='linenumber'>2874</span> </span><span class="WHIT">            </span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'Job-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">job.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2875</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2876</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job.idleId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2877</span> </span><span class="WHIT">            </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">job.idleId</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Pause done, remove to avoid cancel handling</span><span class="WHIT">
<span class='linenumber'>2878</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2879</span> </span><span class="WHIT">          </span><span class="KEYW">try</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2880</span> </span><span class="WHIT">            </span><span class="NAME">job.fn.apply</span><span class="PUNC">(</span><span class="NAME">job.context</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">jobQueue</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">job.arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2881</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">catch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2882</span> </span><span class="WHIT">            </span><span class="COMM">// Callback for the job's exception exeception</span><span class="WHIT">
<span class='linenumber'>2883</span> </span><span class="WHIT">            </span><span class="NAME">tau.log.error</span><span class="PUNC">(</span><span class="STRN">'Unexpected exception is occurred: '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2884</span> </span><span class="WHIT">            </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">job.exception</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2885</span> </span><span class="WHIT">              </span><span class="NAME">job.exception.call</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2886</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2887</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2888</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">jobQueue._complete.call</span><span class="PUNC">(</span><span class="NAME">jobQueue</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">job.idle</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2889</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2890</span> 
<span class='linenumber'>2891</span> </span><span class="WHIT">        </span><span class="NAME">this._running</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Set as the current job being run</span><span class="WHIT">
<span class='linenumber'>2892</span> 
<span class='linenumber'>2893</span> </span><span class="WHIT">        </span><span class="COMM">// Increment execution iteration</span><span class="WHIT">
<span class='linenumber'>2894</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isNumber</span><span class="PUNC">(</span><span class="NAME">job.iteration</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2895</span> </span><span class="WHIT">          </span><span class="NAME">job.iteration</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2896</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2897</span> </span><span class="WHIT">          </span><span class="NAME">job.iteration</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2898</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2899</span> 
<span class='linenumber'>2900</span> </span><span class="WHIT">        </span><span class="COMM">// Run the job after some idle time or right away</span><span class="WHIT">
<span class='linenumber'>2901</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isNumber</span><span class="PUNC">(</span><span class="NAME">job.idle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">job.idle</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2902</span> </span><span class="WHIT">          </span><span class="NAME">job.idleId</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">doExecute</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">job.idle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2903</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2904</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">doExecute</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2905</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2906</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2907</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2908</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2909</span> 
<span class='linenumber'>2910</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2911</span>      * Cancels a job.
<span class='linenumber'>2912</span>      * @private
<span class='linenumber'>2913</span>      * @param {Object} job Job reference to cancel
<span class='linenumber'>2914</span>      * @param {Boolean} cont contiue running the queue
<span class='linenumber'>2915</span>      */</span><span class="WHIT">
<span class='linenumber'>2916</span> </span><span class="WHIT">    </span><span class="NAME">_cancel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cont</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2917</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.log.isLevel</span><span class="PUNC">(</span><span class="NAME">tau.log.DEBUG</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2918</span> </span><span class="WHIT">        </span><span class="NAME">tau.log.debug</span><span class="PUNC">(</span><span class="NAME">String.prototype.concat</span><span class="PUNC">(</span><span class="WHIT">
<span class='linenumber'>2919</span> </span><span class="WHIT">          </span><span class="NAME">this._running</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">job</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'Stopped '</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Canceled '</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2920</span> </span><span class="WHIT">          </span><span class="STRN">'(waited '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">job.timeStamp</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'ms)'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2921</span> </span><span class="WHIT">        </span><span class="STRN">'Job-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">job.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2922</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2923</span> </span><span class="WHIT">      </span><span class="NAME">job.until</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tau.JobQueue.CANCELED_UNTIL</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2924</span> </span><span class="WHIT">      </span><span class="NAME">this.remove</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2925</span> </span><span class="WHIT">      </span><span class="NAME">this._complete</span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cont</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2926</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2927</span> 
<span class='linenumber'>2928</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2929</span>      * Clears a job's properties and the queue running state.
<span class='linenumber'>2930</span>      * @private
<span class='linenumber'>2931</span>      * @param {Object} job Job refernce to complete
<span class='linenumber'>2932</span>      * @param {Boolean} rerun Call a chained run
<span class='linenumber'>2933</span>      * @returns {Boolean} True indicates to continue calling the next job
<span class='linenumber'>2934</span>      */</span><span class="WHIT">
<span class='linenumber'>2935</span> </span><span class="WHIT">    </span><span class="NAME">_complete</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rerun</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2936</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job.delayId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2937</span> </span><span class="WHIT">        </span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">job.delayId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Stops any jobs waiting by a delay</span><span class="WHIT">
<span class='linenumber'>2938</span> </span><span class="WHIT">        </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">job.delayId</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2939</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2940</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">job.idleId</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2941</span> </span><span class="WHIT">        </span><span class="NAME">clearTimeout</span><span class="PUNC">(</span><span class="NAME">job.idleId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Stops currently idling job</span><span class="WHIT">
<span class='linenumber'>2942</span> </span><span class="WHIT">        </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">job.idleId</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2943</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2944</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._running</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">job</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2945</span> </span><span class="WHIT">        </span><span class="NAME">this._running</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Set running to false to allow next job to run</span><span class="WHIT">
<span class='linenumber'>2946</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rerun</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">job.stopNext</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2947</span> </span><span class="WHIT">          </span><span class="NAME">this.run</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Continue running the queue</span><span class="WHIT">
<span class='linenumber'>2948</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2949</span> </span><span class="WHIT">          </span><span class="NAME">this.next</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Flush completed job</span><span class="WHIT">
<span class='linenumber'>2950</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2951</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">job.stopNext</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2952</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2953</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2954</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>2955</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2956</span> 
<span class='linenumber'>2957</span> 
<span class='linenumber'>2958</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>2959</span>    * 등록된 객체를 배열 또는 맵 객체에 편리하게 get/set할 수 있는 기능을
<span class='linenumber'>2960</span>    * 제공한다.
<span class='linenumber'>2961</span>    * &lt;p/>
<span class='linenumber'>2962</span>    * @name tau.MapArray
<span class='linenumber'>2963</span>    * @class
<span class='linenumber'>2964</span>    * 맵 또는 배열객체에 값을 저장하고 가져올 수 있는 기능을 정의한다.
<span class='linenumber'>2965</span>    */</span><span class="WHIT">
<span class='linenumber'>2966</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.MapArray'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="COMM">/** @lends tau.MapArray.prototype */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2967</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2968</span>      * 배열 형태로 등록된 모든 항목을 반환한다.
<span class='linenumber'>2969</span>      * @returns {Array} 등록된 값에 대한 배열
<span class='linenumber'>2970</span>      * @function
<span class='linenumber'>2971</span>      */</span><span class="WHIT">
<span class='linenumber'>2972</span> </span><span class="WHIT">    </span><span class="NAME">getArray</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.getterFactory</span><span class="PUNC">(</span><span class="STRN">'getArray'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'[]'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2973</span> 
<span class='linenumber'>2974</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2975</span>      * 맵 객체의 모든 키를 배열 형태로 반환한다.
<span class='linenumber'>2976</span>      * @returns {Array} 맵 객체의 키에 대한 배열
<span class='linenumber'>2977</span>      * @function
<span class='linenumber'>2978</span>      */</span><span class="WHIT">
<span class='linenumber'>2979</span> </span><span class="WHIT">    </span><span class="NAME">getKeys</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.getterFactory</span><span class="PUNC">(</span><span class="STRN">'getKeys'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'[]'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2980</span> 
<span class='linenumber'>2981</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2982</span>      * 맵 형태로 등록된 모든 객체를 반환한다.
<span class='linenumber'>2983</span>      * @returns {Object} 맵 객체
<span class='linenumber'>2984</span>      * @function
<span class='linenumber'>2985</span>      */</span><span class="WHIT">
<span class='linenumber'>2986</span> </span><span class="WHIT">    </span><span class="NAME">getMap</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">tau.getterFactory</span><span class="PUNC">(</span><span class="STRN">'getMap'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'{}'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2987</span> 
<span class='linenumber'>2988</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2989</span>      * 등록된 배열객체의 길이를 반환한다.
<span class='linenumber'>2990</span>      * @returns {Number} 배열객체의 길이
<span class='linenumber'>2991</span>      */</span><span class="WHIT">
<span class='linenumber'>2992</span> </span><span class="WHIT">    </span><span class="NAME">length</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>2993</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>2994</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>2995</span> 
<span class='linenumber'>2996</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>2997</span>      * 명시된 값의 인덱스를 찾아 반환한다. 만약 isKey가 true이면 맵에 등록된
<span class='linenumber'>2998</span>      * 키의 인덱스를 반환하고 그렇지 않으면 배열 객체에서 명시된 값의
<span class='linenumber'>2999</span>      * 인덱스를 찾아 반환한다.
<span class='linenumber'>3000</span>      * @param {Object} value 인덱스를 확인하고자 하는 객체
<span class='linenumber'>3001</span>      * @param {Boolean} [isKey = false] true이면 맵객체의 키를 나타낸다.
<span class='linenumber'>3002</span>      * @returns {Number} 명시된 값의 인덱스
<span class='linenumber'>3003</span>      */</span><span class="WHIT">
<span class='linenumber'>3004</span> </span><span class="WHIT">    </span><span class="NAME">indexOf</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3005</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3006</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3007</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3008</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getKeys</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3009</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3010</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3011</span> 
<span class='linenumber'>3012</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3013</span>      * 명시된 키에 해당하는 값을 찾아 반환한다. &lt;p/>
<span class='linenumber'>3014</span>      * key가 숫자이면 배열에서 해당 인덱스의 값을 반환하고 그렇지
<span class='linenumber'>3015</span>      * 않으면 맵 객체에서 해당키에 해당하는 값을 찾아 반환한다.
<span class='linenumber'>3016</span>      * @param {String|Number} key 배열객체의 인덱스 또는 맵객체의 키
<span class='linenumber'>3017</span>      * @returns {Object} 해당 키에 해당하는 값
<span class='linenumber'>3018</span>      */</span><span class="WHIT">
<span class='linenumber'>3019</span> </span><span class="WHIT">    </span><span class="NAME">get</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3020</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">array</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3021</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3022</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">array</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3023</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3024</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getMap</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3025</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3026</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3027</span> 
<span class='linenumber'>3028</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3029</span>      * 명시된 값을 설정한다. 만약 기존에 해당 키에 값이 설정되어 있었다면
<span class='linenumber'>3030</span>      * 그 값을 덮어쓴다.&lt;p/>
<span class='linenumber'>3031</span>      * 만약 unique가 true이면 배열객체에 저장되는 값이
<span class='linenumber'>3032</span>      * 유일하도록 보장하며 기존에 동일한 값이 저장되어 있다면 아무런 동작을
<span class='linenumber'>3033</span>      * 수행하지 않는다.
<span class='linenumber'>3034</span>      * @param {Object} value 설정하고자 하는 값
<span class='linenumber'>3035</span>      * @param {String|Number} key 배열객체의 인덱스 또는 맵객체의 키
<span class='linenumber'>3036</span>      * @param {Boolean} [unique = false] 배열객체에 값의 중복을 배제한다.
<span class='linenumber'>3037</span>      * @returns {Number} 새롭게 설정된 값의 인덱스
<span class='linenumber'>3038</span>      */</span><span class="WHIT">
<span class='linenumber'>3039</span> </span><span class="WHIT">    </span><span class="NAME">set</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">unique</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3040</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>3041</span>           </span><span class="NAME">array</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3042</span> </span><span class="WHIT">          </span><span class="NAME">keys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getKeys</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3043</span> </span><span class="WHIT">          </span><span class="NAME">map</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getMap</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3044</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">unique</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">array.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3045</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Replace by index</span><span class="WHIT">
<span class='linenumber'>3046</span> </span><span class="WHIT">          </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3047</span> </span><span class="WHIT">          </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3048</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">map.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Replace by key</span><span class="WHIT">
<span class='linenumber'>3049</span> </span><span class="WHIT">          </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">keys.indexOf</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3050</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3051</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">array.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Replace</span><span class="WHIT">
<span class='linenumber'>3052</span> </span><span class="WHIT">          </span><span class="NAME">array</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3053</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">map.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3054</span> </span><span class="WHIT">            </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">map</span><span class="PUNC">[</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Remove any previously mapped key value</span><span class="WHIT">
<span class='linenumber'>3055</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3056</span> </span><span class="WHIT">          </span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3057</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">array.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.push</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Append</span><span class="WHIT">
<span class='linenumber'>3058</span> </span><span class="WHIT">          </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">keys.push</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3059</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3060</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3061</span> </span><span class="WHIT">          </span><span class="NAME">map</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3062</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3063</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3064</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3065</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3066</span> 
<span class='linenumber'>3067</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3068</span>      * 기존의 값에 명시된 값을 추가한다. 만약 배열 객체에 값을 추가할 경우
<span class='linenumber'>3069</span>      * key로 지정된 인덱스에 값을 추가하며 이후의 배열을 한 칸씩 뒤로
<span class='linenumber'>3070</span>      * 밀리게 된다.
<span class='linenumber'>3071</span>      * @param {Object} value 추가하고자 하는 객체
<span class='linenumber'>3072</span>      * @param {String|Number} key 배열객체의 인덱스 또는 맵객체의 키
<span class='linenumber'>3073</span>      * @param {Boolean} [unique = false] 배열객체에 값의 중복을 배제한다.
<span class='linenumber'>3074</span>      * @returns {Number} 새로추가된 값의 인덱스
<span class='linenumber'>3075</span>      */</span><span class="WHIT">
<span class='linenumber'>3076</span> </span><span class="WHIT">    </span><span class="NAME">insert</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">unique</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3077</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>3078</span>           </span><span class="NAME">array</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3079</span> </span><span class="WHIT">          </span><span class="NAME">keys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getKeys</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3080</span> </span><span class="WHIT">          </span><span class="NAME">map</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getMap</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3081</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">unique</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">array.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3082</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Insert by index</span><span class="WHIT">
<span class='linenumber'>3083</span> </span><span class="WHIT">          </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3084</span> </span><span class="WHIT">          </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3085</span> </span><span class="WHIT">          </span><span class="NAME">array.splice</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3086</span> </span><span class="WHIT">          </span><span class="NAME">keys.splice</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3087</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">map.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> 
<span class='linenumber'>3088</span>               </span><span class="NAME">array.length</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.push</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Append</span><span class="WHIT">
<span class='linenumber'>3089</span> </span><span class="WHIT">          </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">keys.push</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3090</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3091</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3092</span> </span><span class="WHIT">          </span><span class="NAME">map</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3093</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3094</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3095</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3096</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3097</span> 
<span class='linenumber'>3098</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3099</span>      * 명시된 값을 배열 또는 맵 객체로 부터 삭제한다. isKey가 true이면
<span class='linenumber'>3100</span>      * 맵 객체로 부터 키로 지정된 값을 삭제한다.
<span class='linenumber'>3101</span>      * @param {String|Number} value 배열객체의 인덱스 또는 맵객체의 키
<span class='linenumber'>3102</span>      * @param {Boolean} [isKey = false] true이면 value가 맵객체의 키를 나타낸다.
<span class='linenumber'>3103</span>      * @returns {Boolean} 정상적으로 삭제가 되었으면 true를 반환한다.
<span class='linenumber'>3104</span>      */</span><span class="WHIT">
<span class='linenumber'>3105</span> </span><span class="WHIT">    </span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3106</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>3107</span>           </span><span class="NAME">array</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3108</span> </span><span class="WHIT">          </span><span class="NAME">keys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getKeys</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3109</span> </span><span class="WHIT">          </span><span class="NAME">map</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getMap</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3110</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isKey</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3111</span> </span><span class="WHIT">        </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">array.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3112</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Remove by index</span><span class="WHIT">
<span class='linenumber'>3113</span> </span><span class="WHIT">        </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3114</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">map.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">// Remove by key</span><span class="WHIT">
<span class='linenumber'>3115</span> </span><span class="WHIT">        </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">keys.indexOf</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3116</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3117</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">idx</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3118</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">map.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3119</span> </span><span class="WHIT">          </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">map</span><span class="PUNC">[</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">idx</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// Remove any mapped key value</span><span class="WHIT">
<span class='linenumber'>3120</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3121</span> </span><span class="WHIT">        </span><span class="NAME">array.splice</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3122</span> </span><span class="WHIT">        </span><span class="NAME">keys.splice</span><span class="PUNC">(</span><span class="NAME">idx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3123</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3124</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3125</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3126</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3127</span> 
<span class='linenumber'>3128</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3129</span>      * 등록된 모든 배열과 맵 객체를 삭제한다.
<span class='linenumber'>3130</span>      */</span><span class="WHIT">
<span class='linenumber'>3131</span> </span><span class="WHIT">    </span><span class="NAME">clear</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3132</span> </span><span class="WHIT">      </span><span class="COMM">// Next call to each prototype will create a new instance</span><span class="WHIT">
<span class='linenumber'>3133</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.getArray</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3134</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.getKeys</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3135</span> </span><span class="WHIT">      </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.getMap</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3136</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3137</span> 
<span class='linenumber'>3138</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3139</span>      * 배열 객체일 경우 각 배열을 iteration 할 때마다 명시된 callbackFn을 
<span class='linenumber'>3140</span>      * 호출한다.
<span class='linenumber'>3141</span>      * @param {Function} callbackFn 각 배열을 방문할 때마다
<span class='linenumber'>3142</span>      * 호출되는 callback함수
<span class='linenumber'>3143</span>      * @param {Object} context CallbackFn 내에서 사용할 'this' context
<span class='linenumber'>3144</span>      */</span><span class="WHIT">
<span class='linenumber'>3145</span> </span><span class="WHIT">    </span><span class="NAME">forEach</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3146</span> </span><span class="WHIT">      </span><span class="NAME">tau.forEach</span><span class="PUNC">(</span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3147</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3148</span> 
<span class='linenumber'>3149</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3150</span>      * 새로운 배열객체를 생성하여 반환한다. 이때 반환되는 배열 객체의
<span class='linenumber'>3151</span>      * 값을 변경하더라도 기존의 배열객체에는 영향을 주지 않는다.
<span class='linenumber'>3152</span>      * @returns {Array} 동일한 값을 가지는 새로운 배열 객체
<span class='linenumber'>3153</span>      */</span><span class="WHIT">
<span class='linenumber'>3154</span> </span><span class="WHIT">    </span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3155</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">this.getArray</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3156</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3157</span> 
<span class='linenumber'>3158</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3159</span>      * 새로운 맵 객체를 생성하여 반환한다. 이때 반환되는 맵 객체의
<span class='linenumber'>3160</span>      * 값을 변경하더라도 기존의 맵객체에는 영향을 주지 않는다.
<span class='linenumber'>3161</span>      * @returns {Object} 동일한 값을 가지는 새로운 맵 객체
<span class='linenumber'>3162</span>      */</span><span class="WHIT">
<span class='linenumber'>3163</span> </span><span class="WHIT">    </span><span class="NAME">toMap</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3164</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.clone</span><span class="PUNC">(</span><span class="NAME">this.getMap</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3165</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3166</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3167</span> 
<span class='linenumber'>3168</span> 
<span class='linenumber'>3169</span> </span><span class="WHIT">  </span><span class="COMM">/**
<span class='linenumber'>3170</span>    * 맵 또는 배열 객체에 값을 저장하고 추출할 수 있는 기능을 정의한 클래스
<span class='linenumber'>3171</span>    * &lt;p/>
<span class='linenumber'>3172</span>    * getMapItem과 setMapItem 메소드는 name으로 지정된 키를 이용하여 값을
<span class='linenumber'>3173</span>    * 추출하거나 설정할 수 있도록 한다.
<span class='linenumber'>3174</span>    * 추가적으로, getArrayItems 메소드는 내부적으로 가지고 있는 배열객체를
<span class='linenumber'>3175</span>    * 반환한다.
<span class='linenumber'>3176</span>    * &lt;p/>
<span class='linenumber'>3177</span>    * getAllItems 메소드는 ItemRegistry로 관리되는 모든 값을 배열 형태로
<span class='linenumber'>3178</span>    * 반환한다.
<span class='linenumber'>3179</span>    * @name tau.ItemRegistry
<span class='linenumber'>3180</span>    * @see tau.MapArray
<span class='linenumber'>3181</span>    * @class
<span class='linenumber'>3182</span>    * 맵 또는 배열 객체에 값을 저장하고 추출할 수 있는 기능을 정의한 클래스
<span class='linenumber'>3183</span>    */</span><span class="WHIT">
<span class='linenumber'>3184</span> </span><span class="WHIT">  </span><span class="NAME">$class</span><span class="PUNC">(</span><span class="STRN">'tau.ItemRegistry'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">define</span><span class="PUNC">(</span><span class="COMM">/** @lends tau.ItemRegistry.prototype */</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3185</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3186</span>      * 등록된 모든 값을 배열 형태로 반환한다. 이때 반환되는 값은 중복되지
<span class='linenumber'>3187</span>      * 않는다.
<span class='linenumber'>3188</span>      * @returns {Array} 등록된 모든 값을 가지고 있는 배열
<span class='linenumber'>3189</span>      */</span><span class="WHIT">
<span class='linenumber'>3190</span> </span><span class="WHIT">    </span><span class="NAME">getAllItems</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3191</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>3192</span>           </span><span class="NAME">array</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3193</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._registryArray</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3194</span> </span><span class="WHIT">        </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._registryArray.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3195</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">array.indexOf</span><span class="PUNC">(</span><span class="NAME">this._registryArray</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3196</span> </span><span class="WHIT">            </span><span class="NAME">array.unshift</span><span class="PUNC">(</span><span class="NAME">this._registryArray</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3197</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3198</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3199</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3200</span> </span><span class="WHIT">      </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._registryMap</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3201</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._registryMap.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='linenumber'>3202</span>             </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">array.indexOf</span><span class="PUNC">(</span><span class="NAME">this._registryMap</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3203</span> </span><span class="WHIT">          </span><span class="NAME">array.unshift</span><span class="PUNC">(</span><span class="NAME">this._registryMap</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3204</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3205</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3206</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">array.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">array</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3207</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3208</span> 
<span class='linenumber'>3209</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'>3210</span>      * 등록된 값중 배열형태로 등록된 객체를 반환한다.
<span class='linenumber'>3211</span>      * @returns {Array} 배열 형태로 등록된 값
<span class='linenumber'>3212</span>      */</span><span class="WHIT">
<span class='linenumber'>3213</span> </span><span class="WHIT">    </span><span class="NAME">getArrayItems</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3214</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._registryArray</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3215</span> </span><span class="WHIT">        </span><span class="COMM">/** @private Lazily create a registry if one doesn't already exit  */</span><span class="WHIT">
<span class='linenumber'>3216</span> </span><span class="WHIT">        </span><span class="NAME">this._registryArray</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3217</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3218</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._registryArray</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3219</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3220</span> </span><span class="WHIT">    
<span class='linenumber'>3221</span>     </span><span class="COMM">/**
<span class='linenumber'>3222</span>      * 등록된 값중 Map형태로 등록된 값들 중에서 키(name)에 해당하는 값을 찾아
<span class='linenumber'>3223</span>      * 반환한다. 만약 키에 해당하는 값이 없을 경우 null을 반환한다.
<span class='linenumber'>3224</span>      * @param {String} name 맵 객체에서 찾고자 하는 키
<span class='linenumber'>3225</span>      * @returns {Object} 명시된 키에 해당하는 값
<span class='linenumber'>3226</span>      */</span><span class="WHIT">
<span class='linenumber'>3227</span> </span><span class="WHIT">    </span><span class="NAME">getMapItem</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3228</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3229</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._registryMap</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3230</span> </span><span class="WHIT">          </span><span class="COMM">/** @private Lazily create a registry if one doesn't already exit */</span><span class="WHIT">
<span class='linenumber'>3231</span> </span><span class="WHIT">          </span><span class="NAME">this._registryMap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3232</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3233</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._registryMap</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3234</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3235</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3236</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3237</span> 
<span class='linenumber'>3238</span> </span><span class="WHIT">    </span><span class="COMM">/** 
<span class='linenumber'>3239</span>      * 명시된 키를 이용하여 값을 등록한다.
<span class='linenumber'>3240</span>      * @param {String} name 맵 객체에 저장할 때 사용할 키
<span class='linenumber'>3241</span>      * @param {Object} value 해당 키에 저장하고자 하는 객체
<span class='linenumber'>3242</span>      * @returns {Boolean} 값이 정상적으로 설정되었다면 true를 반환한다.
<span class='linenumber'>3243</span>      */</span><span class="WHIT">
<span class='linenumber'>3244</span> </span><span class="WHIT">    </span><span class="NAME">setMapItem</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3245</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3246</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._registryMap</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3247</span> </span><span class="WHIT">          </span><span class="COMM">/** @private Lazily create a registry if one doesn't already exit */</span><span class="WHIT">
<span class='linenumber'>3248</span> </span><span class="WHIT">          </span><span class="NAME">this._registryMap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3249</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3250</span> </span><span class="WHIT">        </span><span class="NAME">this._registryMap</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3251</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3252</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3253</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3254</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3255</span> 
<span class='linenumber'>3256</span> </span><span class="WHIT">    </span><span class="COMM">/**
<span class='linenumber'>3257</span>      * 명시된 키의 값을 삭제한다. 삭제하고자 하는 키가 null일 경우
<span class='linenumber'>3258</span>      * 맴 객체에 설정된 모든 값을 삭제한다.
<span class='linenumber'>3259</span>      * @param {String} arg 삭제하고자 하는 맵 객체의 키
<span class='linenumber'>3260</span>      * @returns {Boolean} 정상적으로 삭제되었다면 true를 반환한다.
<span class='linenumber'>3261</span>      */</span><span class="WHIT">
<span class='linenumber'>3262</span> </span><span class="WHIT">    </span><span class="NAME">clearMapItem</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arg</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3263</span> </span><span class="WHIT">      </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arg</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3264</span> </span><span class="WHIT">        </span><span class="NAME">this._registryMap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3265</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3266</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._registryMap</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">tau.isString</span><span class="PUNC">(</span><span class="NAME">arg</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3267</span> </span><span class="WHIT">        </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._registryMap</span><span class="PUNC">[</span><span class="NAME">arg</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3268</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3269</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3270</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3271</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3272</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3273</span> 
<span class='linenumber'>3274</span> 
<span class='linenumber'>3275</span> </span><span class="WHIT">  </span><span class="COMM">// JSON Module</span><span class="WHIT">
<span class='linenumber'>3276</span> </span><span class="WHIT">  </span><span class="NAME">_MODULE.json</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">JSON</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3277</span> </span><span class="WHIT">    </span><span class="NAME">JSON</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">JSON</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3278</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">JSON.stringify</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3279</span> 
<span class='linenumber'>3280</span> </span><span class="WHIT">      </span><span class="COMM">// stringify private variables</span><span class="WHIT">
<span class='linenumber'>3281</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">escapable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3282</span> </span><span class="WHIT">          </span><span class="NAME">gap</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3283</span> </span><span class="WHIT">          </span><span class="NAME">indent</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3284</span> </span><span class="WHIT">          </span><span class="NAME">meta</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">    </span><span class="COMM">// table of character substitutions</span><span class="WHIT">
<span class='linenumber'>3285</span> </span><span class="WHIT">            </span><span class="STRN">'\b'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'\\b'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3286</span> </span><span class="WHIT">            </span><span class="STRN">'\t'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'\\t'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3287</span> </span><span class="WHIT">            </span><span class="STRN">'\n'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'\\n'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3288</span> </span><span class="WHIT">            </span><span class="STRN">'\f'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'\\f'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3289</span> </span><span class="WHIT">            </span><span class="STRN">'\r'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'\\r'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3290</span> </span><span class="WHIT">            </span><span class="STRN">'"'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'\\"'</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3291</span> </span><span class="WHIT">            </span><span class="STRN">'\\'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'\\\\'</span><span class="WHIT">
<span class='linenumber'>3292</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3293</span> </span><span class="WHIT">          </span><span class="NAME">rep</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3294</span> 
<span class='linenumber'>3295</span> </span><span class="WHIT">      </span><span class="COMM">/** @inner Format integers to have at least two digits. */</span><span class="WHIT"> 
<span class='linenumber'>3296</span>       </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3297</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'0'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">n</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3298</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3299</span> 
<span class='linenumber'>3300</span> </span><span class="WHIT">      </span><span class="COMM">/** @inner Safely put quotes around a string, even for control chars. */</span><span class="WHIT"> 
<span class='linenumber'>3301</span>       </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">quote</span><span class="PUNC">(</span><span class="NAME">string</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3302</span> </span><span class="WHIT">        </span><span class="NAME">escapable.lastIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3303</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">escapable.test</span><span class="PUNC">(</span><span class="NAME">string</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">string.replace</span><span class="PUNC">(</span><span class="NAME">escapable</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3304</span> </span><span class="WHIT">            </span><span class="COMM">/** @inner */</span><span class="WHIT">
<span class='linenumber'>3305</span> </span><span class="WHIT">            </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3306</span> </span><span class="WHIT">              </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">meta</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3307</span> </span><span class="WHIT">              </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> 
<span class='linenumber'>3308</span>                   </span><span class="STRN">'\\u'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'0000'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">a.charCodeAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3309</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">string</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3310</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3311</span> </span><span class="WHIT">    
<span class='linenumber'>3312</span>       </span><span class="COMM">/** @inner Produce a string from holder[key]. */</span><span class="WHIT">
<span class='linenumber'>3313</span> </span><span class="WHIT">      </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">holder</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3314</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">// The loop counter.</span><span class="WHIT">
<span class='linenumber'>3315</span> </span><span class="WHIT">            </span><span class="NAME">k</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">// The member key.</span><span class="WHIT">
<span class='linenumber'>3316</span> </span><span class="WHIT">            </span><span class="NAME">v</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">// The member value.</span><span class="WHIT">
<span class='linenumber'>3317</span> </span><span class="WHIT">            </span><span class="NAME">length</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>3318</span>             </span><span class="NAME">mind</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">gap</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>3319</span>             </span><span class="NAME">partial</span><span class="PUNC">,</span><span class="WHIT"> 
<span class='linenumber'>3320</span>             </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">holder</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3321</span> 
<span class='linenumber'>3322</span> </span><span class="WHIT">        </span><span class="COMM">// If the value has a toJSON method, call it to obtain a replacement value.</span><span class="WHIT">
<span class='linenumber'>3323</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3324</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">value.toJSON</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3325</span> </span><span class="WHIT">            </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.toJSON</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3326</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Object.prototype.toString.call</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'[object Date]'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3327</span> </span><span class="WHIT">            </span><span class="COMM">// Handle ISO date conversion separately, because unlike the original </span><span class="WHIT">
<span class='linenumber'>3328</span> </span><span class="WHIT">            </span><span class="COMM">// source, we do not modify native prototypes  </span><span class="WHIT">
<span class='linenumber'>3329</span> </span><span class="WHIT">            </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">isFinite</span><span class="PUNC">(</span><span class="NAME">value.valueOf</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT">
<span class='linenumber'>3330</span> </span><span class="WHIT">                </span><span class="NAME">value.getUTCFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">     </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='linenumber'>3331</span> </span><span class="WHIT">                </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">value.getUTCMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='linenumber'>3332</span> </span><span class="WHIT">                </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">value.getUTCDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">      </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'T'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='linenumber'>3333</span> </span><span class="WHIT">                </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">value.getUTCHours</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">     </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">':'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='linenumber'>3334</span> </span><span class="WHIT">                </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">value.getUTCMinutes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">   </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">':'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT">
<span class='linenumber'>3335</span> </span><span class="WHIT">                </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">value.getUTCSeconds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">   </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'Z'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3336</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3337</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3338</span> 
<span class='linenumber'>3339</span> </span><span class="WHIT">        </span><span class="COMM">// Replace values if replaces function was passed</span><span class="WHIT">
<span class='linenumber'>3340</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">rep</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3341</span> </span><span class="WHIT">          </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rep.call</span><span class="PUNC">(</span><span class="NAME">holder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3342</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3343</span> </span><span class="WHIT">    
<span class='linenumber'>3344</span>         </span><span class="COMM">// Converts values to string for respective types</span><span class="WHIT">
<span class='linenumber'>3345</span> </span><span class="WHIT">        </span><span class="KEYW">switch</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3346</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>3347</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">quote</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3348</span> </span><span class="WHIT">    
<span class='linenumber'>3349</span>         </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>3350</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">isFinite</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'null'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3351</span> </span><span class="WHIT">    
<span class='linenumber'>3352</span>         </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'boolean'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>3353</span> </span><span class="WHIT">        </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'null'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>3354</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3355</span> </span><span class="WHIT">    
<span class='linenumber'>3356</span>         </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">:</span><span class="WHIT">
<span class='linenumber'>3357</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3358</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'null'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3359</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3360</span> </span><span class="WHIT">          </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">indent</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3361</span> </span><span class="WHIT">          </span><span class="NAME">partial</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3362</span> </span><span class="WHIT">    
<span class='linenumber'>3363</span>           </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Object.prototype.toString.apply</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'[object Array]'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3364</span> </span><span class="WHIT">            </span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3365</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3366</span> </span><span class="WHIT">              </span><span class="NAME">partial</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'null'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3367</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3368</span> </span><span class="WHIT">            </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">partial.length</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'[]'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>3369</span>                   </span><span class="STRN">'[\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">partial.join</span><span class="PUNC">(</span><span class="STRN">',\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">gap</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">mind</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> 
<span class='linenumber'>3370</span>                   </span><span class="STRN">'['</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">partial.join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">']'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3371</span> </span><span class="WHIT">            </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mind</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3372</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3373</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3374</span> </span><span class="WHIT">    
<span class='linenumber'>3375</span>           </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rep</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">rep</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3376</span> </span><span class="WHIT">            </span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rep.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3377</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3378</span> </span><span class="WHIT">              </span><span class="NAME">k</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rep</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3379</span> </span><span class="WHIT">              </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">k</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3380</span> </span><span class="WHIT">                </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3381</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3382</span> </span><span class="WHIT">                  </span><span class="NAME">partial.push</span><span class="PUNC">(</span><span class="NAME">quote</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">': '</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">':'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3383</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3384</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3385</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3386</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3387</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">k</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3388</span> </span><span class="WHIT">              </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Object.hasOwnProperty.call</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3389</span> </span><span class="WHIT">                </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3390</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3391</span> </span><span class="WHIT">                  </span><span class="NAME">partial.push</span><span class="PUNC">(</span><span class="NAME">quote</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">': '</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">':'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3392</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3393</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3394</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3395</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3396</span> </span><span class="WHIT">    
<span class='linenumber'>3397</span>           </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">partial.length</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'{}'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> 
<span class='linenumber'>3398</span>               </span><span class="STRN">'{\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">partial.join</span><span class="PUNC">(</span><span class="STRN">',\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">gap</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">mind</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'}'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> 
<span class='linenumber'>3399</span>               </span><span class="STRN">'{'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">partial.join</span><span class="PUNC">(</span><span class="STRN">','</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'}'</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3400</span> </span><span class="WHIT">          </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mind</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3401</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3402</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3403</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3404</span> 
<span class='linenumber'>3405</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>3406</span>        * Converts a valid JavaScript value to a valid JSON text string.
<span class='linenumber'>3407</span>        * A direct integration of Douglas Crockford's &lt;code>JSON.stringify&lt;/code> 
<span class='linenumber'>3408</span>        * implementation available in the public domain.
<span class='linenumber'>3409</span>        * @see http://www.JSON.org/json2.js (2010-03-20)
<span class='linenumber'>3410</span>        * @throws {Error} Invalid replacer
<span class='linenumber'>3411</span>        * @private
<span class='linenumber'>3412</span>        */</span><span class="WHIT">
<span class='linenumber'>3413</span> </span><span class="WHIT">      </span><span class="NAME">JSON.stringify</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">replacer</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">space</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3414</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3415</span> </span><span class="WHIT">            </span><span class="NAME">gap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3416</span> </span><span class="WHIT">            </span><span class="NAME">indent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3417</span> 
<span class='linenumber'>3418</span> </span><span class="WHIT">        </span><span class="COMM">// Setup space character for numbers/string</span><span class="WHIT">
<span class='linenumber'>3419</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">space</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3420</span> </span><span class="WHIT">          </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">space</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3421</span> </span><span class="WHIT">            </span><span class="NAME">indent</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3422</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3423</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">space</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3424</span> </span><span class="WHIT">          </span><span class="NAME">indent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">space</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3425</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3426</span> 
<span class='linenumber'>3427</span> </span><span class="WHIT">        </span><span class="COMM">// If there is a replacer, it must be a function or an array.</span><span class="WHIT">
<span class='linenumber'>3428</span> </span><span class="WHIT">        </span><span class="NAME">rep</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">replacer</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3429</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">replacer</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">replacer</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="WHIT">
<span class='linenumber'>3430</span> </span><span class="WHIT">            </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">replacer</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="WHIT"> 
<span class='linenumber'>3431</span>             </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">replacer.length</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">'number'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3432</span> </span><span class="WHIT">          </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'JSON.stringify'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3433</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3434</span> 
<span class='linenumber'>3435</span> </span><span class="WHIT">        </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3436</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3437</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3438</span> 
<span class='linenumber'>3439</span> </span><span class="WHIT">    </span><span class="COMM">/* JSON.parse definition */</span><span class="WHIT">
<span class='linenumber'>3440</span> </span><span class="WHIT">    </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">tau.isFunction</span><span class="PUNC">(</span><span class="NAME">JSON.parse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3441</span> 
<span class='linenumber'>3442</span> </span><span class="WHIT">      </span><span class="COMM">// parse private variables</span><span class="WHIT">
<span class='linenumber'>3443</span> </span><span class="WHIT">      </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="REGX">/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3444</span> 
<span class='linenumber'>3445</span> </span><span class="WHIT">      </span><span class="COMM">/**
<span class='linenumber'>3446</span>        * Converts a valid JSON text into a JavaScript value.
<span class='linenumber'>3447</span>        * A direct integration of Douglas Crockford's &lt;code>JSON.parse&lt;/code>
<span class='linenumber'>3448</span>        * implementation available in the public domain.
<span class='linenumber'>3449</span>        * @see http://www.JSON.org/json2.js (2010-03-20)
<span class='linenumber'>3450</span>        * @throws {Error} Invalid JSON formated text
<span class='linenumber'>3451</span>        * @private
<span class='linenumber'>3452</span>        */</span><span class="WHIT">
<span class='linenumber'>3453</span> </span><span class="WHIT">      </span><span class="NAME">JSON.parse</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">reviver</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3454</span> </span><span class="WHIT">        </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3455</span> 
<span class='linenumber'>3456</span> </span><span class="WHIT">        </span><span class="COMM">/**
<span class='linenumber'>3457</span>          * Inner helper function used to recursively walk the resulting 
<span class='linenumber'>3458</span>          * structure so that modifications can be made. 
<span class='linenumber'>3459</span>          * @inner
<span class='linenumber'>3460</span>          */</span><span class="WHIT">
<span class='linenumber'>3461</span> </span><span class="WHIT">        </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">walk</span><span class="PUNC">(</span><span class="NAME">holder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3462</span> </span><span class="WHIT">          </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">holder</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3463</span> </span><span class="WHIT">          </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3464</span> </span><span class="WHIT">            </span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">k</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3465</span> </span><span class="WHIT">              </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Object.hasOwnProperty.call</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3466</span> </span><span class="WHIT">                </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">walk</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3467</span> </span><span class="WHIT">                </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3468</span> </span><span class="WHIT">                  </span><span class="NAME">value</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3469</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3470</span> </span><span class="WHIT">                  </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3471</span> </span><span class="WHIT">                </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3472</span> </span><span class="WHIT">              </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3473</span> </span><span class="WHIT">            </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3474</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3475</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">reviver.call</span><span class="PUNC">(</span><span class="NAME">holder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3476</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3477</span> 
<span class='linenumber'>3478</span> </span><span class="WHIT">        </span><span class="COMM">// Replace certain Unicode characters with escape sequences.</span><span class="WHIT">
<span class='linenumber'>3479</span> </span><span class="WHIT">        </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3480</span> </span><span class="WHIT">        </span><span class="NAME">cx.lastIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3481</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cx.test</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3482</span> </span><span class="WHIT">          </span><span class="COMM">/** @inner */</span><span class="WHIT">
<span class='linenumber'>3483</span> </span><span class="WHIT">          </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text.replace</span><span class="PUNC">(</span><span class="NAME">cx</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3484</span> </span><span class="WHIT">            </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">'\\u'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">'0000'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">a.charCodeAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3485</span> </span><span class="WHIT">          </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3486</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3487</span> 
<span class='linenumber'>3488</span> </span><span class="WHIT">        </span><span class="COMM">// Run the text against RegExp that look for non-JSON patterns</span><span class="WHIT">
<span class='linenumber'>3489</span> </span><span class="WHIT">        </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">tau.isJSON</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3490</span> 
<span class='linenumber'>3491</span> </span><span class="WHIT">          </span><span class="COMM">// Compile the text into a JavaScript structure</span><span class="WHIT">
<span class='linenumber'>3492</span> </span><span class="WHIT">          </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">'('</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">')'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3493</span> 
<span class='linenumber'>3494</span> </span><span class="WHIT">          </span><span class="COMM">// Walk the reviver</span><span class="WHIT">
<span class='linenumber'>3495</span> </span><span class="WHIT">          </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">reviver</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">walk</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">''</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3496</span> </span><span class="WHIT">        </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3497</span> 
<span class='linenumber'>3498</span> </span><span class="WHIT">        </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">SyntaxError</span><span class="PUNC">(</span><span class="STRN">'JSON.parse'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3499</span> </span><span class="WHIT">      </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3500</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3501</span> </span><span class="WHIT">    </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">JSON</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3502</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">GLOBAL.JSON</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3503</span> 
<span class='linenumber'>3504</span> 
<span class='linenumber'>3505</span> </span><span class="WHIT">  </span><span class="COMM">/** Utility log levels */</span><span class="WHIT">
<span class='linenumber'>3506</span> </span><span class="WHIT">  </span><span class="NAME">tau.namespace</span><span class="PUNC">(</span><span class="STRN">'tau.log'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3507</span> </span><span class="WHIT">    </span><span class="NAME">LEVEL</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">     </span><span class="COMM">// Logging level </span><span class="WHIT">
<span class='linenumber'>3508</span> </span><span class="WHIT">    </span><span class="NAME">DEBUG</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3509</span> </span><span class="WHIT">    </span><span class="NAME">INFO</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3510</span> </span><span class="WHIT">    </span><span class="NAME">WARN</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3511</span> </span><span class="WHIT">    </span><span class="NAME">ERROR</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3512</span> </span><span class="WHIT">    </span><span class="NAME">FATAL</span><span class="WHIT">   </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3513</span> </span><span class="WHIT">    </span><span class="NAME">NONE</span><span class="WHIT">    </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">6</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3514</span> 
<span class='linenumber'>3515</span> </span><span class="WHIT">    </span><span class="COMM">/** Checks if the current logging level */</span><span class="WHIT">
<span class='linenumber'>3516</span> </span><span class="WHIT">    </span><span class="NAME">isLevel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">level</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3517</span> </span><span class="WHIT">      </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tau.log.LEVEL</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NAME">level</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3518</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3519</span> </span><span class="WHIT">    </span><span class="COMM">/** Debug logging */</span><span class="WHIT">
<span class='linenumber'>3520</span> </span><span class="WHIT">    </span><span class="NAME">debug</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3521</span> </span><span class="WHIT">      </span><span class="NAME">tau.log</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.log.DEBUG</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3522</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3523</span> </span><span class="WHIT">    </span><span class="COMM">/** Information logging */</span><span class="WHIT">
<span class='linenumber'>3524</span> </span><span class="WHIT">    </span><span class="NAME">info</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3525</span> </span><span class="WHIT">      </span><span class="NAME">tau.log</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.log.INFO</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3526</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3527</span> </span><span class="WHIT">    </span><span class="COMM">/** Warning logging */</span><span class="WHIT">
<span class='linenumber'>3528</span> </span><span class="WHIT">    </span><span class="NAME">warn</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3529</span> </span><span class="WHIT">      </span><span class="NAME">tau.log</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.log.WARN</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3530</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3531</span> </span><span class="WHIT">    </span><span class="COMM">/** Error logging */</span><span class="WHIT">
<span class='linenumber'>3532</span> </span><span class="WHIT">    </span><span class="NAME">error</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3533</span> </span><span class="WHIT">      </span><span class="NAME">tau.log</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.log.ERROR</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3534</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='linenumber'>3535</span> </span><span class="WHIT">    </span><span class="COMM">/** Fatal logging */</span><span class="WHIT">
<span class='linenumber'>3536</span> </span><span class="WHIT">    </span><span class="NAME">fatal</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3537</span> </span><span class="WHIT">      </span><span class="NAME">tau.log</span><span class="PUNC">(</span><span class="NAME">msg</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tau.log.FATAL</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">src</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3538</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3539</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3540</span> 
<span class='linenumber'>3541</span> </span><span class="WHIT">  </span><span class="COMM">/** Utility handler functions */</span><span class="WHIT">
<span class='linenumber'>3542</span> </span><span class="WHIT">  </span><span class="NAME">tau.namespace</span><span class="PUNC">(</span><span class="STRN">'tau.optionize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3543</span> </span><span class="WHIT">    </span><span class="COMM">/** onEvent optionize registration util function */</span><span class="WHIT">
<span class='linenumber'>3544</span> </span><span class="WHIT">    </span><span class="NAME">onEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='linenumber'>3545</span> </span><span class="WHIT">      </span><span class="NAME">this.onEvent</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callbackFn</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3546</span> </span><span class="WHIT">    </span><span class="PUNC">}</span><span class="WHIT">
<span class='linenumber'>3547</span> </span><span class="WHIT">  </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3548</span> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='linenumber'>3549</span> </span></pre></body></html>